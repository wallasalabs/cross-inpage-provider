(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5904],{3666:function(e,t,n){var r=n(48764).Buffer;e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=28)}([function(e,t){e.exports=n(64687)},function(e,t){e.exports=n(17156)},function(e,t){e.exports=n(56690)},function(e,t){e.exports=n(89728)},function(e,t){e.exports=n(38416)},function(e,t){e.exports=n(6955)},function(e,t){e.exports=n(16441)},function(e,t){e.exports=n(37832)},function(e,t){e.exports=n(18698)},function(e,t){e.exports=n(861)},function(e,t){e.exports=n(833)},function(e,t){e.exports=n(27424)},function(e,t){e.exports=n(38197)},function(e,t){e.exports=n(44431)},function(e,t){e.exports=n(66115)},function(e,t){e.exports=n(6881)},function(e,t){e.exports=n(77898)},function(e,t){e.exports=n(86266)},function(e,t){e.exports=n(73808)},function(e,t){e.exports=n(61655)},function(e,t){e.exports=n(94993)},function(e,t){e.exports=n(45650)},function(e,t){e.exports=n(62741)},function(e,t){e.exports=n(1581)},function(e,t){e.exports=n(48966)},function(e,t){e.exports=n(49300)},function(e){e.exports=JSON.parse('{"a":"4.4.0"}')},function(e,t){e.exports=n(17673)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return pn}));var i={};n.r(i),n.d(i,"byte2hexStr",(function(){return C})),n.d(i,"bytesToString",(function(){return B})),n.d(i,"hextoString",(function(){return D})),n.d(i,"byteArray2hexStr",(function(){return K})),n.d(i,"base64DecodeFromString",(function(){return R})),n.d(i,"base64EncodeToString",(function(){return H}));var a={};n.r(a),n.d(a,"bin2String",(function(){return U})),n.d(a,"arrayEquals",(function(){return M})),n.d(a,"stringToBytes",(function(){return z})),n.d(a,"byte2hexStr",(function(){return C})),n.d(a,"bytesToString",(function(){return B})),n.d(a,"hextoString",(function(){return D})),n.d(a,"byteArray2hexStr",(function(){return K})),n.d(a,"base64DecodeFromString",(function(){return R})),n.d(a,"base64EncodeToString",(function(){return H})),n.d(a,"hexChar2byte",(function(){return J})),n.d(a,"isHexChar",(function(){return G})),n.d(a,"hexStr2byteArray",(function(){return $})),n.d(a,"strToDate",(function(){return Y})),n.d(a,"isNumber",(function(){return X})),n.d(a,"getStringType",(function(){return Z}));var s={};n.r(s),n.d(s,"encode58",(function(){return ne})),n.d(s,"decode58",(function(){return re}));var o={};n.r(o),n.d(o,"keccak256",(function(){return se})),n.d(o,"sha256",(function(){return oe})),n.d(o,"toUtf8Bytes",(function(){return ue})),n.d(o,"toUtf8String",(function(){return ce})),n.d(o,"recoverAddress",(function(){return de})),n.d(o,"SigningKey",(function(){return le})),n.d(o,"AbiCoder",(function(){return he})),n.d(o,"Interface",(function(){return fe})),n.d(o,"FormatTypes",(function(){return ve})),n.d(o,"splitSignature",(function(){return ge})),n.d(o,"joinSignature",(function(){return ye})),n.d(o,"arrayify",(function(){return pe})),n.d(o,"ethersWallet",(function(){return ae.Wallet})),n.d(o,"concat",(function(){return me})),n.d(o,"id",(function(){return be})),n.d(o,"isValidMnemonic",(function(){return ke}));var u={};n.r(u),n.d(u,"getBase58CheckAddress",(function(){return Le})),n.d(u,"decodeBase58Address",(function(){return Ue})),n.d(u,"signTransaction",(function(){return Me})),n.d(u,"arrayToBase64String",(function(){return ze})),n.d(u,"signBytes",(function(){return Je})),n.d(u,"_signTypedData",(function(){return Ge})),n.d(u,"getRowBytesFromTransactionBase64",(function(){return $e})),n.d(u,"genPriKey",(function(){return Ye})),n.d(u,"computeAddress",(function(){return Xe})),n.d(u,"getAddressFromPriKey",(function(){return Ze})),n.d(u,"decode58Check",(function(){return Qe})),n.d(u,"isAddressValid",(function(){return et})),n.d(u,"getBase58CheckAddressFromPriKeyBase64String",(function(){return tt})),n.d(u,"getHexStrAddressFromPriKeyBase64String",(function(){return nt})),n.d(u,"getAddressFromPriKeyBase64String",(function(){return rt})),n.d(u,"getPubKeyFromPriKey",(function(){return it})),n.d(u,"ECKeySign",(function(){return at})),n.d(u,"SHA256",(function(){return st})),n.d(u,"passwordToAddress",(function(){return ot})),n.d(u,"pkToAddress",(function(){return ut}));var c={};n.r(c),n.d(c,"generateAccount",(function(){return ct})),n.d(c,"generateRandom",(function(){return dt})),n.d(c,"generateAccountWithMnemonic",(function(){return lt}));var d={};n.r(d),n.d(d,"decodeParams",(function(){return pt})),n.d(d,"encodeParams",(function(){return gt})),n.d(d,"encodeParamsV2ByABI",(function(){return bt})),n.d(d,"decodeParamsV2ByABI",(function(){return kt}));var l={};n.r(l),n.d(l,"TRON_MESSAGE_PREFIX",(function(){return xt})),n.d(l,"hashMessage",(function(){return wt})),n.d(l,"signMessage",(function(){return At})),n.d(l,"verifyMessage",(function(){return It}));var h=n(1),f=n.n(h),v=n(8),p=n.n(v),g=n(2),y=n.n(g),m=n(3),b=n.n(m),k=n(14),x=n.n(k),w=n(19),A=n.n(w),I=n(20),P=n.n(I),W=n(18),S=n.n(W),_=n(4),j=n.n(_),T=n(0),N=n.n(T),O=n(21),E=n.n(O);function F(){var e=this;this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(t){for(var n,r,i,a,s,o,u,c="",d=0;d<t.length;)a=(n=t.charCodeAt(d++))>>2,s=(3&n)<<4|(r=t.charCodeAt(d++))>>4,o=(15&r)<<2|(i=t.charCodeAt(d++))>>6,u=63&i,isNaN(r)?o=u=64:isNaN(i)&&(u=64),c=c+e._keyStr.charAt(a)+e._keyStr.charAt(s)+e._keyStr.charAt(o)+e._keyStr.charAt(u);return c},this.encodeIgnoreUtf8=function(t){for(var n,r,i,a,s,o,u,c="",d=0;d<t.length;)a=(n=t[d++])>>2,s=(3&n)<<4|(r=t[d++])>>4,o=(15&r)<<2|(i=t[d++])>>6,u=63&i,isNaN(r)?o=u=64:isNaN(i)&&(u=64),c=c+e._keyStr.charAt(a)+e._keyStr.charAt(s)+e._keyStr.charAt(o)+e._keyStr.charAt(u);return c},this.decode=function(t){var n,r,i,a,s,o,u="",c=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<t.length;)n=e._keyStr.indexOf(t.charAt(c++))<<2|(a=e._keyStr.indexOf(t.charAt(c++)))>>4,r=(15&a)<<4|(s=e._keyStr.indexOf(t.charAt(c++)))>>2,i=(3&s)<<6|(o=e._keyStr.indexOf(t.charAt(c++))),u+=String.fromCharCode(n),64!=s&&(u+=String.fromCharCode(r)),64!=o&&(u+=String.fromCharCode(i));return e._utf8_decode(u)},this.decodeToByteArray=function(t){var n,r,i,a,s,o,u="",c=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<t.length;)n=e._keyStr.indexOf(t.charAt(c++))<<2|(a=e._keyStr.indexOf(t.charAt(c++)))>>4,r=(15&a)<<4|(s=e._keyStr.indexOf(t.charAt(c++)))>>2,i=(3&s)<<6|(o=e._keyStr.indexOf(t.charAt(c++))),u+=String.fromCharCode(n),64!=s&&(u+=String.fromCharCode(r)),64!=o&&(u+=String.fromCharCode(i));return e._out2ByteArray(u)},this._out2ByteArray=function(e){for(var t=new Array(e.length),n=0,r=0;n<e.length;)r=e.charCodeAt(n),t[n]=r,n++;return t},this._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},this._utf8_decode=function(e){for(var t="",n=0,r=0,i=0,a=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(i=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&i),n+=2):(i=e.charCodeAt(n+1),a=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&a),n+=3);return t}}function C(e){if("number"!=typeof e)throw new Error("Input must be a number");if(e<0||e>255)throw new Error("Input must be a byte");var t="";return(t+="0123456789ABCDEF".charAt(e>>4))+"0123456789ABCDEF".charAt(15&e)}function B(e){if("string"==typeof e)return e;for(var t="",n=0;n<e.length;n++){var r=e[n].toString(2),i=r.match(/^1+?(?=0)/);if(i&&8===r.length){for(var a=i[0].length,s=e[n].toString(2).slice(7-a),o=1;o<a;o++)s+=e[o+n].toString(2).slice(2);t+=String.fromCharCode(parseInt(s,2)),n+=a-1}else t+=String.fromCharCode(e[n])}return t}function D(e){for(var t=e.replace(/^0x/,"").split(""),n="",r=0;r<t.length/2;r++){var i="0x".concat(t[2*r]).concat(t[2*r+1]);n+=String.fromCharCode(i)}return n}function K(e){for(var t="",n=0;n<e.length;n++)t+=C(e[n]);return t}function R(e){return(new F).decodeToByteArray(e)}function H(e){return(new F).encodeIgnoreUtf8(e)}var V=n(9),q=n.n(V),L=/^(41)/;function U(e){return B(e)}function M(e,t,n){if(e.length!=t.length)return!1;var r;for(r=0;r<e.length;r++)if(n){if(e[r]!=t[r])return!1}else if(JSON.stringify(e[r])!=JSON.stringify(t[r]))return!1;return!0}function z(e){if("string"!=typeof e)throw new Error("The passed string is not a string");var t,n,r=new Array;t=e.length;for(var i=0;i<t;i++)(n=e.charCodeAt(i))>=65536&&n<=1114111?(r.push(n>>18&7|240),r.push(n>>12&63|128),r.push(n>>6&63|128),r.push(63&n|128)):n>=2048&&n<=65535?(r.push(n>>12&15|224),r.push(n>>6&63|128),r.push(63&n|128)):n>=128&&n<=2047?(r.push(n>>6&31|192),r.push(63&n|128)):r.push(255&n);return r}function J(e){var t;if(e>="A"&&e<="F"?t=e.charCodeAt(0)-"A".charCodeAt(0)+10:e>="a"&&e<="f"?t=e.charCodeAt(0)-"a".charCodeAt(0)+10:e>="0"&&e<="9"&&(t=e.charCodeAt(0)-"0".charCodeAt(0)),"number"==typeof t)return t;throw new Error("The passed hex char is not a valid hex char")}function G(e){return e>="A"&&e<="F"||e>="a"&&e<="f"||e>="0"&&e<="9"?1:0}function $(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"!=typeof e)throw new Error("The passed string is not a string");var n=e.length;t&&n%2&&(e="0".concat(e),n++);for(var r=Array(),i=0,a=0,s=0,o=0;o<n;o++){var u=e.charAt(o);if(!G(u))throw new Error("The passed hex char is not a valid hex string");i<<=4,i+=J(u),0==++a%2&&(r[s++]=i,i=0)}return r}function Y(e){if(!/^\d{4}-\d{2}-\d{2}( \d{2}-\d{2}-\d{2}|)/.test(e))throw new Error("The passed date string is not valid");var t=e.split(" "),n=t[0].split("-"),r=parseInt(n[0],10),i=parseInt(n[1],10)-1,a=parseInt(n[2],10);if(t.length>1){var s=t[1].split("-"),o=parseInt(s[0],10),u=parseInt(s[1],10),c=parseInt(s[2],10);return new Date(r,i,a,o,u,c)}return new Date(r,i,a)}function X(e){return e>="0"&&e<="9"?1:0}function Z(e){if(null==e)return-1;if("string"!=typeof e)return-1;if(0==e.length||""==e)return-1;var t=0;if(40==e.length)for(;t<40&&G(e.charAt(t));t++);if(40==t)return 1;for(t=0;t<e.length&&X(e.charAt(t));t++);if(t==e.length)return 2;for(t=0;t<e.length;t++)if(e.charAt(t)>" ")return 3;return-1}for(var Q="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",ee={},te=0;te<Q.length;te++)ee[Q.charAt(te)]=te;function ne(e){if(0===e.length)return"";var t,n,r=[0];for(t=0;t<e.length;t++){for(n=0;n<r.length;n++)r[n]<<=8;r[0]+=e[t];var i=0;for(n=0;n<r.length;++n)r[n]+=i,i=r[n]/58|0,r[n]%=58;for(;i;)r.push(i%58),i=i/58|0}for(t=0;0===e[t]&&t<e.length-1;t++)r.push(0);return r.reverse().map((function(e){return Q[e]})).join("")}function re(e){if(0===e.length)return[];var t,n,r=[0];for(t=0;t<e.length;t++){var i=e[t];if(!(i in ee))throw new Error("Non-base58 character");for(n=0;n<r.length;n++)r[n]*=58;r[0]+=ee[i];var a=0;for(n=0;n<r.length;++n)r[n]+=a,a=r[n]>>8,r[n]&=255;for(;a;)r.push(255&a),a>>=8}for(t=0;"1"===e[t]&&t<e.length-1;t++)r.push(0);return r.reverse()}var ie=n(17),ae=n(5),se=ae.utils.keccak256,oe=ae.utils.sha256,ue=ae.utils.toUtf8Bytes,ce=ae.utils.toUtf8String,de=ae.utils.recoverAddress,le=ae.utils.SigningKey,he=ae.utils.AbiCoder,fe=ae.utils.Interface,ve=ae.utils.FormatTypes,pe=ae.utils.arrayify,ge=ae.utils.splitSignature,ye=ae.utils.joinSignature,me=ae.utils.concat,be=ae.utils.id,ke=ae.utils.isValidMnemonic,xe=n(10),we=n(6),Ae=n(12),Ie=n(15),Pe=n(22),We=new(n(23).Logger)("tronweb/hash/5.4.0");function Se(e){return pn.address.toHex(e)}function _e(e){return Object(Ae.keccak256)(Object(Pe.toUtf8Bytes)(e))}var je=new Uint8Array(32);je.fill(0);var Te=xe.BigNumber.from(-1),Ne=xe.BigNumber.from(0),Oe=xe.BigNumber.from(1),Ee=xe.BigNumber.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Fe=Object(we.hexZeroPad)(Oe.toHexString(),32),Ce=Object(we.hexZeroPad)(Ne.toHexString(),32),Be={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},De=["name","version","chainId","verifyingContract","salt"];function Ke(e){return function(t){return"string"!=typeof t&&We.throwArgumentError("invalid domain value for ".concat(JSON.stringify(e)),"domain.".concat(e),t),t}}var Re={name:Ke("name"),version:Ke("version"),chainId:function(e){try{return xe.BigNumber.from(e).toString()}catch(e){}return We.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",e)},verifyingContract:function(e){try{return Se(e).toLowerCase()}catch(e){}return We.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",e)},salt:function(e){try{var t=Object(we.arrayify)(e);if(32!==t.length)throw new Error("bad length");return Object(we.hexlify)(t)}catch(e){}return We.throwArgumentError('invalid domain value "salt"',"domain.salt",e)}};function He(e){var t=e.match(/^(u?)int(\d*)$/);if(t){var n=""===t[1],r=parseInt(t[2]||"256");(r%8!=0||r>256||t[2]&&t[2]!==String(r))&&We.throwArgumentError("invalid numeric width","type",e);var i=Ee.mask(n?r-1:r),a=n?i.add(Oe).mul(Te):Ne;return function(t){var n=xe.BigNumber.from(t);return(n.lt(a)||n.gt(i))&&We.throwArgumentError("value out-of-bounds for ".concat(e),"value",t),Object(we.hexZeroPad)(n.toTwos(256).toHexString(),32)}}var s=e.match(/^bytes(\d+)$/);if(s){var o=parseInt(s[1]);return(0===o||o>32||s[1]!==String(o))&&We.throwArgumentError("invalid bytes width","type",e),function(t){return Object(we.arrayify)(t).length!==o&&We.throwArgumentError("invalid length for ".concat(e),"value",t),function(e){var t=Object(we.arrayify)(e),n=t.length%32;return n?Object(we.hexConcat)([t,je.slice(n)]):Object(we.hexlify)(t)}(t)}}switch(e){case"trcToken":return He("uint256");case"address":return function(e){return Object(we.hexZeroPad)((t=e,pn.address.toHex(t).replace(L,"0x")),32);var t};case"bool":return function(e){return e?Fe:Ce};case"bytes":return function(e){return Object(Ae.keccak256)(e)};case"string":return function(e){return _e(e)}}return null}function Ve(e,t){return"".concat(e,"(").concat(t.map((function(e){var t=e.name;return e.type+" "+t})).join(","),")")}var qe=function(){function e(t){y()(this,e),Object(Ie.defineReadOnly)(this,"types",Object.freeze(Object(Ie.deepCopy)(t))),Object(Ie.defineReadOnly)(this,"_encoderCache",{}),Object(Ie.defineReadOnly)(this,"_types",{});var n={},r={},i={};Object.keys(t).forEach((function(e){n[e]={},r[e]=[],i[e]={}}));var a=function(e){var i={};t[e].forEach((function(a){i[a.name]&&We.throwArgumentError("duplicate variable name ".concat(JSON.stringify(a.name)," in ").concat(JSON.stringify(e)),"types",t),i[a.name]=!0;var s=a.type.match(/^([^\x5b]*)(\x5b|$)/)[1];s===e&&We.throwArgumentError("circular type reference to ".concat(JSON.stringify(s)),"types",t),He(s)||(r[s]||We.throwArgumentError("unknown type ".concat(JSON.stringify(s)),"types",t),r[s].push(e),n[e][s]=!0)}))};for(var s in t)a(s);var o=Object.keys(r).filter((function(e){return 0===r[e].length}));for(var u in 0===o.length?We.throwArgumentError("missing primary type","types",t):o.length>1&&We.throwArgumentError("ambiguous primary types or unused types: ".concat(o.map((function(e){return JSON.stringify(e)})).join(", ")),"types",t),Object(Ie.defineReadOnly)(this,"primaryType",o[0]),function e(a,s){s[a]&&We.throwArgumentError("circular type reference to ".concat(JSON.stringify(a)),"types",t),s[a]=!0,Object.keys(n[a]).forEach((function(t){r[t]&&(e(t,s),Object.keys(s).forEach((function(e){i[e][t]=!0})))})),delete s[a]}(this.primaryType,{}),i){var c=Object.keys(i[u]);c.sort(),this._types[u]=Ve(u,t[u])+c.map((function(e){return Ve(e,t[e])})).join("")}}return b()(e,[{key:"getEncoder",value:function(e){var t=this._encoderCache[e];return t||(t=this._encoderCache[e]=this._getEncoder(e)),t}},{key:"_getEncoder",value:function(e){var t=this,n=He(e);if(n)return n;var r=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(r){var i=r[1],a=this.getEncoder(i),s=parseInt(r[3]);return function(e){s>=0&&e.length!==s&&We.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",e);var n=e.map(a);return t._types[i]&&(n=n.map(Ae.keccak256)),Object(Ae.keccak256)(Object(we.hexConcat)(n))}}var o=this.types[e];if(o){var u=_e(this._types[e]);return function(e){var n=o.map((function(n){var r=n.name,i=n.type,a=t.getEncoder(i)(e[r]);return t._types[i]?Object(Ae.keccak256)(a):a}));return n.unshift(u),Object(we.hexConcat)(n)}}return We.throwArgumentError("unknown type: ".concat(e),"type",e)}},{key:"encodeType",value:function(e){var t=this._types[e];return t||We.throwArgumentError("unknown type: ".concat(JSON.stringify(e)),"name",e),t}},{key:"encodeData",value:function(e,t){return this.getEncoder(e)(t)}},{key:"hashStruct",value:function(e,t){return Object(Ae.keccak256)(this.encodeData(e,t))}},{key:"encode",value:function(e){return this.encodeData(this.primaryType,e)}},{key:"hash",value:function(e){return this.hashStruct(this.primaryType,e)}},{key:"_visit",value:function(e,t,n){var r=this;if(He(e))return n(e,t);var i=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(i){var a=i[1],s=parseInt(i[3]);return s>=0&&t.length!==s&&We.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",t),t.map((function(e){return r._visit(a,e,n)}))}var o=this.types[e];return o?o.reduce((function(e,i){var a=i.name,s=i.type;return e[a]=r._visit(s,t[a],n),e}),{}):We.throwArgumentError("unknown type: ".concat(e),"type",e)}},{key:"visit",value:function(e,t){return this._visit(this.primaryType,e,t)}}],[{key:"from",value:function(t){return new e(t)}},{key:"getPrimaryType",value:function(t){return e.from(t).primaryType}},{key:"hashStruct",value:function(t,n,r){return e.from(n).hashStruct(t,r)}},{key:"hashDomain",value:function(t){var n=[];for(var r in t){var i=Be[r];i||We.throwArgumentError("invalid typed-data domain key: ".concat(JSON.stringify(r)),"domain",t),n.push({name:r,type:i})}return n.sort((function(e,t){return De.indexOf(e.name)-De.indexOf(t.name)})),e.hashStruct("EIP712Domain",{EIP712Domain:n},t)}},{key:"encode",value:function(t,n,r){return Object(we.hexConcat)(["0x1901",e.hashDomain(t),e.from(n).hash(r)])}},{key:"hash",value:function(t,n,r){return Object(Ae.keccak256)(e.encode(t,n,r))}},{key:"getPayload",value:function(t,n,r){e.hashDomain(t);var i={},a=[];De.forEach((function(e){var n=t[e];null!=n&&(i[e]=Re[e](n),a.push({name:e,type:Be[e]}))}));var s=e.from(n),o=Object(Ie.shallowCopy)(n);return o.EIP712Domain?We.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",n):o.EIP712Domain=a,s.encode(r),{types:o,domain:i,primaryType:s.primaryType,message:s.visit(r,(function(e,t){if(e.match(/^bytes(\d*)/))return Object(we.hexlify)(Object(we.arrayify)(t));if(e.match(/^u?int/))return xe.BigNumber.from(t).toString();switch(e){case"trcToken":return xe.BigNumber.from(t).toString();case"address":return Se(t).toLowerCase();case"bool":return!!t;case"string":return"string"!=typeof t&&We.throwArgumentError("invalid string","value",t),t}return We.throwArgumentError("unsupported type","type",e)}))}}}]),e}();function Le(e){var t=st(e),n=st(t).slice(0,4);return ne(n=e.concat(n))}function Ue(e){if("string"!=typeof e)return!1;if(e.length<=4)return!1;var t=re(e);if(e.length<=4)return!1;var n=t.length-4,r=t.slice(n),i=st(t=t.slice(0,n)),a=st(i).slice(0,4);if(r[0]==a[0]&&r[1]==a[1]&&r[2]==a[2]&&r[3]==a[3])return t;throw new Error("Invalid address provided")}function Me(e,t){"string"==typeof e&&(e=$(e));var n=at($(t.txID),e);return Array.isArray(t.signature)?t.signature.includes(n)||t.signature.push(n):t.signature=[n],t}function ze(e){return btoa(String.fromCharCode.apply(String,q()(e)))}function Je(e,t){return"string"==typeof e&&(e=$(e)),at(st(t),e)}function Ge(e,t,n,r){var i=new le({toHexString:function(){return"0x"+r},value:r}),a=qe.hash(e,t,n),s=i.signDigest(a);return["0x",s.r.substring(2),s.s.substring(2),Number(s.v).toString(16)].join("")}function $e(e){var t=R(e);return proto.protocol.Transaction.deserializeBinary(t).getRawData().serializeBinary()}function Ye(){for(var e=new ie.ec("secp256k1").genKeyPair().getPrivate().toString("hex");e.length<64;)e="0".concat(e);return $(e)}function Xe(e){return 65===e.length&&(e=e.slice(1)),$("41"+se(e).toString().substring(2).substring(24))}function Ze(e){return Xe(it(e))}function Qe(e){var t=re(e);if(t.length<=4)return!1;var n=t.slice(0,t.length-4),r=st(n),i=st(r);return i[0]===t[n.length]&&i[1]===t[n.length+1]&&i[2]===t[n.length+2]&&i[3]===t[n.length+3]&&n}function et(e){if("string"!=typeof e)return!1;if(34!==e.length)return!1;var t=re(e);if(25!==t.length)return!1;if(65!==t[0])return!1;var n=t.slice(21),r=st(t=t.slice(0,21)),i=st(r).slice(0,4);return n[0]==i[0]&&n[1]==i[1]&&n[2]==i[2]&&n[3]==i[3]}function tt(e){return Le(Xe(it(R(e))))}function nt(e){return K(Xe(it(R(e))))}function rt(e){return H(Xe(it(R(e))))}function it(e){for(var t=new ie.ec("secp256k1").keyFromPrivate(e,"bytes").getPublic(),n=t.x,r=t.y,i=n.toString("hex");i.length<64;)i="0".concat(i);for(var a=r.toString("hex");a.length<64;)a="0".concat(a);return $("04".concat(i).concat(a))}function at(e,t){for(var n=new ie.ec("secp256k1").keyFromPrivate(t,"bytes").sign(e),r=n.r,i=n.s,a=n.recoveryParam,s=r.toString("hex");s.length<64;)s="0".concat(s);for(var o=i.toString("hex");o.length<64;)o="0".concat(o);return s+o+C(a)}function st(e){var t=K(e);return $(oe("0x"+t).replace(/^0x/,""))}function ot(e){return Le(Ze(R(e)))}function ut(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=$(e,t),r=Ze(n);return Le(r)}function ct(){var e=Ye(),t=it(e),n=Ze(e);return{privateKey:K(e),publicKey:K(t),address:{base58:Le(n),hex:K(n)}}}function dt(e){if(Nt.isObject(e)||(e={}),e.path||(e.path="m/44'/195'/0'/0/0"),!String(e.path).match(/^m\/44\'\/195\'/))throw new Error("Invalid tron path provided");var t=ae.Wallet.createRandom(e);return{mnemonic:t.mnemonic,privateKey:t.privateKey,publicKey:t.publicKey,address:ut(t.privateKey.replace(/^0x/,""))}}function lt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en";if(t||(t="m/44'/195'/0'/0/0"),!String(t).match(/^m\/44\'\/195\'/))throw new Error("Invalid tron path provided");var r=ae.Wallet.fromMnemonic(e,t,n),i={mnemonic:r.mnemonic,privateKey:r.privateKey,publicKey:r.publicKey,address:ut(r.privateKey.replace(/^0x/,""))};return i}var ht=new he;function ft(e){return pn.address.toHex(e).replace(L,"0x")}function vt(e){if("[object Object]"!==Object.prototype.toString.call(e)&&"[object Array]"!==Object.prototype.toString.call(e))return e;var t,n=(t=e,Array.isArray(t)?[]:{});return Object.keys(e).forEach((function(t){return n[t]=e[t]instanceof Object&&!e[t]._isBigNumber?vt(e[t]):e[t]})),n}function pt(e,t,n,r){if(n&&"boolean"!=typeof n||(r=n,n=t,t=e,e=[]),r&&n.replace(/^0x/,"").length%64==8&&(n="0x"+n.replace(/^0x/,"").substring(8)),n.replace(/^0x/,"").length%64)throw new Error("The encoded string is not valid. Its length must be a multiple of 64.");return t=t.map((function(e){return/trcToken/.test(e)&&(e=e.replace(/trcToken/,"uint256")),e})),ht.decode(t,n).reduce((function(n,r,i){return"address"==t[i]&&(r="41"+r.substr(2).toLowerCase()),e.length?n[e[i]]=r:n.push(r),n}),e.length?{}:[])}function gt(e,t){for(var n=0;n<e.length;n++)"address"===e[n]&&(t[n]=pn.address.toHex(t[n]).replace(L,"0x"));return ht.encode(e,t)}function yt(e){var t=e.match(/([a-zA-Z0-9])(\[.*\])/);return t?t[2]:""}function mt(e){return(yt(e).match(/\]\[/g)||[]).length+1}function bt(e,t){var n=[],r=function e(t){if(t&&0===t.type.indexOf("tuple")&&t.components){var n=t.components.map((function(t){return e(t)}));return"tuple(".concat(n.join(","),")").concat(yt(t.type))}return/trcToken/.test(t.type)?t.type.replace(/trcToken/,"uint256"):t.type},i=function e(t){return Array.isArray(t)?(t.forEach((function(n,r){t[r]=e(n)})),t):ft(t)},a=function e(t,n,r){r>1?n.length&&n.forEach((function(n){e(t,n,r-1)})):n.length&&r&&n.forEach((function(e){s(t,e)}))},s=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.length&&t.forEach((function(t,r){var s=t.type;if(n[r])if("address"===s)n[r]=ft(n[r]);else if("address["===s.match(/^([^\x5b]*)(\x5b|$)/)[0])i(n[r]);else if(0===s.indexOf("tuple"))if(yt(s)){var o=mt(s);a(t.components,n[r],o)}else e(t.components,n[r])}))};if(e.inputs&&e.inputs.length)for(var o=0;o<e.inputs.length;o++){var u=e.inputs[o].type;"bool"===u&&"false"===t[o]&&(t[o]=!1),n.push(0===u.indexOf("tuple")?r(e.inputs[o]):u),t.length<n.length&&t.push("")}return s(e.inputs,t),function(e){for(var t=0;t<e.length;t++){var n=e[t];/trcToken/.test(n)&&(e[t]=n.replace(/trcToken/,"uint256"))}}(n),ht.encode(n,t)}function kt(e,t){var n=function e(t){return Array.isArray(t)?(t.forEach((function(n,r){t[r]=e(n)})),t):pn.address.toHex(t)},r=function e(t,n,r){r>1?n.length&&n.forEach((function(n){e(t,n,r-1)})):n.length&&r&&n.forEach((function(e){a(t,e)}))},i=function e(t){var n=t.name?" ".concat(t.name):"";if(t&&0===t.type.indexOf("tuple")&&t.components){var r=t.components.map((function(t){return e(t)}));return"tuple(".concat(r.join(","),")").concat(yt(t.type)).concat(n)}return/trcToken/.test(t.type)?t.type.replace(/trcToken/,"uint256")+n:t.type+n},a=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1?arguments[1]:void 0;t.length&&t.forEach((function(t,a){var s=t.type,o=t.name;if(i[a])if("address"===s)i[a]=pn.address.toHex(i[a]),o&&(i[o]=pn.address.toHex(i[o]));else if("address["===s.match(/^([^\x5b]*)(\x5b|$)/)[0])n(i[a]),o&&n(i[o]);else if(0===s.indexOf("tuple")){if(yt(s)){var u=mt(s);r(t.components,i[a],u)}else e(t.components,i[a]);o&&(i[o]=i[a])}}))};if(e.outputs&&e.outputs.length>0){for(var s=[],o=0;o<e.outputs.length;o++){var u=e.outputs[o].type,c=e.outputs[o].name?" ".concat(e.outputs[o].name):"";s.push(0===u.indexOf("tuple")?i(e.outputs[o]):u+c)}!function(e){for(var t=0;t<e.length;t++){var n=e[t];/^trcToken/.test(n)&&(e[t]=n.replace(/^trcToken/,"uint256"))}}(s),t&&t.length||(t=new Uint8Array(32*e.outputs.length));var d=vt(ht.decode(s,t));return a(e.outputs,d),d}return[]}var xt="\x19TRON Signed Message:\n";function wt(e){return"string"==typeof e&&(e=ue(e)),se(me([ue(xt),ue(String(e.length)),e]))}function At(e,t){t.match(/^0x/)||(t="0x"+t);var n=new le(t),r=wt(e),i=n.signDigest(r);return ye(i)}function It(e,t){return t.match(/^0x/)||(t="0x"+t),Le($(de(wt(e),t).replace(/^0x/,"41")))}var Pt=n(24),Wt=n.n(Pt),St=n(13),_t=n.n(St);function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nt=Tt(Tt({},{isValidURL:function(e){return"string"==typeof e&&Wt.a.isURL(e.toString(),{protocols:["http","https"],require_tld:!1})},isObject:function(e){return e===Object(e)&&"[object Array]"!==Object.prototype.toString.call(e)},isArray:function(e){return Array.isArray(e)},isJson:function(e){try{return!!JSON.parse(e)}catch(e){return!1}},isBoolean:function(e){return"boolean"==typeof e},isBigNumber:function(e){return e&&(e instanceof _t.a||e.constructor&&"BigNumber"===e.constructor.name)},isString:function(e){return"string"==typeof e||e&&e.constructor&&"String"===e.constructor.name},isFunction:function(e){return"function"==typeof e},isHex:function(e){return"string"==typeof e&&!isNaN(parseInt(e,16))&&/^(0x|)[a-fA-F0-9]+$/.test(e)},isInteger:function(e){return null!==e&&Number.isInteger(Number(e))},hasProperty:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},hasProperties:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.length&&!r.map((function(n){return t.hasProperty(e,n)})).includes(!1)},mapEvent:function(e){var t={block:e.block_number,timestamp:e.block_timestamp,contract:e.contract_address,name:e.event_name,transaction:e.transaction_id,result:e.result,resourceNode:e.resource_Node||(e._unconfirmed?"fullNode":"solidityNode")};return e._unconfirmed&&(t.unconfirmed=e._unconfirmed),e._fingerprint&&(t.fingerprint=e._fingerprint),t},parseEvent:function(e,t){var n=t.inputs;if(!e.result)return e;if(this.isObject(e.result))for(var r=0;r<n.length;r++){var i=n[r];"address"==i.type&&i.name in e.result&&(e.result[i.name]="41"+e.result[i.name].substr(2).toLowerCase())}else this.isArray(e.result)&&(e.result=e.result.reduce((function(e,t,r){var i=n[r],a=i.name;return"address"==i.type&&(t="41"+t.substr(2).toLowerCase()),e[a]=t,e}),{}));return e},padLeft:function(e,t,n){for(var r=e.toString();r.length<n;)r=t+r;return r},isNotNullOrUndefined:function(e){return null!=e},sleep:function(){var e=arguments;return f()(N.a.mark((function t(){var n;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:1e3,t.abrupt("return",new Promise((function(e){return setTimeout(e,n)})));case 2:case"end":return t.stop()}}),t)})))()}}),{},{code:a,accounts:c,base58:s,bytes:i,crypto:u,abi:d,message:l,_TypedDataEncoder:qe,ethersUtils:o}),Ot={HttpProvider:function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"/";if(y()(this,e),!Nt.isValidURL(t))throw new Error("Invalid URL provided to HttpProvider");if(isNaN(n)||n<0)throw new Error("Invalid timeout duration provided");if(!Nt.isObject(a))throw new Error("Invalid headers object provided");t=t.replace(/\/+$/,""),this.host=t,this.timeout=n,this.user=r,this.password=i,this.headers=a,this.statusPage=s,this.instance=E.a.create({baseURL:t,timeout:n,headers:a,auth:r&&{user:r,password:i}})}var t;return b()(e,[{key:"setStatusPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";this.statusPage=e}},{key:"isConnected",value:(t=f()(N.a.mark((function e(){var t,n=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.statusPage,e.abrupt("return",this.request(t).then((function(e){return Nt.hasProperties(e,"blockID","block_header")})).catch((function(){return!1})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get";return n=n.toLowerCase(),this.instance.request({data:"post"==n&&Object.keys(t).length?t:null,params:"get"==n&&t,url:e,method:n}).then((function(e){return e.data}))}}]),e}()},Et=n(25),Ft=n.n(Et),Ct=n(26),Bt=n(16),Dt=n.n(Bt),Kt=n(7),Rt=n.n(Kt),Ht=n(11),Vt=n.n(Ht);function qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ut,Mt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(y()(this,e),!t||!t instanceof pn)throw new Error("Expected instance of TronWeb");this.tronWeb=t}return b()(e,[{key:"invalid",value:function(e){return e.msg||"Invalid ".concat(e.name).concat("address"===e.type?" address":""," provided")}},{key:"notPositive",value:function(e){return"".concat(e.name," must be a positive integer")}},{key:"notEqual",value:function(e){return e.msg||"".concat(e.names[0]," can not be equal to ").concat(e.names[1])}},{key:"notValid",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Function,r={},i=!1,a=qt(t);try{for(a.s();!(e=a.n()).done;){var s=e.value,o=s.name,u=s.names,c=s.value,d=s.type,l=s.gt,h=s.lt,f=s.gte,v=s.lte,p=(s.se,s.optional);if(!p||Nt.isNotNullOrUndefined(c)&&("boolean"===d||!1!==c)){switch(r[s.name]=s.value,d){case"address":this.tronWeb.isAddress(c)?r[o]=this.tronWeb.address.toHex(c):i=!0;break;case"integer":(!Nt.isInteger(c)||"number"==typeof l&&c<=s.gt||"number"==typeof h&&c>=s.lt||"number"==typeof f&&c<s.gte||"number"==typeof v&&c>s.lte)&&(i=!0);break;case"positive-integer":if(!Nt.isInteger(c)||c<=0)return void n(this.notPositive(s));break;case"tokenId":case"not-empty-string":Nt.isString(c)&&c.length||(i=!0);break;case"notEmptyObject":Nt.isObject(c)&&Object.keys(c).length||(i=!0);break;case"notEqual":if(r[u[0]]===r[u[1]])return n(this.notEqual(s)),!0;break;case"resource":["BANDWIDTH","ENERGY"].includes(c)||(i=!0);break;case"url":Nt.isValidURL(c)||(i=!0);break;case"hex":Nt.isHex(c)||(i=!0);break;case"array":Array.isArray(c)||(i=!0);break;case"boolean":Nt.isBoolean(c)||(i=!0);break;case"string":(!Nt.isString(c)||"number"==typeof l&&c.length<=s.gt||"number"==typeof h&&c.length>=s.lt||"number"==typeof f&&c.length<s.gte||"number"==typeof v&&c.length>s.lte)&&(i=!0)}if(i)return n(this.invalid(s)),!0}}}catch(e){a.e(e)}finally{a.f()}return!1}}]),e}();function zt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Jt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function Jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gt(e){return pn.address.toHex(e)}function $t(e){return Ut.tronWeb.fromUtf8(e)}function Yt(e,t){return e.Error?t(e.Error):e.result&&e.result.message?t(Ut.tronWeb.toUtf8(e.result.message)):t(null,e)}var Xt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(y()(this,e),!t||!t instanceof pn)throw new Error("Expected instance of TronWeb");Ut=this,this.tronWeb=t,this.injectPromise=Rt()(this),this.validator=new Mt(t)}var t,n,r,i;return b()(e,[{key:"sendTrx",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.tronWeb.defaultAddress.hex,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Nt.isFunction(r)&&(i=r,r={}),Nt.isFunction(n)?(i=n,n=this.tronWeb.defaultAddress.hex):Nt.isObject(n)&&(r=n,n=this.tronWeb.defaultAddress.hex),!i)return this.injectPromise(this.sendTrx,e,t,n,r);if(t=parseInt(t),!this.validator.notValid([{name:"recipient",type:"address",value:e},{name:"origin",type:"address",value:n},{names:["recipient","origin"],type:"notEqual",msg:"Cannot transfer TRX to the same account"},{name:"amount",type:"integer",gt:0,value:t}],i)){var a={to_address:Gt(e),owner_address:Gt(n),amount:t};r&&r.permissionId&&(a.Permission_id=r.permissionId),this.tronWeb.fullNode.request("wallet/createtransaction",a,"post").then((function(e){return Yt(e,i)})).catch((function(e){return i(e)}))}}},{key:"sendToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.tronWeb.defaultAddress.hex,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(Nt.isFunction(i)&&(a=i,i={}),Nt.isFunction(r)?(a=r,r=this.tronWeb.defaultAddress.hex):Nt.isObject(r)&&(i=r,r=this.tronWeb.defaultAddress.hex),!a)return this.injectPromise(this.sendToken,e,t,n,r,i);if(t=parseInt(t),!this.validator.notValid([{name:"recipient",type:"address",value:e},{name:"origin",type:"address",value:r},{names:["recipient","origin"],type:"notEqual",msg:"Cannot transfer tokens to the same account"},{name:"amount",type:"integer",gt:0,value:t},{name:"token ID",type:"tokenId",value:n}],a)){var s={to_address:Gt(e),owner_address:Gt(r),asset_name:$t(n),amount:parseInt(t)};i&&i.permissionId&&(s.Permission_id=i.permissionId),this.tronWeb.fullNode.request("wallet/transferasset",s,"post").then((function(e){return Yt(e,a)})).catch((function(e){return a(e)}))}}},{key:"purchaseToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.tronWeb.defaultAddress.hex,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(Nt.isFunction(i)&&(a=i,i={}),Nt.isFunction(r)?(a=r,r=this.tronWeb.defaultAddress.hex):Nt.isObject(r)&&(i=r,r=this.tronWeb.defaultAddress.hex),!a)return this.injectPromise(this.purchaseToken,e,t,n,r,i);if(!this.validator.notValid([{name:"buyer",type:"address",value:r},{name:"issuer",type:"address",value:e},{names:["buyer","issuer"],type:"notEqual",msg:"Cannot purchase tokens from same account"},{name:"amount",type:"integer",gt:0,value:n},{name:"token ID",type:"tokenId",value:t}],a)){var s={to_address:Gt(e),owner_address:Gt(r),asset_name:$t(t),amount:parseInt(n)};i&&i.permissionId&&(s.Permission_id=i.permissionId),this.tronWeb.fullNode.request("wallet/participateassetissue",s,"post").then((function(e){return Yt(e,a)})).catch((function(e){return a(e)}))}}},{key:"freezeBalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"BANDWIDTH",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.tronWeb.defaultAddress.hex,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(Nt.isFunction(a)&&(s=a,a={}),Nt.isFunction(i)?(s=i,i=void 0):Nt.isObject(i)&&(a=i,i=void 0),Nt.isFunction(r)?(s=r,r=this.tronWeb.defaultAddress.hex):Nt.isObject(r)&&(a=r,r=this.tronWeb.defaultAddress.hex),Nt.isFunction(t)&&(s=t,t=3),Nt.isFunction(n)&&(s=n,n="BANDWIDTH"),!s)return this.injectPromise(this.freezeBalance,e,t,n,r,i,a);if(!this.validator.notValid([{name:"origin",type:"address",value:r},{name:"receiver",type:"address",value:i,optional:!0},{name:"amount",type:"integer",gt:0,value:e},{name:"duration",type:"integer",gte:3,value:t},{name:"resource",type:"resource",value:n,msg:'Invalid resource provided: Expected "BANDWIDTH" or "ENERGY'}],s)){var o={owner_address:Gt(r),frozen_balance:parseInt(e),frozen_duration:parseInt(t),resource:n};Nt.isNotNullOrUndefined(i)&&Gt(i)!==Gt(r)&&(o.receiver_address=Gt(i)),a&&a.permissionId&&(o.Permission_id=a.permissionId),this.tronWeb.fullNode.request("wallet/freezebalance",o,"post").then((function(e){return Yt(e,s)})).catch((function(e){return s(e)}))}}},{key:"unfreezeBalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"BANDWIDTH",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Nt.isFunction(r)&&(i=r,r={}),Nt.isFunction(n)?(i=n,n=void 0):Nt.isObject(n)&&(r=n,n=void 0),Nt.isFunction(t)?(i=t,t=this.tronWeb.defaultAddress.hex):Nt.isObject(t)&&(r=t,t=this.tronWeb.defaultAddress.hex),Nt.isFunction(e)&&(i=e,e="BANDWIDTH"),!i)return this.injectPromise(this.unfreezeBalance,e,t,n,r);if(!this.validator.notValid([{name:"origin",type:"address",value:t},{name:"receiver",type:"address",value:n,optional:!0},{name:"resource",type:"resource",value:e,msg:'Invalid resource provided: Expected "BANDWIDTH" or "ENERGY'}],i)){var a={owner_address:Gt(t),resource:e};Nt.isNotNullOrUndefined(n)&&Gt(n)!==Gt(t)&&(a.receiver_address=Gt(n)),r&&r.permissionId&&(a.Permission_id=r.permissionId),this.tronWeb.fullNode.request("wallet/unfreezebalance",a,"post").then((function(e){return Yt(e,i)})).catch((function(e){return i(e)}))}}},{key:"withdrawBlockRewards",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Nt.isFunction(t)&&(n=t,t={}),Nt.isFunction(e)?(n=e,e=this.tronWeb.defaultAddress.hex):Nt.isObject(e)&&(t=e,e=this.tronWeb.defaultAddress.hex),!n)return this.injectPromise(this.withdrawBlockRewards,e,t);if(!this.validator.notValid([{name:"origin",type:"address",value:e}],n)){var r={owner_address:Gt(e)};t&&t.permissionId&&(r.Permission_id=t.permissionId),this.tronWeb.fullNode.request("wallet/withdrawbalance",r,"post").then((function(e){return Yt(e,n)})).catch((function(e){return n(e)}))}}},{key:"applyForSR",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Nt.isFunction(n)&&(r=n,n={}),Nt.isObject(t)&&Nt.isValidURL(e)&&(n=t,t=e,e=this.tronWeb.defaultAddress.hex),!r)return this.injectPromise(this.applyForSR,e,t,n);if(!this.validator.notValid([{name:"origin",type:"address",value:e},{name:"url",type:"url",value:t,msg:"Invalid url provided"}],r)){var i={owner_address:Gt(e),url:$t(t)};n&&n.permissionId&&(i.Permission_id=n.permissionId),this.tronWeb.fullNode.request("wallet/createwitness",i,"post").then((function(e){return Yt(e,r)})).catch((function(e){return r(e)}))}}},{key:"vote",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Nt.isFunction(r)&&(i=r,r={}),Nt.isFunction(n)?(i=n,n=this.tronWeb.defaultAddress.hex):Nt.isObject(n)&&(r=n,n=this.tronWeb.defaultAddress.hex),!i)return this.injectPromise(this.vote,t,n,r);if(!this.validator.notValid([{name:"voter",type:"address",value:n},{name:"votes",type:"notEmptyObject",value:t}],i)){var a=!1;if(t=Object.entries(t).map((function(t){var n=Vt()(t,2),r=n[0],i=n[1];if(!a)return e.validator.notValid([{name:"SR",type:"address",value:r},{name:"vote count",type:"integer",gt:0,value:i,msg:"Invalid vote count provided for SR: "+r}])?a=!0:{vote_address:Gt(r),vote_count:parseInt(i)}})),!a){var s={owner_address:Gt(n),votes:t};r&&r.permissionId&&(s.Permission_id=r.permissionId),this.tronWeb.fullNode.request("wallet/votewitnessaccount",s,"post").then((function(e){return Yt(e,i)})).catch((function(e){return i(e)}))}}}},{key:"createSmartContract",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Nt.isFunction(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),!n)return this.injectPromise(this.createSmartContract,e,t);var r=e.feeLimit||this.tronWeb.feeLimit,i=e.userFeePercentage;"number"==typeof i||i||(i=100);var a=e.originEnergyLimit||1e7,s=e.callValue||0,o=e.tokenValue,u=e.tokenId||e.token_id,c=e.abi,d=void 0!==c&&c,l=e.bytecode,h=void 0!==l&&l,f=e.parameters,v=void 0===f?[]:f,p=e.name,g=void 0===p?"":p;if(d&&Nt.isString(d))try{d=JSON.parse(d)}catch(e){return n("Invalid options.abi provided")}if(d.entrys&&(d=d.entrys),!Nt.isArray(d))return n("Invalid options.abi provided");var y=d.some((function(e){return"constructor"===e.type&&"payable"===e.stateMutability.toLowerCase()}));if(!this.validator.notValid([{name:"bytecode",type:"hex",value:h},{name:"feeLimit",type:"integer",value:r,gt:0},{name:"callValue",type:"integer",value:s,gte:0},{name:"userFeePercentage",type:"integer",value:i,gte:0,lte:100},{name:"originEnergyLimit",type:"integer",value:a,gte:0,lte:1e7},{name:"parameters",type:"array",value:v},{name:"issuer",type:"address",value:t},{name:"tokenValue",type:"integer",value:o,gte:0,optional:!0},{name:"tokenId",type:"integer",value:u,gte:0,optional:!0}],n)){if(y&&0==s&&0==o)return n("When contract is payable, options.callValue or options.tokenValue must be a positive integer");if(!y&&(s>0||o>0))return n("When contract is not payable, options.callValue and options.tokenValue must be 0");if(e.rawParameter&&Nt.isString(e.rawParameter))v=e.rawParameter.replace(/^(0x)/,"");else if(e.funcABIV2)v=bt(e.funcABIV2,e.parametersV2).replace(/^(0x)/,"");else{var m=d.find((function(e){return"constructor"===e.type}));if(void 0!==m&&m){var b=new he,k=[],x=[];if(m=m.inputs,v.length!=m.length)return n("constructor needs ".concat(m.length," but ").concat(v.length," provided"));for(var w=0;w<v.length;w++){var A=m[w].type,I=v[w];if(!A||!Nt.isString(A)||!A.length)return n("Invalid parameter type provided: "+A);"address"===A?I=Gt(I).replace(L,"0x"):"address["===A.match(/^([^\x5b]*)(\x5b|$)/)[0]?I=I.map((function(e){return Gt(e).replace(L,"0x")})):/trcToken/.test(A)&&(A=A.replace(/trcToken/,"uint256")),k.push(A),x.push(I)}try{v=b.encode(k,x).replace(/^(0x)/,"")}catch(e){return n(e)}}else v=""}var P={owner_address:Gt(t),fee_limit:parseInt(r),call_value:parseInt(s),consume_user_resource_percent:i,origin_energy_limit:a,abi:JSON.stringify(d),bytecode:h,parameter:v,name:g};Nt.isNotNullOrUndefined(o)&&(P.call_token_value=parseInt(o)),Nt.isNotNullOrUndefined(u)&&(P.token_id=parseInt(u)),e&&e.permissionId&&(P.Permission_id=e.permissionId),this.tronWeb.fullNode.request("wallet/deploycontract",P,"post").then((function(e){return Yt(e,n)})).catch((function(e){return n(e)}))}}},{key:"triggerSmartContract",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"object"!==p()(t[2])&&(t[2]={feeLimit:t[2],callValue:t[3]},t.splice(3,1)),this._triggerSmartContract.apply(this,t)}},{key:"triggerConstantContract",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[2]._isConstant=!0,this.triggerSmartContract.apply(this,t)}},{key:"triggerConfirmedConstantContract",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[2]._isConstant=!0,t[2].confirmed=!0,this.triggerSmartContract.apply(this,t)}},{key:"_triggerSmartContract",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.tronWeb.defaultAddress.hex,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(Nt.isFunction(i)&&(a=i,i=this.tronWeb.defaultAddress.hex),Nt.isFunction(r)&&(a=r,r=[]),!a)return this.injectPromise(this._triggerSmartContract,e,t,n,r,i);var s=Object.assign({callValue:0,feeLimit:this.tronWeb.feeLimit},n),o=s.tokenValue,u=s.tokenId,c=s.callValue,d=s.feeLimit;if(!this.validator.notValid([{name:"feeLimit",type:"integer",value:d,gt:0},{name:"callValue",type:"integer",value:c,gte:0},{name:"parameters",type:"array",value:r},{name:"contract",type:"address",value:e},{name:"issuer",type:"address",value:i,optional:!0},{name:"tokenValue",type:"integer",value:o,gte:0,optional:!0},{name:"tokenId",type:"integer",value:u,gte:0,optional:!0}],a)){var l={contract_address:Gt(e),owner_address:Gt(i)};if(t&&Nt.isString(t)){if(t=t.replace("/s*/g",""),r.length){for(var h=new he,f=[],v=[],p=0;p<r.length;p++){var g=r[p],y=g.type,m=g.value;if(!y||!Nt.isString(y)||!y.length)return a("Invalid parameter type provided: "+y);"address"===y?m=Gt(m).replace(L,"0x"):"address["===y.match(/^([^\x5b]*)(\x5b|$)/)[0]&&(m=m.map((function(e){return Gt(e).replace(L,"0x")}))),f.push(y),v.push(m)}try{f=f.map((function(e){return/trcToken/.test(e)&&(e=e.replace(/trcToken/,"uint256")),e})),r=h.encode(f,v).replace(/^(0x)/,"")}catch(e){return a(e)}}else r="";n.funcABIV2&&(r=bt(n.funcABIV2,n.parametersV2).replace(/^(0x)/,"")),n.shieldedParameter&&Nt.isString(n.shieldedParameter)&&(r=n.shieldedParameter.replace(/^(0x)/,"")),n.rawParameter&&Nt.isString(n.rawParameter)&&(r=n.rawParameter.replace(/^(0x)/,"")),l.function_selector=t,l.parameter=r}l.call_value=parseInt(c),Nt.isNotNullOrUndefined(o)&&(l.call_token_value=parseInt(o)),Nt.isNotNullOrUndefined(u)&&(l.token_id=parseInt(u)),n._isConstant||(l.fee_limit=parseInt(d)),n.permissionId&&(l.Permission_id=n.permissionId),this.tronWeb[n.confirmed?"solidityNode":"fullNode"].request("wallet".concat(n.confirmed?"solidity":"","/trigger").concat(n._isConstant?"constant":"smart","contract"),l,"post").then((function(e){return Yt(e,a)})).catch((function(e){return a(e)}))}}},{key:"clearABI",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n)return this.injectPromise(this.clearABI,e,t);if(!this.tronWeb.isAddress(e))return n("Invalid contract address provided");if(!this.tronWeb.isAddress(t))return n("Invalid owner address provided");var r={contract_address:Gt(e),owner_address:Gt(t)};this.tronWeb.trx.cache.contracts[e]&&delete this.tronWeb.trx.cache.contracts[e],this.tronWeb.fullNode.request("wallet/clearabi",r,"post").then((function(e){return Yt(e,n)})).catch((function(e){return n(e)}))}},{key:"updateBrokerage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n)return this.injectPromise(this.updateBrokerage,e,t);if(!Nt.isNotNullOrUndefined(e))return n("Invalid brokerage provided");if(!Nt.isInteger(e)||e<0||e>100)return n("Brokerage must be an integer between 0 and 100");if(!this.tronWeb.isAddress(t))return n("Invalid owner address provided");var r={brokerage:parseInt(e),owner_address:Gt(t)};this.tronWeb.fullNode.request("wallet/updateBrokerage",r,"post").then((function(e){return Yt(e,n)})).catch((function(e){return n(e)}))}},{key:"createToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Nt.isFunction(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),!n)return this.injectPromise(this.createToken,e,t);var r=e.name,i=void 0!==r&&r,a=e.abbreviation,s=void 0!==a&&a,o=e.description,u=void 0!==o&&o,c=e.url,d=void 0!==c&&c,l=e.totalSupply,h=void 0===l?0:l,f=e.trxRatio,v=void 0===f?1:f,p=e.tokenRatio,g=void 0===p?1:p,y=e.saleStart,m=void 0===y?Date.now():y,b=e.saleEnd,k=void 0!==b&&b,x=e.freeBandwidth,w=void 0===x?0:x,A=e.freeBandwidthLimit,I=void 0===A?0:A,P=e.frozenAmount,W=void 0===P?0:P,S=e.frozenDuration,_=void 0===S?0:S,j=e.voteScore,T=e.precision;if(!this.validator.notValid([{name:"Supply amount",type:"positive-integer",value:h},{name:"TRX ratio",type:"positive-integer",value:v},{name:"Token ratio",type:"positive-integer",value:g},{name:"token abbreviation",type:"not-empty-string",value:s},{name:"token name",type:"not-empty-string",value:i},{name:"token description",type:"not-empty-string",value:u},{name:"token url",type:"url",value:d},{name:"issuer",type:"address",value:t},{name:"sale start timestamp",type:"integer",value:m,gte:Date.now()},{name:"sale end timestamp",type:"integer",value:k,gt:m},{name:"Free bandwidth amount",type:"integer",value:w,gte:0},{name:"Free bandwidth limit",type:"integer",value:I,gte:0},{name:"Frozen supply",type:"integer",value:W,gte:0},{name:"Frozen duration",type:"integer",value:_,gte:0}],n)){if(Nt.isNotNullOrUndefined(j)&&(!Nt.isInteger(j)||j<=0))return n("voteScore must be a positive integer greater than 0");if(Nt.isNotNullOrUndefined(T)&&(!Nt.isInteger(T)||T<0||T>6))return n("precision must be a positive integer >= 0 and <= 6");var N={owner_address:Gt(t),name:$t(i),abbr:$t(s),description:$t(u),url:$t(d),total_supply:parseInt(h),trx_num:parseInt(v),num:parseInt(g),start_time:parseInt(m),end_time:parseInt(k),free_asset_net_limit:parseInt(w),public_free_asset_net_limit:parseInt(I),frozen_supply:{frozen_amount:parseInt(W),frozen_days:parseInt(_)}};parseInt(W)>0||delete N.frozen_supply,T&&!isNaN(parseInt(T))&&(N.precision=parseInt(T)),j&&!isNaN(parseInt(j))&&(N.vote_score=parseInt(j)),e&&e.permissionId&&(N.Permission_id=e.permissionId),this.tronWeb.fullNode.request("wallet/createassetissue",N,"post").then((function(e){return Yt(e,n)})).catch((function(e){return n(e)}))}}},{key:"updateAccount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Nt.isFunction(n)&&(r=n,n={}),Nt.isFunction(t)?(r=t,t=this.tronWeb.defaultAddress.hex):Nt.isObject(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),!r)return this.injectPromise(this.updateAccount,e,t,n);if(!this.validator.notValid([{name:"Name",type:"not-empty-string",value:e},{name:"origin",type:"address",value:t}],r)){var i={account_name:$t(e),owner_address:Gt(t)};n&&n.permissionId&&(i.Permission_id=n.permissionId),this.tronWeb.fullNode.request("wallet/updateaccount",i,"post").then((function(e){return Yt(e,r)})).catch((function(e){return r(e)}))}}},{key:"setAccountId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Nt.isFunction(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),!n)return this.injectPromise(this.setAccountId,e,t);e&&Nt.isString(e)&&e.startsWith("0x")&&(e=e.slice(2)),this.validator.notValid([{name:"accountId",type:"hex",value:e},{name:"accountId",type:"string",lte:32,gte:8,value:e},{name:"origin",type:"address",value:t}],n)||this.tronWeb.fullNode.request("wallet/setaccountid",{account_id:e,owner_address:Gt(t)},"post").then((function(e){return Yt(e,n)})).catch((function(e){return n(e)}))}},{key:"updateToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Nt.isFunction(t)?(n=t,t=this.tronWeb.defaultAddress.hex):Nt.isObject(t)&&(e=t,t=this.tronWeb.defaultAddress.hex),!n)return this.injectPromise(this.updateToken,e,t);var r=e,i=r.description,a=void 0!==i&&i,s=r.url,o=void 0!==s&&s,u=r.freeBandwidth,c=void 0===u?0:u,d=r.freeBandwidthLimit,l=void 0===d?0:d;if(!this.validator.notValid([{name:"token description",type:"not-empty-string",value:a},{name:"token url",type:"url",value:o},{name:"issuer",type:"address",value:t},{name:"Free bandwidth amount",type:"positive-integer",value:c},{name:"Free bandwidth limit",type:"positive-integer",value:l}],n)){var h={owner_address:Gt(t),description:$t(a),url:$t(o),new_limit:parseInt(c),new_public_limit:parseInt(l)};e&&e.permissionId&&(h.Permission_id=e.permissionId),this.tronWeb.fullNode.request("wallet/updateasset",h,"post").then((function(e){return Yt(e,n)})).catch((function(e){return n(e)}))}}},{key:"sendAsset",value:function(){return this.sendToken.apply(this,arguments)}},{key:"purchaseAsset",value:function(){return this.purchaseToken.apply(this,arguments)}},{key:"createAsset",value:function(){return this.createToken.apply(this,arguments)}},{key:"updateAsset",value:function(){return this.updateToken.apply(this,arguments)}},{key:"createProposal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Nt.isFunction(n)&&(r=n,n={}),Nt.isFunction(t)?(r=t,t=this.tronWeb.defaultAddress.hex):Nt.isObject(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),!r)return this.injectPromise(this.createProposal,e,t,n);if(!this.validator.notValid([{name:"issuer",type:"address",value:t}],r)){var i="Invalid proposal parameters provided";if(!e)return r(i);Nt.isArray(e)||(e=[e]);var a,s=zt(e);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(!Nt.isObject(o))return r(i)}}catch(e){s.e(e)}finally{s.f()}var u={owner_address:Gt(t),parameters:e};n&&n.permissionId&&(u.Permission_id=n.permissionId),this.tronWeb.fullNode.request("wallet/proposalcreate",u,"post").then((function(e){return Yt(e,r)})).catch((function(e){return r(e)}))}}},{key:"deleteProposal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultAddress.hex,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Nt.isFunction(n)&&(r=n,n={}),Nt.isFunction(t)?(r=t,t=this.tronWeb.defaultAddress.hex):Nt.isObject(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),!r)return this.injectPromise(this.deleteProposal,e,t,n);if(!this.validator.notValid([{name:"issuer",type:"address",value:t},{name:"proposalID",type:"integer",value:e,gte:0}],r)){var i={owner_address:Gt(t),proposal_id:parseInt(e)};n&&n.permissionId&&(i.Permission_id=n.permissionId),this.tronWeb.fullNode.request("wallet/proposaldelete",i,"post").then((function(e){return Yt(e,r)})).catch((function(e){return r(e)}))}}},{key:"voteProposal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.tronWeb.defaultAddress.hex,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Nt.isFunction(r)&&(i=r,r={}),Nt.isFunction(n)?(i=n,n=this.tronWeb.defaultAddress.hex):Nt.isObject(n)&&(r=n,n=this.tronWeb.defaultAddress.hex),!i)return this.injectPromise(this.voteProposal,e,t,n,r);if(!this.validator.notValid([{name:"voter",type:"address",value:n},{name:"proposalID",type:"integer",value:e,gte:0},{name:"has approval",type:"boolean",value:t}],i)){var a={owner_address:Gt(n),proposal_id:parseInt(e),is_add_approval:t};r&&r.permissionId&&(a.Permission_id=r.permissionId),this.tronWeb.fullNode.request("wallet/proposalapprove",a,"post").then((function(e){return Yt(e,i)})).catch((function(e){return i(e)}))}}},{key:"createTRXExchange",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.tronWeb.defaultAddress.hex,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(Nt.isFunction(i)&&(a=i,i={}),Nt.isFunction(r)?(a=r,r=this.tronWeb.defaultAddress.hex):Nt.isObject(r)&&(i=r,r=this.tronWeb.defaultAddress.hex),!a)return this.injectPromise(this.createTRXExchange,e,t,n,r,i);if(!this.validator.notValid([{name:"owner",type:"address",value:r},{name:"token name",type:"not-empty-string",value:e},{name:"token balance",type:"positive-integer",value:t},{name:"trx balance",type:"positive-integer",value:n}],a)){var s={owner_address:Gt(r),first_token_id:$t(e),first_token_balance:t,second_token_id:"5f",second_token_balance:n};i&&i.permissionId&&(s.Permission_id=i.permissionId),this.tronWeb.fullNode.request("wallet/exchangecreate",s,"post").then((function(e){a(null,e)})).catch((function(e){return a(e)}))}}},{key:"createTokenExchange",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.tronWeb.defaultAddress.hex,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(Nt.isFunction(a)&&(s=a,a={}),Nt.isFunction(i)?(s=i,i=this.tronWeb.defaultAddress.hex):Nt.isObject(i)&&(a=i,i=this.tronWeb.defaultAddress.hex),!s)return this.injectPromise(this.createTokenExchange,e,t,n,r,i,a);if(!this.validator.notValid([{name:"owner",type:"address",value:i},{name:"first token name",type:"not-empty-string",value:e},{name:"second token name",type:"not-empty-string",value:n},{name:"first token balance",type:"positive-integer",value:t},{name:"second token balance",type:"positive-integer",value:r}],s)){var o={owner_address:Gt(i),first_token_id:$t(e),first_token_balance:t,second_token_id:$t(n),second_token_balance:r};a&&a.permissionId&&(o.Permission_id=a.permissionId),this.tronWeb.fullNode.request("wallet/exchangecreate",o,"post").then((function(e){s(null,e)})).catch((function(e){return s(e)}))}}},{key:"injectExchangeTokens",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.tronWeb.defaultAddress.hex,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(Nt.isFunction(i)&&(a=i,i={}),Nt.isFunction(r)?(a=r,r=this.tronWeb.defaultAddress.hex):Nt.isObject(r)&&(i=r,r=this.tronWeb.defaultAddress.hex),!a)return this.injectPromise(this.injectExchangeTokens,e,t,n,r,i);if(!this.validator.notValid([{name:"owner",type:"address",value:r},{name:"token name",type:"not-empty-string",value:t},{name:"token amount",type:"integer",value:n,gte:1},{name:"exchangeID",type:"integer",value:e,gte:0}],a)){var s={owner_address:Gt(r),exchange_id:parseInt(e),token_id:$t(t),quant:parseInt(n)};i&&i.permissionId&&(s.Permission_id=i.permissionId),this.tronWeb.fullNode.request("wallet/exchangeinject",s,"post").then((function(e){return Yt(e,a)})).catch((function(e){return a(e)}))}}},{key:"withdrawExchangeTokens",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.tronWeb.defaultAddress.hex,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(Nt.isFunction(i)&&(a=i,i={}),Nt.isFunction(r)?(a=r,r=this.tronWeb.defaultAddress.hex):Nt.isObject(r)&&(i=r,r=this.tronWeb.defaultAddress.hex),!a)return this.injectPromise(this.withdrawExchangeTokens,e,t,n,r,i);if(!this.validator.notValid([{name:"owner",type:"address",value:r},{name:"token name",type:"not-empty-string",value:t},{name:"token amount",type:"integer",value:n,gte:1},{name:"exchangeID",type:"integer",value:e,gte:0}],a)){var s={owner_address:Gt(r),exchange_id:parseInt(e),token_id:$t(t),quant:parseInt(n)};i&&i.permissionId&&(s.Permission_id=i.permissionId),this.tronWeb.fullNode.request("wallet/exchangewithdraw",s,"post").then((function(e){return Yt(e,a)})).catch((function(e){return a(e)}))}}},{key:"tradeExchangeTokens",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.tronWeb.defaultAddress.hex,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(Nt.isFunction(a)&&(s=a,a={}),Nt.isFunction(i)?(s=i,i=this.tronWeb.defaultAddress.hex):Nt.isObject(i)&&(a=i,i=this.tronWeb.defaultAddress.hex),!s)return this.injectPromise(this.tradeExchangeTokens,e,t,n,r,i,a);if(!this.validator.notValid([{name:"owner",type:"address",value:i},{name:"token name",type:"not-empty-string",value:t},{name:"tokenAmountSold",type:"integer",value:n,gte:1},{name:"tokenAmountExpected",type:"integer",value:r,gte:1},{name:"exchangeID",type:"integer",value:e,gte:0}],s)){var o={owner_address:Gt(i),exchange_id:parseInt(e),token_id:this.tronWeb.fromAscii(t),quant:parseInt(n),expected:parseInt(r)};a&&a.permissionId&&(o.Permission_id=a.permissionId),this.tronWeb.fullNode.request("wallet/exchangetransaction",o,"post").then((function(e){return Yt(e,s)})).catch((function(e){return s(e)}))}}},{key:"updateSetting",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.tronWeb.defaultAddress.hex,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Nt.isFunction(r)&&(i=r,r={}),Nt.isFunction(n)?(i=n,n=this.tronWeb.defaultAddress.hex):Nt.isObject(n)&&(r=n,n=this.tronWeb.defaultAddress.hex),!i)return this.injectPromise(this.updateSetting,e,t,n,r);if(!this.validator.notValid([{name:"owner",type:"address",value:n},{name:"contract",type:"address",value:e},{name:"userFeePercentage",type:"integer",value:t,gte:0,lte:100}],i)){var a={owner_address:Gt(n),contract_address:Gt(e),consume_user_resource_percent:t};r&&r.permissionId&&(a.Permission_id=r.permissionId),this.tronWeb.fullNode.request("wallet/updatesetting",a,"post").then((function(e){return Yt(e,i)})).catch((function(e){return i(e)}))}}},{key:"updateEnergyLimit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.tronWeb.defaultAddress.hex,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Nt.isFunction(r)&&(i=r,r={}),Nt.isFunction(n)?(i=n,n=this.tronWeb.defaultAddress.hex):Nt.isObject(n)&&(r=n,n=this.tronWeb.defaultAddress.hex),!i)return this.injectPromise(this.updateEnergyLimit,e,t,n,r);if(!this.validator.notValid([{name:"owner",type:"address",value:n},{name:"contract",type:"address",value:e},{name:"originEnergyLimit",type:"integer",value:t,gte:0,lte:1e7}],i)){var a={owner_address:Gt(n),contract_address:Gt(e),origin_energy_limit:t};r&&r.permissionId&&(a.Permission_id=r.permissionId),this.tronWeb.fullNode.request("wallet/updateenergylimit",a,"post").then((function(e){return Yt(e,i)})).catch((function(e){return i(e)}))}}},{key:"checkPermissions",value:function(e,t){if(e){if(e.type!==t||!e.permission_name||!Nt.isString(e.permission_name)||!Nt.isInteger(e.threshold)||e.threshold<1||!e.keys)return!1;var n,r=zt(e.keys);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.tronWeb.isAddress(i.address)||!Nt.isInteger(i.weight)||i.weight>e.threshold||i.weight<1||2===t&&!e.operations)return!1}}catch(e){r.e(e)}finally{r.f()}}return!0}},{key:"updateAccountPermissions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Nt.isFunction(r)&&(i=r,r=!1),Nt.isFunction(n)&&(i=n,n=r=!1),Nt.isFunction(t)&&(i=t,t=n=r=!1),!i)return this.injectPromise(this.updateAccountPermissions,e,t,n,r);if(!this.tronWeb.isAddress(e))return i("Invalid ownerAddress provided");if(!this.checkPermissions(t,0))return i("Invalid ownerPermissions provided");if(!this.checkPermissions(n,1))return i("Invalid witnessPermissions provided");Array.isArray(r)||(r=[r]);var a,s=zt(r);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(!this.checkPermissions(o,2))return i("Invalid activesPermissions provided")}}catch(e){s.e(e)}finally{s.f()}var u={owner_address:e};t&&(u.owner=t),n&&(u.witness=n),r&&(u.actives=1===r.length?r[0]:r),this.tronWeb.fullNode.request("wallet/accountpermissionupdate",u,"post").then((function(e){return Yt(e,i)})).catch((function(e){return i(e)}))}},{key:"newTxID",value:(i=f()(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",this.injectPromise(this.newTxID,t));case 2:this.tronWeb.fullNode.request("wallet/getsignweight",t,"post").then((function(e){e=e.transaction.transaction,"boolean"==typeof t.visible&&(e.visible=t.visible),n(null,e)})).catch((function(e){return n("Error generating a new transaction id.")}));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"alterTransaction",value:(r=f()(N.a.mark((function e(t){var n,r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2&&void 0!==i[2]&&i[2]){e.next=4;break}return e.abrupt("return",this.injectPromise(this.alterTransaction,t,n));case 4:if(!t.signature){e.next=6;break}return e.abrupt("return",r("You can not extend the expiration of a signed transaction."));case 6:if(!n.data){e.next=12;break}if("hex"!==n.dataFormat&&(n.data=this.tronWeb.toHex(n.data)),n.data=n.data.replace(/^0x/,""),0!==n.data.length){e.next=11;break}return e.abrupt("return",r("Invalid data provided"));case 11:t.raw_data.data=n.data;case 12:if(!n.extension){e.next=17;break}if(n.extension=parseInt(1e3*n.extension),!(isNaN(n.extension)||t.raw_data.expiration+n.extension<=Date.now()+3e3)){e.next=16;break}return e.abrupt("return",r("Invalid extension provided"));case 16:t.raw_data.expiration+=n.extension;case 17:this.newTxID(t,r);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"extendExpiration",value:(n=f()(N.a.mark((function e(t,n){var r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]&&i[2]){e.next=3;break}return e.abrupt("return",this.injectPromise(this.extendExpiration,t,n));case 3:this.alterTransaction(t,{extension:n},r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"addUpdateData",value:(t=f()(N.a.mark((function e(t,n){var r,i,a=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:"utf8",i=a.length>3&&void 0!==a[3]&&a[3],Nt.isFunction(r)&&(i=r,r="utf8"),i){e.next=5;break}return e.abrupt("return",this.injectPromise(this.addUpdateData,t,n,r));case 5:this.alterTransaction(t,{data:n,dataFormat:r},i);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function en(e){return pn.address.toHex(e)}var tn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(y()(this,e),!t||!t instanceof pn)throw new Error("Expected instance of TronWeb");this.tronWeb=t,this.injectPromise=Rt()(this),this.cache={contracts:{}},this.validator=new Mt(t)}var t,n,r,i,a,s,o,u,c,d,l,h,v,p,g,m,k;return b()(e,[{key:"_parseToken",value:function(e){return Qt(Qt({},e),{},{name:this.tronWeb.toUtf8(e.name),abbr:e.abbr&&this.tronWeb.toUtf8(e.abbr),description:e.description&&this.tronWeb.toUtf8(e.description),url:e.url&&this.tronWeb.toUtf8(e.url)})}},{key:"getCurrentBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.injectPromise(this.getCurrentBlock);this.tronWeb.fullNode.request("wallet/getnowblock").then((function(t){e(null,t)})).catch((function(t){return e(t)}))}},{key:"getConfirmedCurrentBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.injectPromise(this.getConfirmedCurrentBlock);this.tronWeb.solidityNode.request("walletsolidity/getnowblock").then((function(t){e(null,t)})).catch((function(t){return e(t)}))}},{key:"getBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultBlock,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Nt.isFunction(e)&&(t=e,e=this.tronWeb.defaultBlock),t?!1===e?t("No block identifier provided"):("earliest"==e&&(e=0),"latest"==e?this.getCurrentBlock(t):isNaN(e)&&Nt.isHex(e)?this.getBlockByHash(e,t):void this.getBlockByNumber(e,t)):this.injectPromise(this.getBlock,e)}},{key:"getBlockByHash",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.injectPromise(this.getBlockByHash,e);this.tronWeb.fullNode.request("wallet/getblockbyid",{value:e},"post").then((function(e){if(!Object.keys(e).length)return t("Block not found");t(null,e)})).catch((function(e){return t(e)}))}},{key:"getBlockByNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?!Nt.isInteger(e)||e<0?t("Invalid block number provided"):void this.tronWeb.fullNode.request("wallet/getblockbynum",{num:parseInt(e)},"post").then((function(e){if(!Object.keys(e).length)return t("Block not found");t(null,e)})).catch((function(e){return t(e)})):this.injectPromise(this.getBlockByNumber,e)}},{key:"getBlockTransactionCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultBlock,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Nt.isFunction(e)&&(t=e,e=this.tronWeb.defaultBlock),!t)return this.injectPromise(this.getBlockTransactionCount,e);this.getBlock(e).then((function(e){var n=e.transactions;t(null,(void 0===n?[]:n).length)})).catch((function(e){return t(e)}))}},{key:"getTransactionFromBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultBlock,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Nt.isFunction(t)&&(n=t,t=0),Nt.isFunction(e)&&(n=e,e=this.tronWeb.defaultBlock),!n)return this.injectPromise(this.getTransactionFromBlock,e,t);this.getBlock(e).then((function(e){var r=e.transactions,i=void 0!==r&&r;i?"number"==typeof t?t>=0&&t<i.length?n(null,i[t]):n("Invalid transaction index provided"):n(null,i):n("Transaction not found in block")})).catch((function(e){return n(e)}))}},{key:"getTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.injectPromise(this.getTransaction,e);this.tronWeb.fullNode.request("wallet/gettransactionbyid",{value:e},"post").then((function(e){if(!Object.keys(e).length)return t("Transaction not found");t(null,e)})).catch((function(e){return t(e)}))}},{key:"getConfirmedTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.injectPromise(this.getConfirmedTransaction,e);this.tronWeb.solidityNode.request("walletsolidity/gettransactionbyid",{value:e},"post").then((function(e){if(!Object.keys(e).length)return t("Transaction not found");t(null,e)})).catch((function(e){return t(e)}))}},{key:"getUnconfirmedTransactionInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._getTransactionInfoById(e,{confirmed:!1},t)}},{key:"getTransactionInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._getTransactionInfoById(e,{confirmed:!0},t)}},{key:"_getTransactionInfoById",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n)return this.injectPromise(this._getTransactionInfoById,e,t);this.tronWeb[t.confirmed?"solidityNode":"fullNode"].request("wallet".concat(t.confirmed?"solidity":"","/gettransactioninfobyid"),{value:e},"post").then((function(e){n(null,e)})).catch((function(e){return n(e)}))}},{key:"getTransactionsToAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Nt.isFunction(n)&&(r=n,n=0),Nt.isFunction(t)&&(r=t,t=30),r?(e=this.tronWeb.address.toHex(e),this.getTransactionsRelated(e,"to",t,n,r)):this.injectPromise(this.getTransactionsToAddress,e,t,n)}},{key:"getTransactionsFromAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Nt.isFunction(n)&&(r=n,n=0),Nt.isFunction(t)&&(r=t,t=30),r?(e=this.tronWeb.address.toHex(e),this.getTransactionsRelated(e,"from",t,n,r)):this.injectPromise(this.getTransactionsFromAddress,e,t,n)}},{key:"getTransactionsRelated",value:(k=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u,c,d=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:this.tronWeb.defaultAddress.hex,n=d.length>1&&void 0!==d[1]?d[1]:"all",r=d.length>2&&void 0!==d[2]?d[2]:30,i=d.length>3&&void 0!==d[3]?d[3]:0,a=d.length>4&&void 0!==d[4]&&d[4],Nt.isFunction(i)&&(a=i,i=0),Nt.isFunction(r)&&(a=r,r=30),Nt.isFunction(n)&&(a=n,n="all"),Nt.isFunction(t)&&(a=t,t=this.tronWeb.defaultAddress.hex),a){e.next=11;break}return e.abrupt("return",this.injectPromise(this.getTransactionsRelated,t,n,r,i));case 11:if(["to","from","all"].includes(n)){e.next=13;break}return e.abrupt("return",a('Invalid direction provided: Expected "to", "from" or "all"'));case 13:if("all"!=n){e.next=27;break}return e.prev=14,e.next=17,Promise.all([this.getTransactionsRelated(t,"from",r,i),this.getTransactionsRelated(t,"to",r,i)]);case 17:return s=e.sent,o=Vt()(s,2),u=o[0],c=o[1],e.abrupt("return",a(null,[].concat(q()(u.map((function(e){return e.direction="from",e}))),q()(c.map((function(e){return e.direction="to",e})))).sort((function(e,t){return t.raw_data.timestamp-e.raw_data.timestamp}))));case 24:return e.prev=24,e.t0=e.catch(14),e.abrupt("return",a(e.t0));case 27:if(this.tronWeb.isAddress(t)){e.next=29;break}return e.abrupt("return",a("Invalid address provided"));case 29:if(!(!Nt.isInteger(r)||r<0||i&&r<1)){e.next=31;break}return e.abrupt("return",a("Invalid limit provided"));case 31:if(Nt.isInteger(i)&&!(i<0)){e.next=33;break}return e.abrupt("return",a("Invalid offset provided"));case 33:t=this.tronWeb.address.toHex(t),this.tronWeb.solidityNode.request("walletextension/gettransactions".concat(n,"this"),{account:{address:t},offset:i,limit:r},"post").then((function(e){var t=e.transaction;a(null,t)})).catch((function(e){return a(e)}));case 35:case"end":return e.stop()}}),e,this,[[14,24]])}))),function(){return k.apply(this,arguments)})},{key:"getAccount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Nt.isFunction(e)&&(t=e,e=this.tronWeb.defaultAddress.hex),t?this.tronWeb.isAddress(e)?(e=this.tronWeb.address.toHex(e),void this.tronWeb.solidityNode.request("walletsolidity/getaccount",{address:e},"post").then((function(e){t(null,e)})).catch((function(e){return t(e)}))):t("Invalid address provided"):this.injectPromise(this.getAccount,e)}},{key:"getAccountById",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.injectPromise(this.getAccountById,e);this.getAccountInfoById(e,{confirmed:!0},t)}},{key:"getAccountInfoById",value:function(e,t,n){this.validator.notValid([{name:"accountId",type:"hex",value:e},{name:"accountId",type:"string",lte:32,gte:8,value:e}],n)||(e.startsWith("0x")&&(e=e.slice(2)),this.tronWeb[t.confirmed?"solidityNode":"fullNode"].request("wallet".concat(t.confirmed?"solidity":"","/getaccountbyid"),{account_id:e},"post").then((function(e){n(null,e)})).catch((function(e){return n(e)})))}},{key:"getBalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Nt.isFunction(e)&&(t=e,e=this.tronWeb.defaultAddress.hex),!t)return this.injectPromise(this.getBalance,e);this.getAccount(e).then((function(e){var n=e.balance;t(null,void 0===n?0:n)})).catch((function(e){return t(e)}))}},{key:"getUnconfirmedAccount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Nt.isFunction(e)&&(t=e,e=this.tronWeb.defaultAddress.hex),t?this.tronWeb.isAddress(e)?(e=this.tronWeb.address.toHex(e),void this.tronWeb.fullNode.request("wallet/getaccount",{address:e},"post").then((function(e){t(null,e)})).catch((function(e){return t(e)}))):t("Invalid address provided"):this.injectPromise(this.getUnconfirmedAccount,e)}},{key:"getUnconfirmedAccountById",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.injectPromise(this.getUnconfirmedAccountById,e);this.getAccountInfoById(e,{confirmed:!1},t)}},{key:"getUnconfirmedBalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Nt.isFunction(e)&&(t=e,e=this.tronWeb.defaultAddress.hex),!t)return this.injectPromise(this.getUnconfirmedBalance,e);this.getUnconfirmedAccount(e).then((function(e){var n=e.balance;t(null,void 0===n?0:n)})).catch((function(e){return t(e)}))}},{key:"getBandwidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Nt.isFunction(e)&&(t=e,e=this.tronWeb.defaultAddress.hex),t?this.tronWeb.isAddress(e)?(e=this.tronWeb.address.toHex(e),void this.tronWeb.fullNode.request("wallet/getaccountnet",{address:e},"post").then((function(e){var n=e.freeNetUsed,r=void 0===n?0:n,i=e.freeNetLimit,a=void 0===i?0:i,s=e.NetUsed,o=void 0===s?0:s,u=e.NetLimit;t(null,a-r+((void 0===u?0:u)-o))})).catch((function(e){return t(e)}))):t("Invalid address provided"):this.injectPromise(this.getBandwidth,e)}},{key:"getTokensIssuedByAddress",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Nt.isFunction(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),n?this.tronWeb.isAddress(t)?(t=this.tronWeb.address.toHex(t),void this.tronWeb.fullNode.request("wallet/getassetissuebyaccount",{address:t},"post").then((function(t){var r=t.assetIssue,i=void 0!==r&&r;if(!i)return n(null,{});var a=i.map((function(t){return e._parseToken(t)})).reduce((function(e,t){return e[t.name]=t,e}),{});n(null,a)})).catch((function(e){return n(e)}))):n("Invalid address provided"):this.injectPromise(this.getTokensIssuedByAddress,t)}},{key:"getTokenFromID",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?(Nt.isInteger(t)&&(t=t.toString()),Nt.isString(t)&&t.length?void this.tronWeb.fullNode.request("wallet/getassetissuebyname",{value:this.tronWeb.fromUtf8(t)},"post").then((function(t){if(!t.name)return n("Token does not exist");n(null,e._parseToken(t))})).catch((function(e){return n(e)})):n("Invalid token ID provided")):this.injectPromise(this.getTokenFromID,t)}},{key:"listNodes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!t)return this.injectPromise(this.listNodes);this.tronWeb.fullNode.request("wallet/listnodes").then((function(n){var r=n.nodes;t(null,(void 0===r?[]:r).map((function(t){var n=t.address,r=n.host,i=n.port;return"".concat(e.tronWeb.toUtf8(r),":").concat(i)})))})).catch((function(e){return t(e)}))}},{key:"getBlockRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Nt.isFunction(t)&&(n=t,t=30),Nt.isFunction(e)&&(n=e,e=0),n?!Nt.isInteger(e)||e<0?n("Invalid start of range provided"):!Nt.isInteger(t)||t<=e?n("Invalid end of range provided"):void this.tronWeb.fullNode.request("wallet/getblockbylimitnext",{startNum:parseInt(e),endNum:parseInt(t)+1},"post").then((function(e){var t=e.block;n(null,void 0===t?[]:t)})).catch((function(e){return n(e)})):this.injectPromise(this.getBlockRange,e,t)}},{key:"listSuperRepresentatives",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.injectPromise(this.listSuperRepresentatives);this.tronWeb.fullNode.request("wallet/listwitnesses").then((function(t){var n=t.witnesses;e(null,void 0===n?[]:n)})).catch((function(t){return e(t)}))}},{key:"listTokens",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Nt.isFunction(n)&&(r=n,n=0),Nt.isFunction(t)&&(r=t,t=0),r?!Nt.isInteger(t)||t<0||n&&t<1?r("Invalid limit provided"):!Nt.isInteger(n)||n<0?r("Invalid offset provided"):t?void this.tronWeb.fullNode.request("wallet/getpaginatedassetissuelist",{offset:parseInt(n),limit:parseInt(t)},"post").then((function(t){var n=t.assetIssue;r(null,(void 0===n?[]:n).map((function(t){return e._parseToken(t)})))})).catch((function(e){return r(e)})):this.tronWeb.fullNode.request("wallet/getassetissuelist").then((function(t){var n=t.assetIssue;r(null,(void 0===n?[]:n).map((function(t){return e._parseToken(t)})))})).catch((function(e){return r(e)})):this.injectPromise(this.listTokens,t,n)}},{key:"timeUntilNextVoteCycle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.injectPromise(this.timeUntilNextVoteCycle);this.tronWeb.fullNode.request("wallet/getnextmaintenancetime").then((function(t){var n=t.num,r=void 0===n?-1:n;if(-1==r)return e("Failed to get time until next vote cycle");e(null,Math.floor(r/1e3))})).catch((function(t){return e(t)}))}},{key:"getContract",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?this.tronWeb.isAddress(e)?void(this.cache.contracts[e]?n(null,this.cache.contracts[e]):(e=this.tronWeb.address.toHex(e),this.tronWeb.fullNode.request("wallet/getcontract",{value:e}).then((function(r){if(r.Error)return n("Contract does not exist");t.cache.contracts[e]=r,n(null,r)})).catch((function(e){return n(e)})))):n("Invalid contract address provided"):this.injectPromise(this.getContract,e)}},{key:"verifyMessage",value:(m=f()(N.a.mark((function t(){var n,r,i,a,s,o=arguments;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.length>0&&void 0!==o[0]&&o[0],r=o.length>1&&void 0!==o[1]&&o[1],i=o.length>2&&void 0!==o[2]?o[2]:this.tronWeb.defaultAddress.base58,a=!(o.length>3&&void 0!==o[3])||o[3],s=o.length>4&&void 0!==o[4]&&o[4],Nt.isFunction(i)&&(s=i,i=this.tronWeb.defaultAddress.base58,a=!0),Nt.isFunction(a)&&(s=a,a=!0),s){t.next=9;break}return t.abrupt("return",this.injectPromise(this.verifyMessage,n,r,i,a));case 9:if(Nt.isHex(n)){t.next=11;break}return t.abrupt("return",s("Expected hex message input"));case 11:if(!e.verifySignature(n,i,r,a)){t.next=13;break}return t.abrupt("return",s(null,!0));case 13:s("Signature does not match");case 14:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})},{key:"verifyMessageV2",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Nt.isFunction(r)&&(i=r,r={}),!i)return this.injectPromise(this.verifyMessageV2,t,n,r);try{var a=e.verifyMessageV2(t,n);i(null,a)}catch(e){i(e)}}},{key:"verifyTypedData",value:function(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.tronWeb.defaultAddress.base58,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return Nt.isFunction(a)&&(s=a,a=this.tronWeb.defaultAddress.base58),s?e.verifyTypedData(t,n,r,i,a)?s(null,!0):void s("Signature does not match"):this.injectPromise(this.verifyTypedData,t,n,r,i,a)}},{key:"sign",value:(g=f()(N.a.mark((function t(){var n,r,i,a,s,o,u=arguments;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=u.length>0&&void 0!==u[0]&&u[0],r=u.length>1&&void 0!==u[1]?u[1]:this.tronWeb.defaultPrivateKey,i=!(u.length>2&&void 0!==u[2])||u[2],a=u.length>3&&void 0!==u[3]&&u[3],s=u.length>4&&void 0!==u[4]&&u[4],Nt.isFunction(a)&&(s=a,a=!1),Nt.isFunction(i)&&(s=i,i=!0,a=!1),Nt.isFunction(r)&&(s=r,r=this.tronWeb.defaultPrivateKey,i=!0,a=!1),s){t.next=10;break}return t.abrupt("return",this.injectPromise(this.sign,n,r,i,a));case 10:if(!Nt.isString(n)){t.next=21;break}if(Nt.isHex(n)){t.next=13;break}return t.abrupt("return",s("Expected hex message input"));case 13:return t.prev=13,o=e.signString(n,r,i),t.abrupt("return",s(null,o));case 18:t.prev=18,t.t0=t.catch(13),s(t.t0);case 21:if(Nt.isObject(n)){t.next=23;break}return t.abrupt("return",s("Invalid transaction provided"));case 23:if(a||!n.signature){t.next=25;break}return t.abrupt("return",s("Transaction is already signed"));case 25:if(t.prev=25,a){t.next=30;break}if(this.tronWeb.address.toHex(this.tronWeb.address.fromPrivateKey(r)).toLowerCase()===this.tronWeb.address.toHex(n.raw_data.contract[0].parameter.value.owner_address)){t.next=30;break}return t.abrupt("return",s("Private key does not match address in transaction"));case 30:return t.abrupt("return",s(null,Nt.crypto.signTransaction(r,n)));case 33:t.prev=33,t.t1=t.catch(25),s(t.t1);case 36:case"end":return t.stop()}}),t,this,[[13,18],[25,33]])}))),function(){return g.apply(this,arguments)})},{key:"signMessageV2",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tronWeb.defaultPrivateKey,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Nt.isFunction(r)&&(i=r,r={}),Nt.isFunction(n)&&(i=n,n=this.tronWeb.defaultPrivateKey),!i)return this.injectPromise(this.signMessageV2,t,n);try{var a=e.signMessageV2(t,n);return i(null,a)}catch(e){i(e)}}},{key:"_signTypedData",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.tronWeb.defaultPrivateKey,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Nt.isFunction(i)&&(a=i,i=this.tronWeb.defaultPrivateKey),!a)return this.injectPromise(this._signTypedData,t,n,r,i);try{var s=e._signTypedData(t,n,r,i);return a(null,s)}catch(e){a(e)}}},{key:"multiSign",value:(p=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]&&u[0],n=u.length>1&&void 0!==u[1]?u[1]:this.tronWeb.defaultPrivateKey,r=u.length>2&&void 0!==u[2]&&u[2],i=u.length>3&&void 0!==u[3]&&u[3],Nt.isFunction(r)&&(i=r,r=0),Nt.isFunction(n)&&(i=n,n=this.tronWeb.defaultPrivateKey,r=0),i){e.next=8;break}return e.abrupt("return",this.injectPromise(this.multiSign,t,n,r));case 8:if(Nt.isObject(t)&&t.raw_data&&t.raw_data.contract){e.next=10;break}return e.abrupt("return",i("Invalid transaction provided"));case 10:if(t.raw_data.contract[0].Permission_id||!(r>0)){e.next=30;break}return t.raw_data.contract[0].Permission_id=r,a=this.tronWeb.address.toHex(this.tronWeb.address.fromPrivateKey(n)).toLowerCase(),e.next=15,this.getSignWeight(t,r);case 15:if("PERMISSION_ERROR"!==(s=e.sent).result.code){e.next=18;break}return e.abrupt("return",i(s.result.message));case 18:if(o=!1,s.permission.keys.map((function(e){e.address===a&&(o=!0)})),o){e.next=22;break}return e.abrupt("return",i(n+" has no permission to sign"));case 22:if(!s.approved_list||-1==s.approved_list.indexOf(a)){e.next=24;break}return e.abrupt("return",i(n+" already sign transaction"));case 24:if(!s.transaction||!s.transaction.transaction){e.next=29;break}t=s.transaction.transaction,r>0&&(t.raw_data.contract[0].Permission_id=r),e.next=30;break;case 29:return e.abrupt("return",i("Invalid transaction provided"));case 30:return e.prev=30,e.abrupt("return",i(null,Nt.crypto.signTransaction(n,t)));case 34:e.prev=34,e.t0=e.catch(30),i(e.t0);case 37:case"end":return e.stop()}}),e,this,[[30,34]])}))),function(){return p.apply(this,arguments)})},{key:"getApprovedList",value:(v=f()(N.a.mark((function e(t){var n,r=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1]){e.next=3;break}return e.abrupt("return",this.injectPromise(this.getApprovedList,t));case 3:if(Nt.isObject(t)){e.next=5;break}return e.abrupt("return",n("Invalid transaction provided"));case 5:this.tronWeb.fullNode.request("wallet/getapprovedlist",t,"post").then((function(e){n(null,e)})).catch((function(e){return n(e)}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"getSignWeight",value:(h=f()(N.a.mark((function e(t,n){var r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]&&i[2],Nt.isFunction(n)&&(r=n,n=void 0),r){e.next=4;break}return e.abrupt("return",this.injectPromise(this.getSignWeight,t,n));case 4:if(Nt.isObject(t)&&t.raw_data&&t.raw_data.contract){e.next=6;break}return e.abrupt("return",r("Invalid transaction provided"));case 6:if(Nt.isInteger(n)?t.raw_data.contract[0].Permission_id=parseInt(n):"number"!=typeof t.raw_data.contract[0].Permission_id&&(t.raw_data.contract[0].Permission_id=0),Nt.isObject(t)){e.next=9;break}return e.abrupt("return",r("Invalid transaction provided"));case 9:this.tronWeb.fullNode.request("wallet/getsignweight",t,"post").then((function(e){r(null,e)})).catch((function(e){return r(e)}));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"sendRawTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Nt.isFunction(t)&&(n=t,t={}),n?Nt.isObject(e)?Nt.isObject(t)?e.signature&&Nt.isArray(e.signature)?void this.tronWeb.fullNode.request("wallet/broadcasttransaction",e,"post").then((function(t){t.result&&(t.transaction=e),n(null,t)})).catch((function(e){return n(e)})):n("Transaction is not signed"):n("Invalid options provided"):n("Invalid transaction provided"):this.injectPromise(this.sendRawTransaction,e,t)}},{key:"sendHexTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Nt.isFunction(t)&&(n=t,t={}),!n)return this.injectPromise(this.sendHexTransaction,e,t);if(!Nt.isHex(e))return n("Invalid hex transaction provided");if(!Nt.isObject(t))return n("Invalid options provided");var r={transaction:e};this.tronWeb.fullNode.request("wallet/broadcasthex",r,"post").then((function(t){t.result&&(t.transaction=JSON.parse(t.transaction),t.hexTransaction=e),n(null,t)})).catch((function(e){return n(e)}))}},{key:"sendTransaction",value:(l=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]&&c[0],n=c.length>1&&void 0!==c[1]&&c[1],r=c.length>2&&void 0!==c[2]?c[2]:{},i=c.length>3&&void 0!==c[3]&&c[3],Nt.isFunction(r)&&(i=r,r={}),"string"==typeof r&&(r={privateKey:r}),i){e.next=8;break}return e.abrupt("return",this.injectPromise(this.sendTransaction,t,n,r));case 8:if(this.tronWeb.isAddress(t)){e.next=10;break}return e.abrupt("return",i("Invalid recipient provided"));case 10:if(Nt.isInteger(n)&&!(n<=0)){e.next=12;break}return e.abrupt("return",i("Invalid amount provided"));case 12:if((r=Qt({privateKey:this.tronWeb.defaultPrivateKey,address:this.tronWeb.defaultAddress.hex},r)).privateKey||r.address){e.next=15;break}return e.abrupt("return",i("Function requires either a private key or address to be set"));case 15:return e.prev=15,a=r.privateKey?this.tronWeb.address.fromPrivateKey(r.privateKey):r.address,e.next=19,this.tronWeb.transactionBuilder.sendTrx(t,n,a);case 19:return s=e.sent,e.next=22,this.sign(s,r.privateKey||void 0);case 22:return o=e.sent,e.next=25,this.sendRawTransaction(o);case 25:return u=e.sent,e.abrupt("return",i(null,u));case 29:return e.prev=29,e.t0=e.catch(15),e.abrupt("return",i(e.t0));case 32:case"end":return e.stop()}}),e,this,[[15,29]])}))),function(){return l.apply(this,arguments)})},{key:"sendToken",value:(d=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u,c,d=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]&&d[0],n=d.length>1&&void 0!==d[1]&&d[1],r=d.length>2&&void 0!==d[2]&&d[2],i=d.length>3&&void 0!==d[3]?d[3]:{},a=d.length>4&&void 0!==d[4]&&d[4],Nt.isFunction(i)&&(a=i,i={}),"string"==typeof i&&(i={privateKey:i}),a){e.next=9;break}return e.abrupt("return",this.injectPromise(this.sendToken,t,n,r,i));case 9:if(this.tronWeb.isAddress(t)){e.next=11;break}return e.abrupt("return",a("Invalid recipient provided"));case 11:if(Nt.isInteger(n)&&!(n<=0)){e.next=13;break}return e.abrupt("return",a("Invalid amount provided"));case 13:if(Nt.isInteger(r)&&(r=r.toString()),Nt.isString(r)){e.next=16;break}return e.abrupt("return",a("Invalid token ID provided"));case 16:if((i=Qt({privateKey:this.tronWeb.defaultPrivateKey,address:this.tronWeb.defaultAddress.hex},i)).privateKey||i.address){e.next=19;break}return e.abrupt("return",a("Function requires either a private key or address to be set"));case 19:return e.prev=19,s=i.privateKey?this.tronWeb.address.fromPrivateKey(i.privateKey):i.address,e.next=23,this.tronWeb.transactionBuilder.sendToken(t,n,r,s);case 23:return o=e.sent,e.next=26,this.sign(o,i.privateKey||void 0);case 26:return u=e.sent,e.next=29,this.sendRawTransaction(u);case 29:return c=e.sent,e.abrupt("return",a(null,c));case 33:return e.prev=33,e.t0=e.catch(19),e.abrupt("return",a(e.t0));case 36:case"end":return e.stop()}}),e,this,[[19,33]])}))),function(){return d.apply(this,arguments)})},{key:"freezeBalance",value:(c=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u,c,d,l=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:0,n=l.length>1&&void 0!==l[1]?l[1]:3,r=l.length>2&&void 0!==l[2]?l[2]:"BANDWIDTH",i=l.length>3&&void 0!==l[3]?l[3]:{},a=l.length>4&&void 0!==l[4]?l[4]:void 0,s=l.length>5&&void 0!==l[5]&&l[5],Nt.isFunction(a)&&(s=a,a=void 0),Nt.isFunction(n)&&(s=n,n=3),Nt.isFunction(r)&&(s=r,r="BANDWIDTH"),Nt.isFunction(i)&&(s=i,i={}),"string"==typeof i&&(i={privateKey:i}),s){e.next=13;break}return e.abrupt("return",this.injectPromise(this.freezeBalance,t,n,r,i,a));case 13:if(["BANDWIDTH","ENERGY"].includes(r)){e.next=15;break}return e.abrupt("return",s('Invalid resource provided: Expected "BANDWIDTH" or "ENERGY"'));case 15:if(Nt.isInteger(t)&&!(t<=0)){e.next=17;break}return e.abrupt("return",s("Invalid amount provided"));case 17:if(Nt.isInteger(n)&&!(n<3)){e.next=19;break}return e.abrupt("return",s("Invalid duration provided, minimum of 3 days"));case 19:if((i=Qt({privateKey:this.tronWeb.defaultPrivateKey,address:this.tronWeb.defaultAddress.hex},i)).privateKey||i.address){e.next=22;break}return e.abrupt("return",s("Function requires either a private key or address to be set"));case 22:return e.prev=22,o=i.privateKey?this.tronWeb.address.fromPrivateKey(i.privateKey):i.address,e.next=26,this.tronWeb.transactionBuilder.freezeBalance(t,n,r,o,a);case 26:return u=e.sent,e.next=29,this.sign(u,i.privateKey||void 0);case 29:return c=e.sent,e.next=32,this.sendRawTransaction(c);case 32:return d=e.sent,e.abrupt("return",s(null,d));case 36:return e.prev=36,e.t0=e.catch(22),e.abrupt("return",s(e.t0));case 39:case"end":return e.stop()}}),e,this,[[22,36]])}))),function(){return c.apply(this,arguments)})},{key:"unfreezeBalance",value:(u=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:"BANDWIDTH",n=c.length>1&&void 0!==c[1]?c[1]:{},r=c.length>2&&void 0!==c[2]?c[2]:void 0,i=c.length>3&&void 0!==c[3]&&c[3],Nt.isFunction(r)&&(i=r,r=void 0),Nt.isFunction(t)&&(i=t,t="BANDWIDTH"),Nt.isFunction(n)&&(i=n,n={}),"string"==typeof n&&(n={privateKey:n}),i){e.next=10;break}return e.abrupt("return",this.injectPromise(this.unfreezeBalance,t,n,r));case 10:if(["BANDWIDTH","ENERGY"].includes(t)){e.next=12;break}return e.abrupt("return",i('Invalid resource provided: Expected "BANDWIDTH" or "ENERGY"'));case 12:if((n=Qt({privateKey:this.tronWeb.defaultPrivateKey,address:this.tronWeb.defaultAddress.hex},n)).privateKey||n.address){e.next=15;break}return e.abrupt("return",i("Function requires either a private key or address to be set"));case 15:return e.prev=15,a=n.privateKey?this.tronWeb.address.fromPrivateKey(n.privateKey):n.address,e.next=19,this.tronWeb.transactionBuilder.unfreezeBalance(t,a,r);case 19:return s=e.sent,e.next=22,this.sign(s,n.privateKey||void 0);case 22:return o=e.sent,e.next=25,this.sendRawTransaction(o);case 25:return u=e.sent,e.abrupt("return",i(null,u));case 29:return e.prev=29,e.t0=e.catch(15),e.abrupt("return",i(e.t0));case 32:case"end":return e.stop()}}),e,this,[[15,29]])}))),function(){return u.apply(this,arguments)})},{key:"updateAccount",value:(o=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]&&u[0],n=u.length>1&&void 0!==u[1]?u[1]:{},r=u.length>2&&void 0!==u[2]&&u[2],Nt.isFunction(n)&&(r=n,n={}),"string"==typeof n&&(n={privateKey:n}),r){e.next=7;break}return e.abrupt("return",this.injectPromise(this.updateAccount,t,n));case 7:if(Nt.isString(t)&&t.length){e.next=9;break}return e.abrupt("return",r("Name must be a string"));case 9:if((n=Qt({privateKey:this.tronWeb.defaultPrivateKey,address:this.tronWeb.defaultAddress.hex},n)).privateKey||n.address){e.next=12;break}return e.abrupt("return",r("Function requires either a private key or address to be set"));case 12:return e.prev=12,i=n.privateKey?this.tronWeb.address.fromPrivateKey(n.privateKey):n.address,e.next=16,this.tronWeb.transactionBuilder.updateAccount(t,i);case 16:return a=e.sent,e.next=19,this.sign(a,n.privateKey||void 0);case 19:return s=e.sent,e.next=22,this.sendRawTransaction(s);case 22:return o=e.sent,e.abrupt("return",r(null,o));case 26:return e.prev=26,e.t0=e.catch(12),e.abrupt("return",r(e.t0));case 29:case"end":return e.stop()}}),e,this,[[12,26]])}))),function(){return o.apply(this,arguments)})},{key:"signMessage",value:function(){return this.sign.apply(this,arguments)}},{key:"sendAsset",value:function(){return this.sendToken.apply(this,arguments)}},{key:"send",value:function(){return this.sendTransaction.apply(this,arguments)}},{key:"sendTrx",value:function(){return this.sendTransaction.apply(this,arguments)}},{key:"broadcast",value:function(){return this.sendRawTransaction.apply(this,arguments)}},{key:"broadcastHex",value:function(){return this.sendHexTransaction.apply(this,arguments)}},{key:"signTransaction",value:function(){return this.sign.apply(this,arguments)}},{key:"getProposal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?!Nt.isInteger(e)||e<0?t("Invalid proposalID provided"):void this.tronWeb.fullNode.request("wallet/getproposalbyid",{id:parseInt(e)},"post").then((function(e){t(null,e)})).catch((function(e){return t(e)})):this.injectPromise(this.getProposal,e)}},{key:"listProposals",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.injectPromise(this.listProposals);this.tronWeb.fullNode.request("wallet/listproposals",{},"post").then((function(t){var n=t.proposals;e(null,void 0===n?[]:n)})).catch((function(t){return e(t)}))}},{key:"getChainParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.injectPromise(this.getChainParameters);this.tronWeb.fullNode.request("wallet/getchainparameters",{},"post").then((function(t){var n=t.chainParameter;e(null,void 0===n?[]:n)})).catch((function(t){return e(t)}))}},{key:"getAccountResources",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tronWeb.defaultAddress.hex,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?this.tronWeb.isAddress(e)?void this.tronWeb.fullNode.request("wallet/getaccountresource",{address:this.tronWeb.address.toHex(e)},"post").then((function(e){t(null,e)})).catch((function(e){return t(e)})):t("Invalid address provided"):this.injectPromise(this.getAccountResources,e)}},{key:"getExchangeByID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?!Nt.isInteger(e)||e<0?t("Invalid exchangeID provided"):void this.tronWeb.fullNode.request("wallet/getexchangebyid",{id:e},"post").then((function(e){t(null,e)})).catch((function(e){return t(e)})):this.injectPromise(this.getExchangeByID,e)}},{key:"listExchanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.injectPromise(this.listExchanges);this.tronWeb.fullNode.request("wallet/listexchanges",{},"post").then((function(t){var n=t.exchanges;e(null,void 0===n?[]:n)}),"post").catch((function(t){return e(t)}))}},{key:"listExchangesPaginated",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Nt.isFunction(t)&&(n=t,t=0),Nt.isFunction(e)&&(n=e,e=10),!n)return this.injectPromise(this.listExchangesPaginated,e,t);this.tronWeb.fullNode.request("wallet/getpaginatedexchangelist",{limit:e,offset:t},"post").then((function(e){var t=e.exchanges;n(null,void 0===t?[]:t)})).catch((function(e){return n(e)}))}},{key:"getNodeInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.injectPromise(this.getNodeInfo);this.tronWeb.fullNode.request("wallet/getnodeinfo",{},"post").then((function(t){e(null,t)}),"post").catch((function(t){return e(t)}))}},{key:"getTokenListByName",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?(Nt.isInteger(t)&&(t=t.toString()),Nt.isString(t)&&t.length?void this.tronWeb.fullNode.request("wallet/getassetissuelistbyname",{value:this.tronWeb.fromUtf8(t)},"post").then((function(t){if(Array.isArray(t.assetIssue))n(null,t.assetIssue.map((function(t){return e._parseToken(t)})));else if(!t.name)return n("Token does not exist");n(null,e._parseToken(t))})).catch((function(e){return n(e)})):n("Invalid token ID provided")):this.injectPromise(this.getTokenListByName,t)}},{key:"getTokenByID",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?(Nt.isInteger(t)&&(t=t.toString()),Nt.isString(t)&&t.length?void this.tronWeb.fullNode.request("wallet/getassetissuebyid",{value:t},"post").then((function(t){if(!t.name)return n("Token does not exist");n(null,e._parseToken(t))})).catch((function(e){return n(e)})):n("Invalid token ID provided")):this.injectPromise(this.getTokenByID,t)}},{key:"getReward",value:(s=f()(N.a.mark((function e(t){var n,r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2&&void 0!==i[2]&&i[2],n.confirmed=!0,e.abrupt("return",this._getReward(t,n,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getUnconfirmedReward",value:(a=f()(N.a.mark((function e(t){var n,r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2&&void 0!==i[2]&&i[2],n.confirmed=!1,e.abrupt("return",this._getReward(t,n,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getBrokerage",value:(i=f()(N.a.mark((function e(t){var n,r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2&&void 0!==i[2]&&i[2],n.confirmed=!0,e.abrupt("return",this._getBrokerage(t,n,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getUnconfirmedBrokerage",value:(r=f()(N.a.mark((function e(t){var n,r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2&&void 0!==i[2]&&i[2],n.confirmed=!1,e.abrupt("return",this._getBrokerage(t,n,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_getReward",value:(n=f()(N.a.mark((function e(){var t,n,r,i,a=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:this.tronWeb.defaultAddress.hex,n=a.length>1?a[1]:void 0,r=a.length>2&&void 0!==a[2]&&a[2],Nt.isFunction(n)&&(r=n,n={}),Nt.isFunction(t)?(r=t,t=this.tronWeb.defaultAddress.hex):Nt.isObject(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),r){e.next=7;break}return e.abrupt("return",this.injectPromise(this._getReward,t,n));case 7:if(!this.validator.notValid([{name:"origin",type:"address",value:t}],r)){e.next=9;break}return e.abrupt("return");case 9:i={address:en(t)},this.tronWeb[n.confirmed?"solidityNode":"fullNode"].request("wallet".concat(n.confirmed?"solidity":"","/getReward"),i,"post").then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(void 0===e.reward)return r("Not found.");r(null,e.reward)})).catch((function(e){return r(e)}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_getBrokerage",value:(t=f()(N.a.mark((function e(){var t,n,r,i,a=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:this.tronWeb.defaultAddress.hex,n=a.length>1?a[1]:void 0,r=a.length>2&&void 0!==a[2]&&a[2],Nt.isFunction(n)&&(r=n,n={}),Nt.isFunction(t)?(r=t,t=this.tronWeb.defaultAddress.hex):Nt.isObject(t)&&(n=t,t=this.tronWeb.defaultAddress.hex),r){e.next=7;break}return e.abrupt("return",this.injectPromise(this._getBrokerage,t,n));case 7:if(!this.validator.notValid([{name:"origin",type:"address",value:t}],r)){e.next=9;break}return e.abrupt("return");case 9:i={address:en(t)},this.tronWeb[n.confirmed?"solidityNode":"fullNode"].request("wallet".concat(n.confirmed?"solidity":"","/getBrokerage"),i,"post").then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(void 0===e.brokerage)return r("Not found.");r(null,e.brokerage)})).catch((function(e){return r(e)}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"verifySignature",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e=e.replace(/^0x/,""),n=n.replace(/^0x/,"");var i=[].concat(q()(ue(r?"\x19TRON Signed Message:\n32":"\x19Ethereum Signed Message:\n32")),q()(Nt.code.hexStr2byteArray(e))),a=se(i),s=de(a,{recoveryParam:"1c"==n.substring(128,130)?1:0,r:"0x"+n.substring(0,64),s:"0x"+n.substring(64,128)}),o="41"+s.substr(2),u=pn.address.fromHex(o);return u==pn.address.fromHex(t)}},{key:"verifyMessageV2",value:function(e,t){return Nt.message.verifyMessage(e,t)}},{key:"verifyTypedData",value:function(e,t,n,r,i){r=r.replace(/^0x/,"");var a=Nt._TypedDataEncoder.hash(e,t,n),s="41"+de(a,{recoveryParam:"1c"==r.substring(128,130)?1:0,r:"0x"+r.substring(0,64),s:"0x"+r.substring(64,128)}).substr(2);return pn.address.fromHex(s)==pn.address.fromHex(i)}},{key:"signString",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e=e.replace(/^0x/,"");var r={toHexString:function(){return"0x"+t},value:t},i=new le(r),a=[].concat(q()(ue(n?"\x19TRON Signed Message:\n32":"\x19Ethereum Signed Message:\n32")),q()(Nt.code.hexStr2byteArray(e))),s=se(a),o=i.signDigest(s),u=["0x",o.r.substring(2),o.s.substring(2),Number(o.v).toString(16)].join("");return u}},{key:"signMessageV2",value:function(e,t){return Nt.message.signMessage(e,t)}},{key:"_signTypedData",value:function(e,t,n,r){return Nt.crypto._signTypedData(e,t,n,r)}}]),e}();function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var an=function(e,t){return kt(e,t)},sn=function(){function e(t,n){y()(this,e),this.tronWeb=t.tronWeb,this.contract=t,this.abi=n,this.name=n.name||(n.name=n.type),this.inputs=n.inputs||[],this.outputs=n.outputs||[],this.functionSelector=function(e){if(e.stateMutability=e.stateMutability?e.stateMutability.toLowerCase():"nonpayable",e.type=e.type?e.type.toLowerCase():"","fallback"===e.type||"receive"===e.type)return"0x";var t=new Nt.ethersUtils.Interface([e]);return"event"===e.type?t.getEvent(e.name).format(Nt.ethersUtils.FormatTypes.sighash):t.getFunction(e.name).format(Nt.ethersUtils.FormatTypes.sighash)}(n),this.signature=this.tronWeb.sha3(this.functionSelector,!1).slice(0,8),this.injectPromise=Rt()(this),this.defaultOptions={feeLimit:this.tronWeb.feeLimit,callValue:0,userFeePercentage:100,shouldPollResponse:!1}}var t,n,r;return b()(e,[{key:"decodeInput",value:function(e){return an(this.inputs,"0x"+e)}},{key:"onMethod",value:function(){var e=this,t="";if(this.abi&&!/event/i.test(this.abi.type)){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t=bt(this.abi,r)}return{call:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Nt.isFunction(n)&&(r=n,n={}),n=rn(rn({},n),{},{rawParameter:t}),e._call([],[],n,r)},send:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.tronWeb.defaultPrivateKey,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Nt.isFunction(r)&&(i=r,r=e.tronWeb.defaultPrivateKey),Nt.isFunction(n)&&(i=n,n={}),n=rn(rn({},n),{},{rawParameter:t}),e._send([],[],n,r,i)},watch:function(){return e._watch.apply(e,arguments)}}}},{key:"_call",value:(r=f()(N.a.mark((function e(t,n){var r,i,a,s,o=this,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:{},i=u.length>3&&void 0!==u[3]&&u[3],Nt.isFunction(r)&&(i=r,r={}),i){e.next=5;break}return e.abrupt("return",this.injectPromise(this._call,t,n,r));case 5:if(t.length===n.length){e.next=7;break}return e.abrupt("return",i("Invalid argument count provided"));case 7:if(this.contract.address){e.next=9;break}return e.abrupt("return",i("Smart contract is missing address"));case 9:if(this.contract.deployed){e.next=11;break}return e.abrupt("return",i("Calling smart contracts requires you to load the contract first"));case 11:if(a=this.abi.stateMutability,["pure","view"].includes(a.toLowerCase())){e.next=14;break}return e.abrupt("return",i('Methods with state mutability "'.concat(a,'" must use send()')));case 14:r=rn(rn(rn({},this.defaultOptions),{},{from:this.tronWeb.defaultAddress.hex},r),{},{_isConstant:!0}),s=n.map((function(e,n){return{type:t[n],value:e}})),this.tronWeb.transactionBuilder.triggerSmartContract(this.contract.address,this.functionSelector,r,s,!!r.from&&this.tronWeb.address.toHex(r.from),(function(e,t){if(e)return i(e);if(!Nt.hasProperty(t,"constant_result"))return i("Failed to execute");try{var n=t.constant_result[0].length;if(0===n||n%64==8){var r="The call has been reverted or has thrown an error.";if(0!==n){r+=" Error message: ";for(var a="",s=t.constant_result[0].substring(8),u=0;u<n-8;u+=64)a+=o.tronWeb.toUtf8(s.substring(u,u+64));r+=a.replace(/(\u0000|\u000b|\f)+/g," ").replace(/ +/g," ").replace(/\s+$/g,"")}return i(r)}var c=an(o.abi,"0x"+t.constant_result[0]);return 1===c.length&&1===Object.keys(c).length&&(c=c[0]),i(null,c)}catch(e){return i(e)}}));case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"_send",value:(n=f()(N.a.mark((function e(t,n){var r,i,a,s,o,u,c,d,l,h,v,p=this,g=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=g.length>2&&void 0!==g[2]?g[2]:{},i=g.length>3&&void 0!==g[3]?g[3]:this.tronWeb.defaultPrivateKey,a=g.length>4&&void 0!==g[4]&&g[4],Nt.isFunction(i)&&(a=i,i=this.tronWeb.defaultPrivateKey),Nt.isFunction(r)&&(a=r,r={}),a){e.next=7;break}return e.abrupt("return",this.injectPromise(this._send,t,n,r,i));case 7:if(t.length===n.length){e.next=9;break}throw new Error("Invalid argument count provided");case 9:if(this.contract.address){e.next=11;break}return e.abrupt("return",a("Smart contract is missing address"));case 11:if(this.contract.deployed){e.next=13;break}return e.abrupt("return",a("Calling smart contracts requires you to load the contract first"));case 13:if(s=this.abi.stateMutability,!["pure","view"].includes(s.toLowerCase())){e.next=16;break}return e.abrupt("return",a('Methods with state mutability "'.concat(s,'" must use call()')));case 16:return["payable"].includes(s.toLowerCase())||(r.callValue=0),r=rn(rn({},this.defaultOptions),{},{from:this.tronWeb.defaultAddress.hex},r),o=n.map((function(e,n){return{type:t[n],value:e}})),e.prev=19,u=i?this.tronWeb.address.fromPrivateKey(i):this.tronWeb.defaultAddress.base58,e.next=23,this.tronWeb.transactionBuilder.triggerSmartContract(this.contract.address,this.functionSelector,r,o,this.tronWeb.address.toHex(u));case 23:if((c=e.sent).result&&c.result.result){e.next=26;break}return e.abrupt("return",a("Unknown error: "+JSON.stringify(c,null,2)));case 26:return e.next=28,this.tronWeb.trx.sign(c.transaction,i);case 28:if((d=e.sent).signature){e.next=33;break}if(i){e.next=32;break}return e.abrupt("return",a("Transaction was not signed properly"));case 32:return e.abrupt("return",a("Invalid private key provided"));case 33:return e.next=35,this.tronWeb.trx.sendRawTransaction(d);case 35:if(!(l=e.sent).code){e.next=40;break}return h={error:l.code,message:l.code},l.message&&(h.message=this.tronWeb.toUtf8(l.message)),e.abrupt("return",a(h));case 40:if(r.shouldPollResponse){e.next=42;break}return e.abrupt("return",a(null,d.txID));case 42:(v=function(){var e=f()(N.a.mark((function e(){var t,n,i,s=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(20!==(t=s.length>0&&void 0!==s[0]?s[0]:0)){e.next=3;break}return e.abrupt("return",a({error:"Cannot find result in solidity node",transaction:d}));case 3:return e.next=5,p.tronWeb.trx.getTransactionInfo(d.txID);case 5:if(n=e.sent,Object.keys(n).length){e.next=8;break}return e.abrupt("return",setTimeout((function(){v(t+1)}),3e3));case 8:if(!n.result||"FAILED"!==n.result){e.next=10;break}return e.abrupt("return",a({error:p.tronWeb.toUtf8(n.resMessage),transaction:d,output:n}));case 10:if(Nt.hasProperty(n,"contractResult")){e.next=12;break}return e.abrupt("return",a({error:"Failed to execute: "+JSON.stringify(n,null,2),transaction:d,output:n}));case 12:if(!r.rawResponse){e.next=14;break}return e.abrupt("return",a(null,n));case 14:if(1===(i=an(p.abi,"0x"+n.contractResult[0])).length&&1===Object.keys(i).length&&(i=i[0]),!r.keepTxID){e.next=18;break}return e.abrupt("return",a(null,[d.txID,i]));case 18:return e.abrupt("return",a(null,i));case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}())(),e.next=49;break;case 46:return e.prev=46,e.t0=e.catch(19),e.abrupt("return",a(e.t0));case 49:case"end":return e.stop()}}),e,this,[[19,46]])}))),function(e,t){return n.apply(this,arguments)})},{key:"_watch",value:(t=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u=this,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:{},n=c.length>1&&void 0!==c[1]&&c[1],Nt.isFunction(t)&&(n=t,t={}),Nt.isFunction(n)){e.next=5;break}throw new Error("Expected callback to be provided");case 5:if(this.contract.address){e.next=7;break}return e.abrupt("return",n("Smart contract is missing address"));case 7:if(this.abi.type&&/event/i.test(this.abi.type)){e.next=9;break}return e.abrupt("return",n("Invalid method type for event watching"));case 9:if(this.tronWeb.eventServer){e.next=11;break}return e.abrupt("return",n("No event server configured"));case 11:return r=!1,i=!1,a=Date.now()-1e3,s=function(){var e=f()(N.a.mark((function e(){var n,r,s,o,c,d;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={since:a,eventName:u.name,sort:"block_timestamp",blockNumber:"latest",filters:t.filters},t.size&&(n.size=t.size),t.resourceNode&&(/full/i.test(t.resourceNode)?n.onlyUnconfirmed=!0:n.onlyConfirmed=!0),e.next=6,u.tronWeb.event.getEventsByContractAddress(u.contract.address,n);case 6:return r=e.sent,s=r.sort((function(e,t){return t.block-e.block})),o=Vt()(s,1),c=o[0],d=r.filter((function(e,n){return!(t.resourceNode&&e.resourceNode&&t.resourceNode.toLowerCase()!==e.resourceNode.toLowerCase()||r.slice(0,n).some((function(t){return JSON.stringify(t)==JSON.stringify(e)}))||i&&!(e.block>i))})),c&&(i=c.block),e.abrupt("return",d);case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),o=function(){r&&clearInterval(r),r=setInterval((function(){s().then((function(e){return e.forEach((function(e){n(null,Nt.parseEvent(e,u.abi))}))})).catch((function(e){return n(e)}))}),3e3)},e.next=18,s();case 18:return o(),e.abrupt("return",{start:o,stop:function(){r&&(clearInterval(r),r=!1)}});case 20:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),on=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(y()(this,e),!t||!t instanceof pn)throw new Error("Expected instance of TronWeb");this.tronWeb=t,this.injectPromise=Rt()(this),this.address=r,this.abi=n,this.eventListener=!1,this.bytecode=!1,this.deployed=!1,this.lastBlock=!1,this.methods={},this.methodInstances={},this.props=[],this.tronWeb.isAddress(r)?this.deployed=!0:this.address=!1,this.loadAbi(n)}var t,n,r,i;return b()(e,[{key:"_getEvents",value:(i=f()(N.a.mark((function e(){var t,n,r,i,a,s,o=this,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},e.next=3,this.tronWeb.event.getEventsByContractAddress(this.address,t);case 3:return n=e.sent,r=n.sort((function(e,t){return t.block-e.block})),i=Vt()(r,1),a=i[0],s=n.filter((function(e,r){return!(t.resourceNode&&e.resourceNode&&t.resourceNode.toLowerCase()!==e.resourceNode.toLowerCase()||n.slice(0,r).some((function(t){return JSON.stringify(t)==JSON.stringify(e)}))||o.lastBlock&&!(e.block>o.lastBlock))})),a&&(this.lastBlock=a.block),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_startEventListener",value:(r=f()(N.a.mark((function e(){var t,n,r=this,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:{},n=i.length>1?i[1]:void 0,Nt.isFunction(t)&&(n=t,t={}),this.eventListener&&clearInterval(this.eventListener),this.tronWeb.eventServer){e.next=6;break}throw new Error("Event server is not configured");case 6:if(this.address){e.next=8;break}throw new Error("Contract is not configured with an address");case 8:return this.eventCallback=n,e.next=11,this._getEvents(t);case 11:this.eventListener=setInterval((function(){r._getEvents(t).then((function(e){return e.forEach((function(e){r.eventCallback&&r.eventCallback(e)}))})).catch((function(e){console.error("Failed to get event list",e)}))}),3e3);case 12:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_stopEventListener",value:function(){this.eventListener&&(clearInterval(this.eventListener),this.eventListener=!1,this.eventCallback=!1)}},{key:"hasProperty",value:function(e){return this.hasOwnProperty(e)||this.__proto__.hasOwnProperty(e)}},{key:"loadAbi",value:function(e){var t=this;this.abi=e,this.methods={},this.props.forEach((function(e){return delete t[e]})),e.forEach((function(e){if(e.type&&!/constructor/i.test(e.type)){var n=new sn(t,e),r=n.onMethod.bind(n),i=n.name,a=n.functionSelector,s=n.signature;t.methods[i]=r,t.methods[a]=r,t.methods[s]=r,t.methodInstances[i]=n,t.methodInstances[a]=n,t.methodInstances[s]=n,t.hasProperty(i)||(t[i]=r,t.props.push(i)),t.hasProperty(a)||(t[a]=r,t.props.push(a)),t.hasProperty(s)||(t[s]=r,t.props.push(s))}}))}},{key:"decodeInput",value:function(e){var t=e.substring(0,8),n=e.substring(8);if(!this.methodInstances[t])throw new Error("Contract method "+t+" not found");return{name:this.methodInstances[t].name,params:this.methodInstances[t].decodeInput(n)}}},{key:"new",value:(n=f()(N.a.mark((function e(t){var n,r,i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:this.tronWeb.defaultPrivateKey,r=u.length>2&&void 0!==u[2]&&u[2],Nt.isFunction(n)&&(r=n,n=this.tronWeb.defaultPrivateKey),r){e.next=5;break}return e.abrupt("return",this.injectPromise(this.new,t,n));case 5:return e.prev=5,i=this.tronWeb.address.fromPrivateKey(n),e.next=9,this.tronWeb.transactionBuilder.createSmartContract(t,i);case 9:return a=e.sent,e.next=12,this.tronWeb.trx.sign(a,n);case 12:return s=e.sent,e.next=15,this.tronWeb.trx.sendRawTransaction(s);case 15:if(!(o=e.sent).code){e.next=18;break}return e.abrupt("return",r({error:o.code,message:this.tronWeb.toUtf8(o.message)}));case 18:return e.next=20,Nt.sleep(3e3);case 20:return e.abrupt("return",this.at(s.contract_address,r));case 23:return e.prev=23,e.t0=e.catch(5),e.abrupt("return",r(e.t0));case 26:case"end":return e.stop()}}),e,this,[[5,23]])}))),function(e){return n.apply(this,arguments)})},{key:"at",value:(t=f()(N.a.mark((function e(t){var n,r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1]){e.next=3;break}return e.abrupt("return",this.injectPromise(this.at,t));case 3:return e.prev=3,e.next=6,this.tronWeb.trx.getContract(t);case 6:if((r=e.sent).contract_address){e.next=9;break}return e.abrupt("return",n("Unknown error: "+JSON.stringify(r,null,2)));case 9:return this.address=r.contract_address,this.bytecode=r.bytecode,this.deployed=!0,this.loadAbi(r.abi&&r.abi.entrys?r.abi.entrys:[]),e.abrupt("return",n(null,this));case 16:if(e.prev=16,e.t0=e.catch(3),!e.t0.toString().includes("does not exist")){e.next=20;break}return e.abrupt("return",n("Contract has not been deployed on the network"));case 20:return e.abrupt("return",n(e.t0));case 21:case"end":return e.stop()}}),e,this,[[3,16]])}))),function(e){return t.apply(this,arguments)})},{key:"events",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Nt.isFunction(e)&&(t=e,e={}),!Nt.isFunction(t))throw new Error("Callback function expected");var n=this;return{start:function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return r?(n._startEventListener(e,t).then((function(){r()})).catch((function(e){r(e)})),this):(n._startEventListener(e,t),this)},stop:function(){n._stopEventListener()}}}}]),e}(),un=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(y()(this,e),!t||!t instanceof pn)throw new Error("Expected instance of TronWeb");this.tronWeb=t,this.pluginNoOverride=["register"],this.disablePlugins=n.disablePlugins}return b()(e,[{key:"register",value:function(e,t){var n={requires:"0.0.0",components:{}},r={libs:[],plugged:[],skipped:[]};if(this.disablePlugins)return r.error="This instance of TronWeb has plugins disabled.",r;var i=new e(this.tronWeb);if(Nt.isFunction(i.pluginInterface)&&(n=i.pluginInterface(t)),!Dt.a.satisfies(pn.version,n.requires))throw new Error("The plugin is not compatible with this version of TronWeb");if(n.fullClass){var a=i.constructor.name,s=a.substring(0,1).toLowerCase()+a.substring(1);a!==s&&(pn[a]=e,this.tronWeb[s]=i,r.libs.push(a))}else for(var o in n.components)if(this.tronWeb.hasOwnProperty(o)){var u=n.components[o],c=this.tronWeb[o].pluginNoOverride||[];for(var d in u)"constructor"===d||this.tronWeb[o][d]&&(c.includes(d)||/^_/.test(d))?r.skipped.push(d):(this.tronWeb[o][d]=u[d].bind(this.tronWeb[o]),r.plugged.push(d))}return r}}]),e}(),cn=n(27),dn=n.n(cn),ln=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(y()(this,e),!(t&&t instanceof pn))throw new Error("Expected instance of TronWeb");this.tronWeb=t,this.injectPromise=Rt()(this)}return b()(e,[{key:"setServer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"healthcheck";if(!t)return this.tronWeb.eventServer=!1;if(Nt.isString(t)&&(t=new Ot.HttpProvider(t)),!this.tronWeb.isValidProvider(t))throw new Error("Invalid event server provided");this.tronWeb.eventServer=t,this.tronWeb.eventServer.isConnected=function(){return e.tronWeb.eventServer.request(n).then((function(){return!0})).catch((function(){return!1}))}}},{key:"getEventsByContractAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Object.assign({sinceTimestamp:0,eventName:!1,blockNumber:!1,size:20,page:1},t),i=r.sinceTimestamp,a=r.since,s=r.fromTimestamp,o=r.eventName,u=r.blockNumber,c=r.size,d=r.page,l=r.onlyConfirmed,h=r.onlyUnconfirmed,f=r.previousLastEventFingerprint,v=r.previousFingerprint,g=r.fingerprint,y=r.rawResponse,m=r.sort,b=r.filters;if(!n)return this.injectPromise(this.getEventsByContractAddress,e,t);if(s=s||i||a,!this.tronWeb.eventServer)return n("No event server configured");var k=[];if(!this.tronWeb.isAddress(e))return n("Invalid contract address provided");if(o&&!e)return n("Usage of event name filtering requires a contract address");if(void 0!==s&&!Nt.isInteger(s))return n("Invalid fromTimestamp provided");if(!Nt.isInteger(c))return n("Invalid size provided");if(c>200&&(console.warn("Defaulting to maximum accepted size: 200"),c=200),!Nt.isInteger(d))return n("Invalid page provided");if(u&&!o)return n("Usage of block number filtering requires an event name");e&&k.push(this.tronWeb.address.fromHex(e)),o&&k.push(o),u&&k.push(u);var x={size:c,page:d};return"object"===p()(b)&&Object.keys(b).length>0&&(x.filters=JSON.stringify(b)),s&&(x.fromTimestamp=x.since=s),l&&(x.only_confirmed=l),h&&!l&&(x.only_unconfirmed=h),m&&(x.sort=m),(g=g||v||f)&&(x.fingerprint=g),this.tronWeb.eventServer.request("event/contract/".concat(k.join("/"),"?").concat(dn.a.stringify(x))).then((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?Nt.isArray(e)?n(null,!0===y?e:e.map((function(e){return Nt.mapEvent(e)}))):n(e):n("Unknown error occurred")})).catch((function(e){return n(e.response&&e.response.data||e)}))}},{key:"getEventsByTransactionID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Nt.isFunction(t)&&(n=t,t={}),n?this.tronWeb.eventServer?this.tronWeb.eventServer.request("event/transaction/".concat(e)).then((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?Nt.isArray(e)?n(null,!0===t.rawResponse?e:e.map((function(e){return Nt.mapEvent(e)}))):n(e):n("Unknown error occurred")})).catch((function(e){return n(e.response&&e.response.data||e)})):n("No event server configured"):this.injectPromise(this.getEventsByTransactionID,e,t)}}]),e}();function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];y()(this,e),this.mainchain=r;var a=t.fullHost,s=t.fullNode,o=t.solidityNode,u=t.eventServer,c=t.mainGatewayAddress,d=t.sideGatewayAddress,l=t.sideChainId;this.sidechain=new n(a||s,a||o,a||u,i),this.isAddress=this.mainchain.isAddress,this.utils=this.mainchain.utils,this.setMainGatewayAddress(c),this.setSideGatewayAddress(d),this.setChainId(l),this.injectPromise=Rt()(this),this.validator=new Mt(this.sidechain);var h=this;this.sidechain.trx.sign=function(){return h.sign.apply(h,arguments)},this.sidechain.trx.multiSign=function(){return h.multiSign.apply(h,arguments)}}var t,n,r,i,a,s,o,u,c,d,l,h,v,p,g,m,k,x,w,A,I;return b()(e,[{key:"setMainGatewayAddress",value:function(e){if(!this.isAddress(e))throw new Error("Invalid main gateway address provided");this.mainGatewayAddress=e}},{key:"setSideGatewayAddress",value:function(e){if(!this.isAddress(e))throw new Error("Invalid side gateway address provided");this.sideGatewayAddress=e}},{key:"setChainId",value:function(e){if(!this.utils.isString(e)||!e)throw new Error("Invalid side chainId provided");this.chainId=e}},{key:"signTransaction",value:function(e,t){"string"==typeof e&&(e=this.utils.code.hexStr2byteArray(e));var n=this.utils.code.hexStr2byteArray(this.chainId),r=this.utils.code.hexStr2byteArray(t.txID).concat(n),i=this.sidechain.utils.ethersUtils.sha256(r),a=this.utils.crypto.ECKeySign(this.utils.code.hexStr2byteArray(i.replace(/^0x/,"")),e);return Array.isArray(t.signature)?t.signature.includes(a)||t.signature.push(a):t.signature=[a],t}},{key:"multiSign",value:(I=f()(N.a.mark((function e(){var t,n,r,i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]&&u[0],n=u.length>1&&void 0!==u[1]?u[1]:this.sidechain.defaultPrivateKey,r=u.length>2&&void 0!==u[2]&&u[2],i=u.length>3&&void 0!==u[3]&&u[3],this.utils.isFunction(r)&&(i=r,r=0),this.utils.isFunction(n)&&(i=n,n=this.mainchain.defaultPrivateKey,r=0),i){e.next=8;break}return e.abrupt("return",this.injectPromise(this.multiSign,t,n,r));case 8:if(this.utils.isObject(t)&&t.raw_data&&t.raw_data.contract){e.next=10;break}return e.abrupt("return",i("Invalid transaction provided"));case 10:if(t.raw_data.contract[0].Permission_id||!(r>0)){e.next=30;break}return t.raw_data.contract[0].Permission_id=r,a=this.sidechain.address.toHex(this.sidechain.address.fromPrivateKey(n)).toLowerCase(),e.next=15,this.sidechain.trx.getSignWeight(t,r);case 15:if("PERMISSION_ERROR"!==(s=e.sent).result.code){e.next=18;break}return e.abrupt("return",i(s.result.message));case 18:if(o=!1,s.permission.keys.map((function(e){e.address===a&&(o=!0)})),o){e.next=22;break}return e.abrupt("return",i(n+" has no permission to sign"));case 22:if(!s.approved_list||-1==s.approved_list.indexOf(a)){e.next=24;break}return e.abrupt("return",i(n+" already sign transaction"));case 24:if(!s.transaction||!s.transaction.transaction){e.next=29;break}(t=s.transaction.transaction).raw_data.contract[0].Permission_id=r,e.next=30;break;case 29:return e.abrupt("return",i("Invalid transaction provided"));case 30:return e.prev=30,e.abrupt("return",i(null,this.signTransaction(n,t)));case 34:e.prev=34,e.t0=e.catch(30),i(e.t0);case 37:case"end":return e.stop()}}),e,this,[[30,34]])}))),function(){return I.apply(this,arguments)})},{key:"sign",value:(A=f()(N.a.mark((function e(){var t,n,r,i,a,s,o=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]&&o[0],n=o.length>1&&void 0!==o[1]?o[1]:this.sidechain.defaultPrivateKey,r=!(o.length>2&&void 0!==o[2])||o[2],i=o.length>3&&void 0!==o[3]&&o[3],a=o.length>4&&void 0!==o[4]&&o[4],this.utils.isFunction(i)&&(a=i,i=!1),this.utils.isFunction(r)&&(a=r,r=!0,i=!1),this.utils.isFunction(n)&&(a=n,n=this.sidechain.defaultPrivateKey,r=!0,i=!1),a){e.next=10;break}return e.abrupt("return",this.injectPromise(this.sign,t,n,r,i));case 10:if(!this.utils.isString(t)){e.next=21;break}if(this.utils.isHex(t)){e.next=13;break}return e.abrupt("return",a("Expected hex message input"));case 13:return e.prev=13,s=this.sidechain.trx.signString(t,n,r),e.abrupt("return",a(null,s));case 18:e.prev=18,e.t0=e.catch(13),a(e.t0);case 21:if(this.utils.isObject(t)){e.next=23;break}return e.abrupt("return",a("Invalid transaction provided"));case 23:if(i||!t.signature){e.next=25;break}return e.abrupt("return",a("Transaction is already signed"));case 25:if(e.prev=25,i){e.next=30;break}if(this.sidechain.address.toHex(this.sidechain.address.fromPrivateKey(n)).toLowerCase()===this.sidechain.address.toHex(t.raw_data.contract[0].parameter.value.owner_address)){e.next=30;break}return e.abrupt("return",a("Private key does not match address in transaction"));case 30:return e.abrupt("return",a(null,this.signTransaction(n,t)));case 33:e.prev=33,e.t1=e.catch(25),a(e.t1);case 36:case"end":return e.stop()}}),e,this,[[13,18],[25,33]])}))),function(){return A.apply(this,arguments)})},{key:"depositTrx",value:(w=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>3&&void 0!==c[3]?c[3]:{},a=c.length>4&&void 0!==c[4]?c[4]:this.mainchain.defaultPrivateKey,s=c.length>5&&void 0!==c[5]&&c[5],this.utils.isFunction(a)&&(s=a,a=this.mainchain.defaultPrivateKey),this.utils.isFunction(i)&&(s=i,i={}),s){e.next=7;break}return e.abrupt("return",this.injectPromise(this.depositTrx,t,n,r,i,a));case 7:if(!this.validator.notValid([{name:"callValue",type:"integer",value:t,gte:0},{name:"depositFee",type:"integer",value:n,gte:0},{name:"feeLimit",type:"integer",value:r,gte:0}],s)){e.next=9;break}return e.abrupt("return");case 9:return i=fn({callValue:Number(t)+Number(n),feeLimit:r},i),e.prev=10,e.next=13,this.mainchain.contract().at(this.mainGatewayAddress);case 13:return o=e.sent,e.next=16,o.depositTRX().send(i,a);case 16:return u=e.sent,e.abrupt("return",s(null,u));case 20:return e.prev=20,e.t0=e.catch(10),e.abrupt("return",s(e.t0));case 23:case"end":return e.stop()}}),e,this,[[10,20]])}))),function(e,t,n){return w.apply(this,arguments)})},{key:"depositTrc10",value:(x=f()(N.a.mark((function e(t,n,r,i){var a,s,o,u,c,d=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d.length>4&&void 0!==d[4]?d[4]:{},s=d.length>5&&void 0!==d[5]?d[5]:this.mainchain.defaultPrivateKey,o=d.length>6&&void 0!==d[6]&&d[6],this.utils.isFunction(s)&&(o=s,s=this.mainchain.defaultPrivateKey),this.utils.isFunction(a)&&(o=a,a={}),o){e.next=7;break}return e.abrupt("return",this.injectPromise(this.depositTrc10,t,n,r,i,a,s));case 7:if(!this.validator.notValid([{name:"tokenValue",type:"integer",value:n,gte:0},{name:"depositFee",type:"integer",value:r,gte:0},{name:"feeLimit",type:"integer",value:i,gte:0},{name:"tokenId",type:"integer",value:t,gte:0}],o)){e.next=9;break}return e.abrupt("return");case 9:return a=fn(fn({tokenId:t,tokenValue:n,feeLimit:i},a),{},{callValue:r}),e.prev=10,e.next=13,this.mainchain.contract().at(this.mainGatewayAddress);case 13:return u=e.sent,e.next=16,u.depositTRC10(t,n).send(a,s);case 16:c=e.sent,o(null,c),e.next=23;break;case 20:return e.prev=20,e.t0=e.catch(10),e.abrupt("return",o(e.t0));case 23:case"end":return e.stop()}}),e,this,[[10,20]])}))),function(e,t,n,r){return x.apply(this,arguments)})},{key:"depositTrc",value:(k=f()(N.a.mark((function e(t,n,r,i,a){var s,o,u,c,d,l,h=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=h.length>5&&void 0!==h[5]?h[5]:{},o=h.length>6&&void 0!==h[6]?h[6]:this.mainchain.defaultPrivateKey,u=h.length>7&&void 0!==h[7]&&h[7],this.utils.isFunction(o)&&(u=o,o=this.mainchain.defaultPrivateKey),this.utils.isFunction(s)&&(u=s,s={}),u){e.next=7;break}return e.abrupt("return",this.injectPromise(this.depositTrc,t,n,r,i,a,s,o));case 7:if(!this.validator.notValid([{name:"functionSelector",type:"not-empty-string",value:t},{name:"num",type:"integer",value:n,gte:0},{name:"fee",type:"integer",value:r,gte:0},{name:"feeLimit",type:"integer",value:i,gte:0},{name:"contractAddress",type:"address",value:a}],u)){e.next=9;break}return e.abrupt("return");case 9:if(s=fn(fn({feeLimit:i},s),{},{callValue:r,tokenId:"",tokenValue:0}),e.prev=10,c=null,"approve"!==t){e.next=21;break}return e.next=15,this.mainchain.contract().at(a);case 15:return d=e.sent,e.next=18,d.approve(this.mainGatewayAddress,n).send(s,o);case 18:c=e.sent,e.next=44;break;case 21:return e.next=23,this.mainchain.contract().at(this.mainGatewayAddress);case 23:l=e.sent,e.t0=t,e.next="depositTRC20"===e.t0?27:"depositTRC721"===e.t0?31:"retryDeposit"===e.t0?35:"retryMapping"===e.t0?39:43;break;case 27:return e.next=29,l.depositTRC20(a,n).send(s,o);case 29:case 33:case 37:case 41:return c=e.sent,e.abrupt("break",44);case 31:return e.next=33,l.depositTRC721(a,n).send(s,o);case 35:return e.next=37,l.retryDeposit(n).send(s,o);case 39:return e.next=41,l.retryMapping(n).send(s,o);case 43:return e.abrupt("break",44);case 44:u(null,c),e.next=50;break;case 47:return e.prev=47,e.t1=e.catch(10),e.abrupt("return",u(e.t1));case 50:case"end":return e.stop()}}),e,this,[[10,47]])}))),function(e,t,n,r,i){return k.apply(this,arguments)})},{key:"approveTrc20",value:(m=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:{},a=u.length>4&&void 0!==u[4]?u[4]:this.mainchain.defaultPrivateKey,s=u.length>5&&void 0!==u[5]&&u[5],o="approve",e.abrupt("return",this.depositTrc(o,t,0,n,r,i,a,s));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return m.apply(this,arguments)})},{key:"approveTrc721",value:(g=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:{},a=u.length>4&&void 0!==u[4]?u[4]:this.mainchain.defaultPrivateKey,s=u.length>5&&void 0!==u[5]&&u[5],o="approve",e.abrupt("return",this.depositTrc(o,t,0,n,r,i,a,s));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"depositTrc20",value:(p=f()(N.a.mark((function e(t,n,r,i){var a,s,o,u,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>4&&void 0!==c[4]?c[4]:{},s=c.length>5&&void 0!==c[5]?c[5]:this.mainchain.defaultPrivateKey,o=c.length>6&&void 0!==c[6]&&c[6],u="depositTRC20",e.abrupt("return",this.depositTrc(u,t,n,r,i,a,s,o));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return p.apply(this,arguments)})},{key:"depositTrc721",value:(v=f()(N.a.mark((function e(t,n,r,i){var a,s,o,u,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>4&&void 0!==c[4]?c[4]:{},s=c.length>5&&void 0!==c[5]?c[5]:this.mainchain.defaultPrivateKey,o=c.length>6&&void 0!==c[6]&&c[6],u="depositTRC721",e.abrupt("return",this.depositTrc(u,t,n,r,i,a,s,o));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return v.apply(this,arguments)})},{key:"mappingTrc",value:(h=f()(N.a.mark((function e(t,n,r,i){var a,s,o,u,c,d=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d.length>4&&void 0!==d[4]?d[4]:{},s=d.length>5&&void 0!==d[5]?d[5]:this.mainchain.defaultPrivateKey,o=d.length>6?d[6]:void 0,this.utils.isFunction(s)&&(o=s,s=this.mainchain.defaultPrivateKey),this.utils.isFunction(a)&&(o=a,a={}),o){e.next=7;break}return e.abrupt("return",this.injectPromise(this.mappingTrc,t,n,r,i,a,s));case 7:if(!this.validator.notValid([{name:"trxHash",type:"not-empty-string",value:t},{name:"mappingFee",type:"integer",value:n,gte:0},{name:"feeLimit",type:"integer",value:r,gte:0}],o)){e.next=9;break}return e.abrupt("return");case 9:return t=t.startsWith("0x")?t:"0x"+t,a=fn(fn({feeLimit:r},a),{},{callValue:n}),e.prev=11,e.next=14,this.mainchain.contract().at(this.mainGatewayAddress);case 14:if(u=e.sent,c=null,"mappingTRC20"!==i){e.next=22;break}return e.next=19,u.mappingTRC20(t).send(a,s);case 19:c=e.sent,e.next=29;break;case 22:if("mappingTRC721"!==i){e.next=28;break}return e.next=25,u.mappingTRC721(t).send(a,s);case 25:c=e.sent,e.next=29;break;case 28:o(new Error("type must be trc20 or trc721"));case 29:o(null,c),e.next=35;break;case 32:return e.prev=32,e.t0=e.catch(11),e.abrupt("return",o(e.t0));case 35:case"end":return e.stop()}}),e,this,[[11,32]])}))),function(e,t,n,r){return h.apply(this,arguments)})},{key:"mappingTrc20",value:(l=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:{},a=u.length>4&&void 0!==u[4]?u[4]:this.mainchain.defaultPrivateKey,s=u.length>5&&void 0!==u[5]&&u[5],o="mappingTRC20",e.abrupt("return",this.mappingTrc(t,n,r,o,i,a,s));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"mappingTrc721",value:(d=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:{},a=u.length>4&&void 0!==u[4]?u[4]:this.mainchain.defaultPrivateKey,s=u.length>5&&void 0!==u[5]&&u[5],o="mappingTRC721",e.abrupt("return",this.mappingTrc(t,n,r,o,i,a,s));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"withdrawTrx",value:(c=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>3&&void 0!==c[3]?c[3]:{},a=c.length>4&&void 0!==c[4]?c[4]:this.mainchain.defaultPrivateKey,s=c.length>5&&void 0!==c[5]&&c[5],this.utils.isFunction(a)&&(s=a,a=this.mainchain.defaultPrivateKey),this.utils.isFunction(i)&&(s=i,i={}),s){e.next=7;break}return e.abrupt("return",this.injectPromise(this.withdrawTrx,t,n,r,i,a));case 7:if(!this.validator.notValid([{name:"callValue",type:"integer",value:t,gte:0},{name:"withdrawFee",type:"integer",value:n,gte:0},{name:"feeLimit",type:"integer",value:r,gte:0}],s)){e.next=9;break}return e.abrupt("return");case 9:return i=fn({callValue:Number(t)+Number(n),feeLimit:r},i),e.prev=10,e.next=13,this.sidechain.contract().at(this.sideGatewayAddress);case 13:return o=e.sent,e.next=16,o.withdrawTRX().send(i,a);case 16:return u=e.sent,e.abrupt("return",s(null,u));case 20:return e.prev=20,e.t0=e.catch(10),e.abrupt("return",s(e.t0));case 23:case"end":return e.stop()}}),e,this,[[10,20]])}))),function(e,t,n){return c.apply(this,arguments)})},{key:"withdrawTrc10",value:(u=f()(N.a.mark((function e(t,n,r,i){var a,s,o,u,c,d=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d.length>4&&void 0!==d[4]?d[4]:{},s=d.length>5&&void 0!==d[5]?d[5]:this.mainchain.defaultPrivateKey,o=d.length>6&&void 0!==d[6]&&d[6],this.utils.isFunction(s)&&(o=s,s=this.mainchain.defaultPrivateKey),this.utils.isFunction(a)&&(o=a,a={}),o){e.next=7;break}return e.abrupt("return",this.injectPromise(this.withdrawTrc10,t,n,r,i,a,s));case 7:if(!this.validator.notValid([{name:"tokenId",type:"integer",value:t,gte:0},{name:"tokenValue",type:"integer",value:n,gte:0},{name:"withdrawFee",type:"integer",value:r,gte:0},{name:"feeLimit",type:"integer",value:i,gte:0}],o)){e.next=9;break}return e.abrupt("return");case 9:return a=fn({tokenValue:n,tokenId:t,callValue:r,feeLimit:i},a),e.prev=10,e.next=13,this.sidechain.contract().at(this.sideGatewayAddress);case 13:return u=e.sent,e.next=16,u.withdrawTRC10(t,n).send(a,s);case 16:return c=e.sent,e.abrupt("return",o(null,c));case 20:return e.prev=20,e.t0=e.catch(10),e.abrupt("return",o(e.t0));case 23:case"end":return e.stop()}}),e,this,[[10,20]])}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"withdrawTrc",value:(o=f()(N.a.mark((function e(t,n,r,i,a){var s,o,u,c,d,l,h,v,p,g,y=this,m=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=m.length>5&&void 0!==m[5]?m[5]:{},o=m.length>6&&void 0!==m[6]?m[6]:this.mainchain.defaultPrivateKey,u=m.length>7&&void 0!==m[7]&&m[7],this.utils.isFunction(o)&&(u=o,o=this.mainchain.defaultPrivateKey),this.utils.isFunction(s)&&(u=s,s={}),u){e.next=7;break}return e.abrupt("return",this.injectPromise(this.withdrawTrc,t,n,r,i,a,s,o));case 7:if(!this.validator.notValid([{name:"functionSelector",type:"not-empty-string",value:t},{name:"numOrId",type:"integer",value:n,gte:0},{name:"withdrawFee",type:"integer",value:r,gte:0},{name:"feeLimit",type:"integer",value:i,gte:0},{name:"contractAddress",type:"address",value:a}],u)){e.next=9;break}return e.abrupt("return");case 9:return s=fn(fn({feeLimit:i},s),{},{callValue:r}),c=[{type:"uint256",value:n}],e.prev=11,d=o?this.sidechain.address.fromPrivateKey(o):this.sidechain.defaultAddress.base58,e.next=15,this.sidechain.transactionBuilder.triggerSmartContract(a,t,s,c,this.sidechain.address.toHex(d));case 15:if((l=e.sent).result&&l.result.result){e.next=18;break}return e.abrupt("return",u("Unknown error: "+JSON.stringify(l.transaction,null,2)));case 18:return e.next=20,this.sidechain.trx.sign(l.transaction,o);case 20:if((h=e.sent).signature){e.next=25;break}if(o){e.next=24;break}return e.abrupt("return",u("Transaction was not signed properly"));case 24:return e.abrupt("return",u("Invalid private key provided"));case 25:return e.next=27,this.sidechain.trx.sendRawTransaction(h);case 27:if(!(v=e.sent).code){e.next=32;break}return p={error:v.code,message:v.code},v.message&&(p.message=this.sidechain.toUtf8(v.message)),e.abrupt("return",u(p));case 32:if(s.shouldPollResponse){e.next=34;break}return e.abrupt("return",u(null,h.txID));case 34:(g=function(){var e=f()(N.a.mark((function e(){var t,n,r,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(20!=(t=i.length>0&&void 0!==i[0]?i[0]:0)){e.next=3;break}return e.abrupt("return",u({error:"Cannot find result in solidity node",transaction:h}));case 3:return e.next=5,y.sidechain.trx.getTransactionInfo(h.txID);case 5:if(n=e.sent,Object.keys(n).length){e.next=8;break}return e.abrupt("return",setTimeout((function(){g(t+1)}),3e3));case 8:if(!n.result||"FAILED"!=n.result){e.next=10;break}return e.abrupt("return",u({error:y.sidechain.toUtf8(n.resMessage),transaction:h,output:n}));case 10:if(y.utils.hasProperty(n,"contractResult")){e.next=12;break}return e.abrupt("return",u({error:"Failed to execute: "+JSON.stringify(n,null,2),transaction:h,output:n}));case 12:if(!s.rawResponse){e.next=14;break}return e.abrupt("return",u(null,n));case 14:return 1===(r=decodeOutput(y.outputs,"0x"+n.contractResult[0])).length&&(r=r[0]),e.abrupt("return",u(null,r));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}())(),e.next=41;break;case 38:return e.prev=38,e.t0=e.catch(11),e.abrupt("return",u(e.t0));case 41:case"end":return e.stop()}}),e,this,[[11,38]])}))),function(e,t,n,r,i){return o.apply(this,arguments)})},{key:"withdrawTrc20",value:(s=f()(N.a.mark((function e(t,n,r,i,a){var s,o,u,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.length>5&&void 0!==c[5]?c[5]:this.mainchain.defaultPrivateKey,o=c.length>6&&void 0!==c[6]&&c[6],u="withdrawal(uint256)",e.abrupt("return",this.withdrawTrc(u,t,n,r,i,a,s,o));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i){return s.apply(this,arguments)})},{key:"withdrawTrc721",value:(a=f()(N.a.mark((function e(t,n,r,i,a){var s,o,u,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.length>5&&void 0!==c[5]?c[5]:this.mainchain.defaultPrivateKey,o=c.length>6&&void 0!==c[6]&&c[6],u="withdrawal(uint256)",e.abrupt("return",this.withdrawTrc(u,t,n,r,i,a,s,o));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i){return a.apply(this,arguments)})},{key:"injectFund",value:(i=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u,c,d,l,h=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=h.length>3&&void 0!==h[3]?h[3]:this.mainchain.defaultPrivateKey,a=h.length>4&&void 0!==h[4]&&h[4],this.utils.isFunction(i)&&(a=i,i=this.mainchain.defaultPrivateKey),this.utils.isFunction(r)&&(a=r,r={}),a){e.next=6;break}return e.abrupt("return",this.injectPromise(this.injectFund,t,n,r,i));case 6:if(!this.validator.notValid([{name:"num",type:"integer",value:t,gte:0},{name:"feeLimit",type:"integer",value:n,gte:0}],a)){e.next=8;break}return e.abrupt("return");case 8:return e.prev=8,s=this.sidechain.address.fromPrivateKey(i),o=this.sidechain.address.toHex(s),e.next=13,this.sidechain.fullNode.request("/wallet/fundinject",{owner_address:o,amount:t},"post");case 13:return u=e.sent,e.next=16,this.sidechain.trx.sign(u,i);case 16:if((c=e.sent).signature){e.next=21;break}if(i){e.next=20;break}return e.abrupt("return",a("Transaction was not signed properly"));case 20:return e.abrupt("return",a("Invalid private key provided"));case 21:return e.next=23,this.sidechain.trx.sendRawTransaction(c);case 23:if(!(d=e.sent).code){e.next=28;break}return l={error:d.code,message:d.code},d.message&&(l.message=this.mainchain.toUtf8(d.message)),e.abrupt("return",a(l));case 28:return e.abrupt("return",a(null,c.txID));case 31:return e.prev=31,e.t0=e.catch(8),e.abrupt("return",a(e.t0));case 34:case"end":return e.stop()}}),e,this,[[8,31]])}))),function(e,t,n){return i.apply(this,arguments)})},{key:"retryWithdraw",value:(r=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:{},a=u.length>4&&void 0!==u[4]?u[4]:this.sidechain.defaultPrivateKey,s=u.length>5&&void 0!==u[5]&&u[5],o="retryWithdraw(uint256)",e.abrupt("return",this.withdrawTrc(o,t,n,r,this.sideGatewayAddress,i,a,s));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"retryDeposit",value:(n=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:{},a=u.length>4&&void 0!==u[4]?u[4]:this.mainchain.defaultPrivateKey,s=u.length>5&&void 0!==u[5]&&u[5],o="retryDeposit",e.abrupt("return",this.depositTrc(o,t,n,r,this.mainGatewayAddress,i,a,s));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"retryMapping",value:(t=f()(N.a.mark((function e(t,n,r){var i,a,s,o,u=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:{},a=u.length>4&&void 0!==u[4]?u[4]:this.mainchain.defaultPrivateKey,s=u.length>5&&void 0!==u[5]&&u[5],o="retryMapping",e.abrupt("return",this.depositTrc(o,t,n,r,this.mainGatewayAddress,i,a,s));case 5:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}();var pn=function(e){A()(s,e);var t,n,i,a=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P()(this,n)}}(s);function s(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];y()(this,s),e=a.call(this);var c=!1,d=!1;return"object"===p()(n)&&(n.fullNode||n.fullHost)?(t=n.fullNode||n.fullHost,o=r,r=n.solidityNode||n.fullHost,i=n.eventServer||n.fullHost,c=n.headers||!1,d=n.eventHeaders||c,u=n.privateKey):t=n,Nt.isString(t)&&(t=new Ot.HttpProvider(t)),Nt.isString(r)&&(r=new Ot.HttpProvider(r)),Nt.isString(i)&&(i=new Ot.HttpProvider(i)),e.event=new ln(x()(e)),e.transactionBuilder=new Xt(x()(e)),e.trx=new tn(x()(e)),e.plugin=new un(x()(e),n),e.utils=Nt,e.setFullNode(t),e.setSolidityNode(r),e.setEventServer(i),e.providers=Ot,e.BigNumber=_t.a,e.defaultBlock=!1,e.defaultPrivateKey=!1,e.defaultAddress={hex:!1,base58:!1},["sha3","toHex","toUtf8","fromUtf8","toAscii","fromAscii","toDecimal","fromDecimal","toSun","fromSun","toBigNumber","isAddress","createAccount","address","version","createRandom","fromMnemonic"].forEach((function(t){e[t]=s[t]})),"object"===p()(o)&&(o.fullNode||o.fullHost)?e.sidechain=new vn(o,s,x()(e),u):u=u||o,u&&e.setPrivateKey(u),e.fullnodeVersion="3.5.0",e.feeLimit=15e7,e.injectPromise=Rt()(x()(e)),c&&e.setFullNodeHeader(c),d&&e.setEventHeader(d),e}return b()(s,[{key:"getFullnodeVersion",value:(i=f()(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.trx.getNodeInfo();case 3:t=e.sent,this.fullnodeVersion=t.configNodeInfo.codeVersion,2===this.fullnodeVersion.split(".").length&&(this.fullnodeVersion+=".0"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.fullnodeVersion="3.5.0";case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return i.apply(this,arguments)})},{key:"setDefaultBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if([!1,"latest","earliest",0].includes(e))return this.defaultBlock=e;if(!Nt.isInteger(e)||!e)throw new Error("Invalid block ID provided");this.defaultBlock=Math.abs(e)}},{key:"setPrivateKey",value:function(e){try{this.setAddress(this.address.fromPrivateKey(e))}catch(e){throw new Error("Invalid private key provided")}this.defaultPrivateKey=e,this.emit("privateKeyChanged",e)}},{key:"setAddress",value:function(e){if(!this.isAddress(e))throw new Error("Invalid address provided");var t=this.address.toHex(e),n=this.address.fromHex(e);this.defaultPrivateKey&&this.address.fromPrivateKey(this.defaultPrivateKey)!==n&&(this.defaultPrivateKey=!1),this.defaultAddress={hex:t,base58:n},this.emit("addressChanged",{hex:t,base58:n})}},{key:"fullnodeSatisfies",value:function(e){return Dt.a.satisfies(this.fullnodeVersion,e)}},{key:"isValidProvider",value:function(e){return Object.values(Ot).some((function(t){return e instanceof t}))}},{key:"setFullNode",value:function(e){if(Nt.isString(e)&&(e=new Ot.HttpProvider(e)),!this.isValidProvider(e))throw new Error("Invalid full node provided");this.fullNode=e,this.fullNode.setStatusPage("wallet/getnowblock"),this.getFullnodeVersion()}},{key:"setSolidityNode",value:function(e){if(Nt.isString(e)&&(e=new Ot.HttpProvider(e)),!this.isValidProvider(e))throw new Error("Invalid solidity node provided");this.solidityNode=e,this.solidityNode.setStatusPage("walletsolidity/getnowblock")}},{key:"setEventServer",value:function(){var e;(e=this.event).setServer.apply(e,arguments)}},{key:"setHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Ot.HttpProvider(this.fullNode.host,3e4,!1,!1,e),n=new Ot.HttpProvider(this.solidityNode.host,3e4,!1,!1,e),r=new Ot.HttpProvider(this.eventServer.host,3e4,!1,!1,e);this.setFullNode(t),this.setSolidityNode(n),this.setEventServer(r)}},{key:"setFullNodeHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Ot.HttpProvider(this.fullNode.host,3e4,!1,!1,e),n=new Ot.HttpProvider(this.solidityNode.host,3e4,!1,!1,e);this.setFullNode(t),this.setSolidityNode(n)}},{key:"setEventHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Ot.HttpProvider(this.eventServer.host,3e4,!1,!1,e);this.setEventServer(t)}},{key:"currentProviders",value:function(){return{fullNode:this.fullNode,solidityNode:this.solidityNode,eventServer:this.eventServer}}},{key:"currentProvider",value:function(){return this.currentProviders()}},{key:"getEventResult",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"object"!==p()(n[1])&&(n[1]={sinceTimestamp:n[1]||0,eventName:n[2]||!1,blockNumber:n[3]||!1,size:n[4]||20,page:n[5]||1},n.splice(2,4),Nt.isFunction(n[2])||(Nt.isFunction(n[1].page)?(n[2]=n[1].page,n[1].page=1):Nt.isFunction(n[1].size)&&(n[2]=n[1].size,n[1].size=20,n[1].page=1))),(e=this.event).getEventsByContractAddress.apply(e,n)}},{key:"getEventByTransactionID",value:function(){var e;return(e=this.event).getEventsByTransactionID.apply(e,arguments)}},{key:"contract",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new on(this,e,t)}},{key:"isConnected",value:(n=f()(N.a.mark((function e(){var t,n=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0]){e.next=3;break}return e.abrupt("return",this.injectPromise(this.isConnected));case 3:return e.t0=t,e.next=6,this.fullNode.isConnected();case 6:return e.t1=e.sent,e.next=9,this.solidityNode.isConnected();case 9:if(e.t2=e.sent,e.t3=this.eventServer,!e.t3){e.next=15;break}return e.next=14,this.eventServer.isConnected();case 14:e.t3=e.sent;case 15:return e.t4=e.t3,e.t5={fullNode:e.t1,solidityNode:e.t2,eventServer:e.t4},e.abrupt("return",(0,e.t0)(null,e.t5));case 18:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],[{key:"address",get:function(){return{fromHex:function(e){return Nt.isHex(e)?Nt.crypto.getBase58CheckAddress(Nt.code.hexStr2byteArray(e.replace(/^0x/,"41"))):e},toHex:function(e){return Nt.isHex(e)?e.toLowerCase().replace(/^0x/,"41"):Nt.code.byteArray2hexStr(Nt.crypto.decodeBase58Address(e)).toLowerCase()},fromPrivateKey:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return Nt.crypto.pkToAddress(e,t)}catch(e){return!1}}}}},{key:"sha3",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(t?"0x":"")+se(r.from(e,"utf-8")).toString().substring(2)}},{key:"toHex",value:function(e){if(Nt.isBoolean(e))return s.fromDecimal(+e);if(Nt.isBigNumber(e))return s.fromDecimal(e);if("object"===p()(e))return s.fromUtf8(JSON.stringify(e));if(Nt.isString(e)){if(/^(-|)0x/.test(e))return e;if(!isFinite(e)||/^\s*$/.test(e))return s.fromUtf8(e)}var t=s.fromDecimal(e);if("0xNaN"===t)throw new Error("The passed value is not convertible to a hex string");return t}},{key:"toUtf8",value:function(e){if(Nt.isHex(e))return e=e.replace(/^0x/,""),r.from(e,"hex").toString("utf8");throw new Error("The passed value is not a valid hex string")}},{key:"fromUtf8",value:function(e){if(!Nt.isString(e))throw new Error("The passed value is not a valid utf-8 string");return"0x"+r.from(e,"utf8").toString("hex")}},{key:"toAscii",value:function(e){if(Nt.isHex(e)){var t="",n=0,r=e.length;for("0x"===e.substring(0,2)&&(n=2);n<r;n+=2){var i=parseInt(e.substr(n,2),16);t+=String.fromCharCode(i)}return t}throw new Error("The passed value is not a valid hex string")}},{key:"fromAscii",value:function(e,t){if(!Nt.isString(e))throw new Error("The passed value is not a valid utf-8 string");return"0x"+r.from(e,"ascii").toString("hex").padEnd(t,"0")}},{key:"toDecimal",value:function(e){return s.toBigNumber(e).toNumber()}},{key:"fromDecimal",value:function(e){var t=s.toBigNumber(e),n=t.toString(16);return t.isLessThan(0)?"-0x"+n.substr(1):"0x"+n}},{key:"fromSun",value:function(e){var t=s.toBigNumber(e).div(1e6);return Nt.isBigNumber(e)?t:t.toString(10)}},{key:"toSun",value:function(e){var t=s.toBigNumber(e).times(1e6);return Nt.isBigNumber(e)?t:t.toString(10)}},{key:"toBigNumber",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Nt.isBigNumber(e)?e:Nt.isString(e)&&/^(-|)0x/.test(e)?new _t.a(e.replace("0x",""),16):new _t.a(e.toString(10),10)}},{key:"isAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Nt.isString(e))return!1;if(42===e.length)try{return s.isAddress(Nt.crypto.getBase58CheckAddress(Nt.code.hexStr2byteArray(e)))}catch(e){return!1}try{return Nt.crypto.isAddressValid(e)}catch(e){return!1}}},{key:"createAccount",value:(t=f()(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Nt.accounts.generateAccount(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"createRandom",value:function(e){return Nt.accounts.generateRandom(e)}},{key:"fromMnemonic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m/44'/195'/0'/0/0",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",r=Nt.accounts.generateAccountWithMnemonic(e,t,n);return r}}]),s}(Ft.a);j()(pn,"providers",Ot),j()(pn,"BigNumber",_t.a),j()(pn,"TransactionBuilder",Xt),j()(pn,"Trx",tn),j()(pn,"Contract",on),j()(pn,"Plugin",un),j()(pn,"Event",ln),j()(pn,"version",Ct.a),j()(pn,"utils",Nt)}]).default}}]);
//# sourceMappingURL=7b4c598c.e08f3d0a0999d1cc.js.map