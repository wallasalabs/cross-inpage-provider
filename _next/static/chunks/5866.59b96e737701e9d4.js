"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5866],{15866:function(t,e,n){var r;n.d(e,{E9:function(){return b},$3:function(){return L},Xx:function(){return J},T:function(){return tt},Z_:function(){return et},P6:function(){return rt}});var i=n(7420);const o=BigInt(0),f=BigInt(1),s=BigInt(2),a=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),c=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:a,n:a,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),u=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),l=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),h=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),y=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),w=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),d=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class p{constructor(t,e,n,r){this.x=t,this.y=e,this.z=n,this.t=r}static fromAffine(t){if(!(t instanceof b))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(b.ZERO)?p.ZERO:new p(t.x,t.y,f,z(t.x*t.y))}static toAffineBatch(t){const e=function(t,e=c.P){const n=new Array(t.length),r=H(t.reduce(((t,r,i)=>r===o?t:(n[i]=t,z(t*r,e))),f),e);return t.reduceRight(((t,r,i)=>r===o?t:(n[i]=z(t*n[i],e),z(t*r,e))),r),n}(t.map((t=>t.z)));return t.map(((t,n)=>t.toAffine(e[n])))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){g(t);const{x:e,y:n,z:r}=this,{x:i,y:o,z:f}=t,s=z(e*f),a=z(i*r),c=z(n*f),u=z(o*r);return s===a&&c===u}negate(){return new p(z(-this.x),this.y,this.z,z(-this.t))}double(){const{x:t,y:e,z:n}=this,{a:r}=c,i=z(t*t),o=z(e*e),f=z(s*z(n*n)),a=z(r*i),u=t+e,l=z(z(u*u)-i-o),h=a+o,y=h-f,w=a-o,d=z(l*y),g=z(h*w),B=z(l*w),m=z(y*h);return new p(d,g,m,B)}add(t){g(t);const{x:e,y:n,z:r,t:i}=this,{x:f,y:a,z:c,t:u}=t,l=z((n-e)*(a+f)),h=z((n+e)*(a-f)),y=z(h-l);if(y===o)return this.double();const w=z(r*s*u),d=z(i*s*c),B=d+w,m=h+l,E=d-w,x=z(B*y),b=z(m*E),A=z(B*E),R=z(y*m);return new p(x,b,R,A)}subtract(t){return this.add(t.negate())}precomputeWindow(t){const e=1+256/t,n=[];let r=this,i=r;for(let o=0;o<e;o++){i=r,n.push(i);for(let e=1;e<2**(t-1);e++)i=i.add(r),n.push(i);r=i.double()}return n}wNAF(t,e){!e&&this.equals(p.BASE)&&(e=b.BASE);const n=e&&e._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let r=e&&x.get(e);r||(r=this.precomputeWindow(n),e&&1!==n&&(r=p.normalizeZ(r),x.set(e,r)));let i=p.ZERO,o=p.ZERO;const s=1+256/n,a=2**(n-1),c=BigInt(2**n-1),u=2**n,l=BigInt(n);for(let h=0;h<s;h++){const e=h*a;let n=Number(t&c);if(t>>=l,n>a&&(n-=u,t+=f),0===n){let t=r[e];h%2&&(t=t.negate()),o=o.add(t)}else{let t=r[e+Math.abs(n)-1];n<0&&(t=t.negate()),i=i.add(t)}}return p.normalizeZ([i,o])[0]}multiply(t,e){return this.wNAF(k(t,c.l),e)}multiplyUnsafe(t){let e=k(t,c.l,!1);const n=p.BASE,r=p.ZERO;if(e===o)return r;if(this.equals(r)||e===f)return this;if(this.equals(n))return this.wNAF(e);let i=r,s=this;for(;e>o;)e&f&&(i=i.add(s)),s=s.double(),e>>=f;return i}isSmallOrder(){return this.multiplyUnsafe(c.h).equals(p.ZERO)}isTorsionFree(){return this.multiplyUnsafe(c.l).equals(p.ZERO)}toAffine(t=H(this.z)){const{x:e,y:n,z:r}=this,i=z(e*t),o=z(n*t);if(z(r*t)!==f)throw new Error("invZ was invalid");return new b(i,o)}fromRistrettoBytes(){m()}toRistrettoBytes(){m()}fromRistrettoHash(){m()}}function g(t){if(!(t instanceof p))throw new TypeError("ExtendedPoint expected")}function B(t){if(!(t instanceof E))throw new TypeError("RistrettoPoint expected")}function m(){throw new Error("Legacy method: switch to RistrettoPoint")}p.BASE=new p(c.Gx,c.Gy,f,z(c.Gx*c.Gy)),p.ZERO=new p(o,f,f,o);class E{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){const{d:e}=c,n=z(l*t*t),r=z((n+f)*w);let i=BigInt(-1);const o=z((i-e*n)*z(n+e));let{isValid:s,value:a}=W(r,o),u=z(a*t);O(u)||(u=z(-u)),s||(a=u),s||(i=n);const y=z(i*(n-f)*d-o),g=a*a,B=z((a+a)*o),m=z(y*h),E=z(f-g),x=z(f+g);return new p(z(B*x),z(E*m),z(m*x),z(B*E))}static hashToCurve(t){const e=_((t=V(t,64)).slice(0,32)),n=this.calcElligatorRistrettoMap(e),r=_(t.slice(32,64)),i=this.calcElligatorRistrettoMap(r);return new E(n.add(i))}static fromHex(t){t=V(t,32);const{a:e,d:n}=c,r="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=_(t);if(!function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(U(i),t)||O(i))throw new Error(r);const s=z(i*i),a=z(f+e*s),u=z(f-e*s),l=z(a*a),h=z(u*u),y=z(e*n*l-h),{isValid:w,value:d}=G(z(y*h)),g=z(d*u),B=z(d*g*y);let m=z((i+i)*g);O(m)&&(m=z(-m));const x=z(a*B),b=z(m*x);if(!w||O(b)||x===o)throw new Error(r);return new E(new p(m,x,f,b))}toRawBytes(){let{x:t,y:e,z:n,t:r}=this.ep;const i=z(z(n+e)*z(n-e)),o=z(t*e),f=z(o*o),{value:s}=G(z(i*f)),a=z(s*i),c=z(s*o),u=z(a*c*r);let h;if(O(r*u)){let n=z(e*l),r=z(t*l);t=n,e=r,h=z(a*y)}else h=c;O(t*u)&&(e=z(-e));let w=z((n-e)*h);return O(w)&&(w=z(-w)),U(w)}toHex(){return S(this.toRawBytes())}toString(){return this.toHex()}equals(t){B(t);const e=this.ep,n=t.ep,r=z(e.x*n.y)===z(e.y*n.x),i=z(e.y*n.y)===z(e.x*n.x);return r||i}add(t){return B(t),new E(this.ep.add(t.ep))}subtract(t){return B(t),new E(this.ep.subtract(t.ep))}multiply(t){return new E(this.ep.multiply(t))}multiplyUnsafe(t){return new E(this.ep.multiplyUnsafe(t))}}E.BASE=new E(p.BASE),E.ZERO=new E(p.ZERO);const x=new WeakMap;class b{constructor(t,e){this.x=t,this.y=e}_setWindowSize(t){this._WINDOW_SIZE=t,x.delete(this)}static fromHex(t,e=!0){const{d:n,P:r}=c,i=(t=V(t,32)).slice();i[31]=-129&t[31];const o=T(i);if(e&&o>=r)throw new Error("Expected 0 < hex < P");if(!e&&o>=u)throw new Error("Expected 0 < hex < 2**256");const s=z(o*o),a=z(s-f),l=z(n*s+f);let{isValid:h,value:y}=W(a,l);if(!h)throw new Error("Point.fromHex: invalid y coordinate");const w=(y&f)===f;return 0!==(128&t[31])!==w&&(y=z(-y)),new b(y,o)}static async fromPrivateKey(t){return(await D(t)).point}toRawBytes(){const t=U(this.y);return t[31]|=this.x&f?128:0,t}toHex(){return S(this.toRawBytes())}toX25519(){const{y:t}=this;return U(z((f+t)*H(f-t)))}isTorsionFree(){return p.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new b(z(-this.x),this.y)}add(t){return p.fromAffine(this).add(p.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return p.fromAffine(this).multiply(t,this).toAffine()}}b.BASE=new b(c.Gx,c.Gy),b.ZERO=new b(o,f);class A{constructor(t,e){this.r=t,this.s=e,this.assertValidity()}static fromHex(t){const e=V(t,64),n=b.fromHex(e.slice(0,32),!1),r=T(e.slice(32,64));return new A(n,r)}assertValidity(){const{r:t,s:e}=this;if(!(t instanceof b))throw new Error("Expected Point instance");return k(e,c.l,!1),this}toRawBytes(){const t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(U(this.s),32),t}toHex(){return S(this.toRawBytes())}}function R(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);for(let r=0,i=0;r<t.length;r++){const e=t[r];n.set(e,i),i+=e.length}return n}const I=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function S(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=I[t[n]];return e}function v(t){if("string"!==typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const r=2*n,i=t.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[n]=o}return e}function P(t){return v(t.toString(16).padStart(64,"0"))}function U(t){return P(t).reverse()}function O(t){return(z(t)&f)===f}function T(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+S(Uint8Array.from(t).reverse()))}const Z=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function _(t){return z(T(t)&Z)}function z(t,e=c.P){const n=t%e;return n>=o?n:e+n}function H(t,e=c.P){if(t===o||e<=o)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=z(t,e),r=e,i=o,s=f,a=f,u=o;for(;n!==o;){const t=r/n,e=r%n,o=i-a*t,f=s-u*t;r=n,n=e,i=a,s=u,a=o,u=f}if(r!==f)throw new Error("invert: does not exist");return z(i,e)}function N(t,e){const{P:n}=c;let r=t;for(;e-- >o;)r*=r,r%=n;return r}function q(t){const{P:e}=c,n=BigInt(5),r=BigInt(10),i=BigInt(20),o=BigInt(40),a=BigInt(80),u=t*t%e*t%e,l=N(u,s)*u%e,h=N(l,f)*t%e,y=N(h,n)*h%e,w=N(y,r)*y%e,d=N(w,i)*w%e,p=N(d,o)*d%e,g=N(p,a)*p%e,B=N(g,a)*p%e,m=N(B,r)*y%e;return{pow_p_5_8:N(m,s)*t%e,b2:u}}function W(t,e){const n=z(e*e*e),r=z(n*n*e);let i=z(t*n*q(t*r).pow_p_5_8);const o=z(e*i*i),f=i,s=z(i*l),a=o===t,c=o===z(-t),u=o===z(-t*l);return a&&(i=f),(c||u)&&(i=s),O(i)&&(i=z(-i)),{isValid:a||c,value:i}}function G(t){return W(f,t)}function F(t){return z(T(t),c.l)}function V(t,e){const n=t instanceof Uint8Array?Uint8Array.from(t):v(t);if("number"===typeof e&&n.length!==e)throw new Error(`Expected ${e} bytes`);return n}function k(t,e,n=!0){if(!e)throw new TypeError("Specify max value");if("number"===typeof t&&Number.isSafeInteger(t)&&(t=BigInt(t)),"bigint"===typeof t&&t<e)if(n){if(o<t)return t}else if(o<=t)return t;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function K(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function M(t){if(32!==(t="bigint"===typeof t||"number"===typeof t?P(k(t,u)):V(t)).length)throw new Error("Expected 32 bytes");return t}function $(t){const e=K(t.slice(0,32)),n=t.slice(32,64),r=F(e),i=b.BASE.multiply(r),o=i.toRawBytes();return{head:e,prefix:n,scalar:r,point:i,pointBytes:o}}let j;function C(...t){if("function"!==typeof j)throw new Error("utils.sha512Sync must be set to use sync methods");return j(...t)}async function D(t){return $(await rt.sha512(M(t)))}function X(t){return $(C(M(t)))}async function L(t){return(await D(t)).pointBytes}async function J(t,e){t=V(t);const{prefix:n,scalar:r,pointBytes:i}=await D(e),o=F(await rt.sha512(n,t)),f=b.BASE.multiply(o),s=z(o+F(await rt.sha512(f.toRawBytes(),i,t))*r,c.l);return new A(f,s).toRawBytes()}function Q(t,e,n){e=V(e),n instanceof b||(n=b.fromHex(n,!1));const{r:r,s:i}=t instanceof A?t.assertValidity():A.fromHex(t);return{r:r,s:i,SB:p.BASE.multiplyUnsafe(i),pub:n,msg:e}}function Y(t,e,n,r){const i=F(r),o=p.fromAffine(t).multiplyUnsafe(i);return p.fromAffine(e).add(o).subtract(n).multiplyUnsafe(c.h).equals(p.ZERO)}async function tt(t,e,n){const{r:r,SB:i,msg:o,pub:f}=Q(t,e,n),s=await rt.sha512(r.toRawBytes(),f.toRawBytes(),o);return Y(f,r,i,s)}const et={getExtendedPublicKey:X,getPublicKey:function(t){return X(t).pointBytes},sign:function(t,e){t=V(t);const{prefix:n,scalar:r,pointBytes:i}=X(e),o=F(C(n,t)),f=b.BASE.multiply(o),s=z(o+F(C(f.toRawBytes(),i,t))*r,c.l);return new A(f,s).toRawBytes()},verify:function(t,e,n){const{r:r,SB:i,msg:o,pub:f}=Q(t,e,n),s=C(r.toRawBytes(),f.toRawBytes(),o);return Y(f,r,i,s)}};b.BASE._setWindowSize(8);const nt={node:r||(r=n.t(i,2)),web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},rt={bytesToHex:S,hexToBytes:v,concatBytes:R,getExtendedPublicKey:D,mod:z,invert:H,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if((t=V(t)).length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return z(T(t),c.l-f)+f},randomBytes:(t=32)=>{if(nt.web)return nt.web.getRandomValues(new Uint8Array(t));if(nt.node){const{randomBytes:e}=nt.node;return new Uint8Array(e(t).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>rt.randomBytes(32),sha512:async(...t)=>{const e=R(...t);if(nt.web){const t=await nt.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}if(nt.node)return Uint8Array.from(nt.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")},precompute(t=8,e=b.BASE){const n=e.equals(b.BASE)?e:new b(e.x,e.y);return n._setWindowSize(t),n.multiply(s),n},sha512Sync:void 0};Object.defineProperties(rt,{sha512Sync:{configurable:!1,get:()=>j,set(t){j||(j=t)}}})}}]);
//# sourceMappingURL=5866.59b96e737701e9d4.js.map