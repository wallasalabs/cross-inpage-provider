"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7693],{17693:function(n,t,e){e.r(t),e.d(t,{default:function(){return d}});var r=e(86854),o=e(64687),i=e.n(o),a=e(67294),s=e(63596),c=e(69135),u=e(89945);function d(){var n=function(){var n=(0,a.useState)(),t=(0,r.Z)(n,2),e=t[0],o=t[1];return(0,a.useEffect)((function(){var n=window.aptos||new s.Of({});o(n)}),[]),e}(),t=(0,a.useState)(""),e=(0,r.Z)(t,2),o=e[0],d=e[1],l=(0,a.useState)(!1),h=(0,r.Z)(l,2),g=h[0],p=h[1],m=(0,a.useState)(null),v=(0,r.Z)(m,2),f=v[0],_=v[1];if((0,a.useEffect)((function(){if(n)return n.on("connect",(function(n){p(!0),_(n),console.log("aptos.on [connect] "+n)})),n.on("disconnect",(function(){_(null),p(!1),console.log("aptos.on [disconnect] \ud83d\udc4b")})),n.on("networkChange",(function(n){d(n),console.log("aptos.on [networkChange] "+n)})),n.on("accountChanged",(function(n){_(n),p(!!n),console.log("aptos.on [accountChange] "+n)})),n.onNetworkChange((function(n){d(n),console.log("aptos [onNetworkChange] "+n)})),n.onAccountChange((function(t){_(t),t?(p(!0),console.log("aptos [onAccountChange] Switched account to "+t)):(console.log("aptos [onAccountChange] Switched unknown account"),n.connect().then((function(){return console.log("[accountChanged] Reconnected successfully")})).catch((function(n){console.log("[accountChanged] Failed to re-connect: "+n.message)})))})),function(){n.disconnect()}}),[n]),!n)return a.createElement("h2",null,"Could not find a provider");return a.createElement("div",null,a.createElement(c.p,{dapps:u.F}),!n&&a.createElement("a",{target:"_blank",href:"https://www.onekey.so/download/"},"Install OneKey Extension \u2192"),a.createElement("main",null,n&&g?a.createElement(a.Fragment,null,a.createElement("div",null,a.createElement("pre",null,"Network: ",o),a.createElement("pre",null,"Connected as: ",f)),a.createElement("button",{onClick:function(){var t;return i().async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().awrap(n.signAndSubmitTransaction({arguments:[f,"100000"],function:"0x1::coin::transfer",type:"entry_function_payload",type_arguments:["0x1::aptos_coin::AptosCoin"]}));case 2:t=e.sent,console.log("[signTransaction]",t);case 4:case"end":return e.stop()}}),null,null,null,Promise)}},"Sign&Send Transaction"),a.createElement("button",{onClick:function(){var t;return i().async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().awrap(n.signTransaction({arguments:[f,"100000"],function:"0x1::coin::transfer",type:"entry_function_payload",type_arguments:["0x1::aptos_coin::AptosCoin"]}));case 2:t=e.sent,console.log("[signTransaction]",t);case 4:case"end":return e.stop()}}),null,null,null,Promise)}},"Sign Transaction "),a.createElement("button",{onClick:function(){var t;return i().async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().awrap(n.signMessage({address:!1,application:!0,chainId:!0,message:"This is a sample message",nonce:12345}));case 2:t=e.sent,console.log("[signMessage]",t);case 4:case"end":return e.stop()}}),null,null,null,Promise)}},"Sign Message"),a.createElement("button",{onClick:function(){return i().async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i().awrap(n.disconnect());case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),console.warn(t.t0),console.log("[error] disconnect: "+JSON.stringify(t.t0));case 9:case"end":return t.stop()}}),null,null,[[0,5]],Promise)}},"Disconnect")):a.createElement(a.Fragment,null,a.createElement("button",{onClick:function(){return function(){var t,e;return i().async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,i().awrap(n.connect());case 3:return t=r.sent,r.next=6,i().awrap(n.network());case 6:e=r.sent,_(t.address),d(e),p(!0),console.log("[connectWallet] account",t,e),r.next=17;break;case 13:r.prev=13,r.t0=r.catch(0),console.warn(r.t0),console.log("[error] connect: "+JSON.stringify(r.t0));case 17:case"end":return r.stop()}}),null,null,[[0,13]],Promise)}()}},"Connect Wallet"))))}},89945:function(n,t,e){e.d(t,{F:function(){return r}});var r=[{name:"SEAM",url:"https://app.seam.money/"},{name:"Aptos Names",url:"https://www.aptosnames.com/"},{name:"Liquid Swap",url:"https://liquidswap.com/#/"}]},69135:function(n,t,e){e.d(t,{p:function(){return a}});var r=e(67294),o=e(214),i=e.n(o);function a(n){var t=n.dapps;return r.createElement("div",{className:i().container},r.createElement("h3",null,"Top DApps"),r.createElement("ul",null,t.map((function(n){return r.createElement("li",{key:n.name},r.createElement("a",{href:n.url,target:"_blank"},n.name," \u2197"))}))))}},22519:function(n,t,e){e.d(t,{R:function(){return a}});var r=e(12637);const{JS_BRIDGE_MESSAGE_DIRECTION:o,JS_BRIDGE_MESSAGE_EXT_CHANNEL:i}=r.vH;function a(n={}){return(0,r.Pk)((()=>new c(Object.assign(Object.assign({},n),{receiveHandler:r.gZ}))))}let s=!1;class c extends r.ZN{constructor(n){super(n),this.sendAsString=!1,this.isInjected=!0,function(n={}){const t=n.debugLogger||r.go;s||(s=!0,window.addEventListener("message",(e=>{var r,a;if(e.source!==window)return;const s=e.data;if(s.channel===i&&s.direction===o.HOST_TO_INPAGE){t.extInjected("onWindowPostMessage",s);const e=s.payload,o=null!==(r=n.bridge)&&void 0!==r?r:null===(a=null===window||void 0===window?void 0:window.$onekey)||void 0===a?void 0:a.jsBridge;o&&o.receive(e)}}),!1))}({debugLogger:this.debugLogger,bridge:this})}sendPayload(n){window.postMessage({channel:i,direction:o.INPAGE_TO_HOST,payload:n})}}},63596:function(n,t,e){e.d(t,{Of:function(){return p},GR:function(){return f}});var r=e(22519),o=e(10366),i=e(12637);class a extends i.BX{constructor(n){super(n),this.providerName=o.U.aptos}request(n){return this.bridgeRequest(n)}}var s=e(14859),c=e(48764).Buffer,u=function(n,t,e,r){return new(e||(e=Promise))((function(o,i){function a(n){try{c(r.next(n))}catch(t){i(t)}}function s(n){try{c(r.throw(n))}catch(t){i(t)}}function c(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,s)}c((r=r.apply(n,t||[])).next())}))};const d="accountChanged",l="networkChange",h="message_low_level";function g({method:n,name:t}){return n===`wallet_events_${t}`}class p extends a{constructor(n){super(Object.assign(Object.assign({},n),{bridge:n.bridge||(0,r.R)({timeout:n.timeout})})),this._account=null,this.aptosProviderType="petra",this._registerEvents()}get publicKey(){var n,t;return null!==(t=null===(n=this._account)||void 0===n?void 0:n.publicKey)&&void 0!==t?t:null}_registerEvents(){window.addEventListener("onekey_bridge_disconnect",(()=>{this._handleDisconnected()})),this.on(h,(n=>{const{method:t,params:e}=n;g({method:t,name:d})&&this._handleAccountChange(e),g({method:t,name:l})&&this._handleNetworkChange(e)}))}_callBridge(n){return n.aptosProviderType=this.aptosProviderType,this.bridgeRequest(n)}_handleConnected(n,t={emit:!0}){var e;if(this._account=n,t.emit&&this.isConnectionStatusChanged("connected")){this.connectionStatus="connected";const t=null!==(e=null===n||void 0===n?void 0:n.address)&&void 0!==e?e:null;this.emit("connect",t),this.emit("accountChanged",t)}}_handleDisconnected(n={emit:!0}){this._account=null,n.emit&&this.isConnectionStatusChanged("disconnected")&&(this.connectionStatus="disconnected",this.emit("disconnect"),this.emit("accountChanged",null))}isAccountsChanged(n){var t;return(null===n||void 0===n?void 0:n.address)!==(null===(t=this._account)||void 0===t?void 0:t.address)}_handleAccountChange(n){const t=n;this.isAccountsChanged(t)&&this.emit("accountChanged",(null===t||void 0===t?void 0:t.address)||null),t?this._handleConnected(t,{emit:!1}):this._handleDisconnected()}isNetworkChanged(n){return void 0===this._network||n!==this._network}_handleNetworkChange(n){const t=n;this.isNetworkChanged(t)&&this.emit("networkChange",t||null),this._network=t}connect(){return u(this,void 0,void 0,(function*(){if(this._account)return Promise.resolve(this._account);const n=yield this._callBridge({method:"connect",params:void 0});if(!n)throw s.b$.provider.unauthorized();return this._handleConnected(n,{emit:!0}),n}))}isConnected(){return null!==this._account}account(){return u(this,void 0,void 0,(function*(){const n=yield this._callBridge({method:"account",params:void 0});if(!n)throw s.b$.provider.unauthorized();return Promise.resolve(n)}))}signAndSubmitTransaction(n){return u(this,void 0,void 0,(function*(){const t=yield this._callBridge({method:"signAndSubmitTransaction",params:n});if(!t)throw s.b$.provider.unauthorized();return JSON.parse(t)}))}signTransaction(n){return u(this,void 0,void 0,(function*(){const t=yield this._callBridge({method:"signTransaction",params:n});if(!t)throw s.b$.provider.unauthorized();return new Uint8Array(c.from(t,"hex"))}))}signMessage(n){return this._callBridge({method:"signMessage",params:n})}network(){return this._callBridge({method:"network",params:void 0})}getNetworkURL(){return this._callBridge({method:"getNetworkURL",params:void 0})}disconnect(){return u(this,void 0,void 0,(function*(){yield this._callBridge({method:"disconnect",params:void 0}),this._handleDisconnected()}))}onNetworkChange(n){return super.on(l,n)}onAccountChange(n){return super.on(d,n)}on(n,t){return super.on(n,t)}emit(n,...t){return super.emit(n,...t)}}var m=e(48764).Buffer,v=function(n,t,e,r){return new(e||(e=Promise))((function(o,i){function a(n){try{c(r.next(n))}catch(t){i(t)}}function s(n){try{c(r.throw(n))}catch(t){i(t)}}function c(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,s)}c((r=r.apply(n,t||[])).next())}))};class f extends p{constructor(n){super(Object.assign(Object.assign({},n),{bridge:n.bridge||(0,r.R)({timeout:n.timeout})})),this.isMartian=!0,window.dispatchEvent(new Event("martian#initialized"))}get publicKey(){var n,t;return null!==(t=null===(n=this._account)||void 0===n?void 0:n.publicKey)&&void 0!==t?t:null}_callMartianBridge(n){return n.aptosProviderType=this.aptosProviderType,this.bridgeRequest(n)}signAndSubmitTransaction(n){return v(this,void 0,void 0,(function*(){if("string"===typeof n)return yield this._callMartianBridge({method:"martianSignAndSubmitTransaction",params:n});{const t=yield this._callMartianBridge({method:"signAndSubmitTransaction",params:n});if(!t)throw s.b$.provider.unauthorized();return JSON.parse(t)}}))}signTransaction(n){return v(this,void 0,void 0,(function*(){if("string"===typeof n)return this._callMartianBridge({method:"martianSignTransaction",params:n});{const t=yield this._callMartianBridge({method:"signTransaction",params:n});if(!t)throw s.b$.provider.unauthorized();return new Uint8Array(m.from(t,"hex"))}}))}signGenericTransaction(n){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"signGenericTransaction",params:{func:n.func,args:n.args,type_args:n.type_args}})}))}generateSignAndSubmitTransaction(n,t,e){return v(this,void 0,void 0,(function*(){const r=yield this.generateTransaction(n,t,e);return yield this.signAndSubmitTransaction(r)}))}createCollection(n,t,e){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"createCollection",params:{name:n,description:t,uri:e}})}))}createToken(n,t,e,r,o,i,a,s,c,u,d,l){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"createToken",params:{collectionName:n,name:t,description:e,supply:r,uri:o,max:i,royalty_payee_address:a,royalty_points_denominator:s,royalty_points_numerator:c,property_keys:u,property_values:d,property_types:l}})}))}generateTransaction(n,t,e){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"generateTransaction",params:{sender:n,payload:t,options:e}})}))}_convertStringToUint8Array(n){return new Uint8Array(n.split(",").map((n=>parseInt(n,10))))}_convertMaybeHexStringTostring(n){return"string"===typeof n?n:n.toString()}_convertAnyNumberToString(n){return"string"===typeof n?n:n.toString()}submitTransaction(n){return v(this,void 0,void 0,(function*(){const t="string"===typeof n?this._convertStringToUint8Array(n):n;return this._callMartianBridge({method:"submitTransaction",params:m.from(t).toString("hex")})}))}getTransactions(n){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"getTransactions",params:Object.assign(Object.assign({},n),{start:(null===n||void 0===n?void 0:n.start)?this._convertAnyNumberToString(n.start):void 0})})}))}getTransaction(n){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"getTransaction",params:n})}))}getAccountTransactions(n,t){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"getAccountTransactions",params:{accountAddress:this._convertMaybeHexStringTostring(n),query:Object.assign(Object.assign({},t),{start:(null===t||void 0===t?void 0:t.start)?this._convertAnyNumberToString(t.start):void 0})}})}))}getAccountResources(n,t){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"getAccountResources",params:{accountAddress:this._convertMaybeHexStringTostring(n),query:Object.assign(Object.assign({},t),{ledgerVersion:(null===t||void 0===t?void 0:t.ledgerVersion)?this._convertAnyNumberToString(t.ledgerVersion):void 0})}})}))}getAccount(n){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"getAccount",params:this._convertMaybeHexStringTostring(n)})}))}getChainId(){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"getChainId",params:void 0})}))}getLedgerInfo(){return v(this,void 0,void 0,(function*(){return this._callMartianBridge({method:"getLedgerInfo",params:void 0})}))}}}}]);
//# sourceMappingURL=7693.22fd3eb89ea7fc67.js.map