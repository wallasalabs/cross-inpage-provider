(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5940],{64063:function(e){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!==i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;0!==i--;){var o=s[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},34155:function(e){var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"===typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c,d=[],a=!1,u=-1;function h(){a&&c&&(a=!1,c.length?d=c.concat(d):u=-1,d.length&&l())}function l(){if(!a){var e=o(h);a=!0;for(var t=d.length;t;){for(c=d,d=[];++u<t;)c&&c[u].run();u=-1,t=d.length}c=null,a=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function _(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new f(e,t)),1!==d.length||a||o(l)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=_,r.addListener=_,r.once=_,r.off=_,r.removeListener=_,r.removeAllListeners=_,r.emit=_,r.prependListener=_,r.prependOnceListener=_,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},22519:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var r=n(12637);const{JS_BRIDGE_MESSAGE_DIRECTION:i,JS_BRIDGE_MESSAGE_EXT_CHANNEL:s}=r.vH;function o(e={}){return(0,r.Pk)((()=>new d(Object.assign(Object.assign({},e),{receiveHandler:r.gZ}))))}let c=!1;class d extends r.ZN{constructor(e){super(e),this.sendAsString=!1,this.isInjected=!0,function(e={}){const t=e.debugLogger||r.go;c||(c=!0,window.addEventListener("message",(n=>{var r,o;if(n.source!==window)return;const c=n.data;if(c.channel===s&&c.direction===i.HOST_TO_INPAGE){t.extInjected("onWindowPostMessage",c);const n=c.payload,i=null!==(r=e.bridge)&&void 0!==r?r:null===(o=null===window||void 0===window?void 0:window.$onekey)||void 0===o?void 0:o.jsBridge;i&&i.receive(n)}}),!1))}({debugLogger:this.debugLogger,bridge:this})}sendPayload(e){window.postMessage({channel:s,direction:i.INPAGE_TO_HOST,payload:e})}}},17293:function(e,t,n){"use strict";n.d(t,{EH:function(){return _},jK:function(){return c}});var r=n(10366),i=n(12637);class s extends i.BX{constructor(e){super(e),this.providerName=r.U.conflux}request(e){return this.bridgeRequest(e)}}var o,c,d=n(64063),a=n(22519),u=n(14859);function h(e,t){console.warn(`%cDEPRECATED ${e}: ${t}`,"color: red")}function l(e,t){return e===`wallet_events_${t}`}!function(e){e.EVENT="EVENT",e.METHOD="METHOD",e.PROPERTY="PROPERTY"}(o||(o={})),function(e){e.CONNECT="connect",e.DISCONNECT="disconnect",e.ACCOUNTS_CHANGED="accountsChanged",e.CHAIN_CHANGED="chainChanged",e.MESSAGE="message",e.MESSAGE_LOW_LEVEL="message_low_level",e.NETWORK_CHANGED="networkChanged",e.CHAIN_ID_CHANGE="chainIdChanged"}(c||(c={}));var f=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{d(r.next(e))}catch(t){s(t)}}function c(e){try{d(r.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}d((r=r.apply(e,t||[])).next())}))};class _ extends s{constructor(e){var t;super(Object.assign(Object.assign({},e),{bridge:e.bridge||(0,a.R)({timeout:e.timeout})})),this.isConfluxPortal=!0,this.isFluent=!0,this.isOneKey=!0,this._isConnected=!1,this._initialized=!1,this._chainId="",this._networkVersion="",this._selectedAddress="",this._accounts=[],this._log=null!==(t=e.logger)&&void 0!==t?t:window.console,this._registerEvents(),this._initializeState()}_initializeState(){return f(this,void 0,void 0,(function*(){try{const e=yield this.request({method:"cfx_getProviderState"}),{chainId:t,networkId:n}=e;this.emit(c.CONNECT,{chainId:t,networkId:n})}catch(e){this._log.error("OneKey: Failed to get initial state. Please report this bug.",e)}finally{this._initialized=!0}}))}_registerEvents(){window.addEventListener("onekey_bridge_disconnect",(()=>{this._handleDisconnected()})),this.on(c.MESSAGE_LOW_LEVEL,(e=>{const{method:t,params:n}=e;l(t,c.ACCOUNTS_CHANGED)&&this._handleAccountsChanged(n),l(t,c.CHAIN_CHANGED)&&this._handleChainChanged(n)})),this.on(c.CONNECT,(()=>{this._isConnected=!0,this.request({method:"cfx_chainId"}).then((e=>{this._chainId=e;const t=parseInt(e,16);this._networkVersion=t.toString(10)})).catch((()=>{this._chainId="",this._networkVersion=""})),this.request({method:"cfx_accounts"}).then((e=>{this._selectedAddress=e?e[0]:""})).catch((()=>this._selectedAddress="")),this.on(c.CHAIN_CHANGED,(e=>{this._chainId=e;const t=parseInt(e,16);this._networkVersion=t.toString(10)})),this.on(c.ACCOUNTS_CHANGED,(e=>{this._selectedAddress=e[0]}))}))}isAccountsChanged(e){return!d(this._accounts,e)}_handleAccountsChanged(e){let t=e;Array.isArray(e)||(this._log.error("Onekey: Received invalid accounts parameter. Please report this bug.",e),t=[]);for(const n of t)if("string"!==typeof n){this._log.error("Onekey: Received non-string account. Please report this bug.",e),t=[];break}this.isAccountsChanged(t)&&(this._accounts=t,this._selectedAddress!==t[0]&&(this._selectedAddress=t[0]),this._initialized&&this.emit(c.ACCOUNTS_CHANGED,t))}isNetworkChanged(e){return e!==this._chainId}_handleChainChanged({chainId:e,networkId:t}={}){e&&"string"===typeof e&&e.startsWith("0x")&&t&&"string"===typeof t?"loading"===t?this._handleDisconnected():(this._handleConnected({chainId:e,networkId:t}),this.isNetworkChanged(e)&&(this._chainId=e,this._initialized&&(this.emit(c.CHAIN_CHANGED,e),this.emit(c.NETWORK_CHANGED,t),this.emit(c.CHAIN_ID_CHANGE,e)))):this._log.error("Onekey: Received invalid network parameters. Please report this bug.",{chainId:e,networkId:t})}_handleConnected(e){this._isConnected||(this._isConnected=!0,this.emit(c.CONNECT,e))}_handleDisconnected(){this._isConnected&&(this._isConnected=!1,this.emit(c.DISCONNECT))}isConnected(){return this._isConnected}request(e){return f(this,void 0,void 0,(function*(){const{method:t,params:n}=e;if(!t||"string"!==typeof t||0===t.length)throw u.b$.rpc.methodNotFound();if(void 0!==n&&!Array.isArray(n)&&("object"!==typeof n||null===n))throw u.b$.rpc.invalidParams();e.method.startsWith("eth_")&&(e.method=e.method.replace("eth_","cfx_"));return yield this.bridgeRequest(e)}))}on(e,t){return super.on(e,t)}off(e,t){return super.off(e,t)}emit(e,...t){return super.emit(e,...t)}get chainId(){return h(o.PROPERTY,'"provider.chainId" is deprecated, please use "provider.request({method: "cfx_chainId"})" instead'),this._chainId}get networkVersion(){return h(o.PROPERTY,'"provider.networkVersion" is deprecated, please use "provider.request({method: "net_version"})" instead'),this._networkVersion}get selectedAddress(){return h(o.PROPERTY,'"provider.selectedAddress" is deprecated, please use "provider.request({method: "cfx_accounts"})" instead'),this._selectedAddress||null}enable(){return f(this,void 0,void 0,(function*(){return h(o.METHOD,'"provider.enable" is deprecated, please use "provider.request({method: "cfx_requestAccounts"})" instead'),this.request({method:"cfx_requestAccounts"})}))}sendAsync(e,t){if(h(o.METHOD,'"provider.sendAsync" is deprecated, please use "provider.request" instead'),"function"!==typeof t)throw new Error("Invalid callback, not a function");this.request(e).then((e=>t(null,e))).catch(t)}send(e){return f(this,void 0,void 0,(function*(){h(o.METHOD,'"provider.send" is deprecated, please use "provider.request" instead');return yield this.request(e)}))}}}}]);
//# sourceMappingURL=5940.f075136ae8f5aab9.js.map